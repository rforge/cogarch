(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    467861,      11512]
NotebookOptionsPosition[    453917,      11134]
NotebookOutlinePosition[    454252,      11149]
CellTagsIndexPosition[    454209,      11146]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Preliminary", "Section",
 CellChangeTimes->{{3.5890213452337646`*^9, 3.5890213485492067`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.589091085500042*^9, 3.589091085501645*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.583030825365444*^9, 3.5830310118792973`*^9}, {
   3.583031069544325*^9, 3.583031138964366*^9}, 3.58303118285036*^9, {
   3.5830313479581833`*^9, 3.5830313666391563`*^9}, {3.583031412413343*^9, 
   3.583031479764216*^9}, {3.5830315110231028`*^9, 3.583031791949767*^9}, {
   3.5830318420789633`*^9, 3.583031886157905*^9}, {3.583031942959347*^9, 
   3.5830321140907784`*^9}, {3.583032159115478*^9, 3.583032186017665*^9}, {
   3.5830322663001328`*^9, 3.583032437215551*^9}, {3.5830324852419453`*^9, 
   3.5830329012226267`*^9}, {3.583032976855022*^9, 3.583033069608927*^9}, {
   3.5830331649143953`*^9, 3.583033190617279*^9}, {3.583033333524211*^9, 
   3.583033449665202*^9}, {3.583033484783977*^9, 3.5830335272743587`*^9}, {
   3.583033559780279*^9, 3.583033571917498*^9}, {3.58303360733247*^9, 
   3.583033637868178*^9}, {3.5830346499383574`*^9, 3.583034653998927*^9}, {
   3.583040583282254*^9, 3.583040604982945*^9}, {3.584338276982613*^9, 
   3.5843383042635527`*^9}, 3.5843658917316036`*^9}],

Cell[BoxData["\<\"/home/giovanni/Dropbox/cogarch/giovanni/dicembre/cogarch/\
pkg\"\>"], "Output",
 CellChangeTimes->{3.596434792475267*^9, 3.596434876097924*^9, 
  3.5964349265942373`*^9, 3.596435829182927*^9, 3.596441004034069*^9, 
  3.596441146177281*^9, 3.596441179691471*^9, 3.596442956355769*^9, 
  3.596448842121244*^9, 3.596546883444151*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyStr", "=", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"ToString", "/@", 
      RowBox[{"{", "##", "}"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MySym", "=", 
   RowBox[{
    RowBox[{"Symbol", "[", 
     RowBox[{"MyStr", "[", "##", "]"}], "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.583758020841135*^9, 3.583758042892272*^9}, {
   3.5837590517072163`*^9, 3.5837590652727613`*^9}, 3.583896434859253*^9, {
   3.590467594751236*^9, 3.590467596740266*^9}}],

Cell[CellGroupData[{

Cell["Conditional testing", "Subsection",
 CellChangeTimes->{{3.589266732484543*^9, 3.5892667432500467`*^9}, {
  3.590294575974921*^9, 3.590294576908914*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Testing", ",", "Test"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Testing", "[", 
   RowBox[{"mode", ":", 
    RowBox[{"verbose", "|", "onlyFailure", "|", "skip"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "Test", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{"mode", ",", "\[IndentingNewLine]", 
      RowBox[{"verbose", "|", "onlyFailure"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Test", "[", 
        RowBox[{"test_", ",", "expectedResult_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", "test"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"result", "\[Equal]", "expectedResult"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{"mode", ",", "\[IndentingNewLine]", "verbose", ",", 
              RowBox[{
               RowBox[{"Print", "[", "\"\<Correct result:\>\"", "]"}], ";", 
               "result"}], ",", "\[IndentingNewLine]", "_", ",", "Null"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Unexpected result:\>\"", "]"}], ";", 
             "result"}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", "_", ",", 
      "Null"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{"mode", ",", "\[IndentingNewLine]", "verbose", ",", 
      RowBox[{
       RowBox[{"Test", "[", "expr_", "]"}], ":=", "expr"}], ",", 
      "\[IndentingNewLine]", "_", ",", 
      RowBox[{
       RowBox[{"Test", "[", "___", "]"}], ":=", "Null"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Testing", "[", "skip", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"Test", ",", "HoldAll"}], "]"}]}], "Input",
 CellChangeTimes->{{3.589256855426545*^9, 3.589256880206472*^9}, {
  3.58925781581977*^9, 3.5892578868288193`*^9}, {3.5892579201357393`*^9, 
  3.589258012149807*^9}, {3.589258104248576*^9, 3.589258532763619*^9}, {
  3.589258575100154*^9, 3.589258612651031*^9}, {3.589258672448653*^9, 
  3.589258703222684*^9}, {3.58925873814112*^9, 3.5892587845208273`*^9}, {
  3.589258958496525*^9, 3.5892589645096684`*^9}, {3.58925899770048*^9, 
  3.589259010949494*^9}, {3.5892591751273108`*^9, 3.589259183460849*^9}, {
  3.5892661149334087`*^9, 3.589266136268999*^9}, {3.589266339442439*^9, 
  3.589266387911756*^9}, {3.589266423796679*^9, 3.589266438411603*^9}, {
  3.589266472502677*^9, 3.589266491694455*^9}, {3.589266542541952*^9, 
  3.589266658448455*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Testing", "[", "verbose", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{"1", "+", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"1", "+", "1"}], ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"1", "+", "1"}], ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5892586247940073`*^9, 3.589258666417079*^9}, {
   3.589258795829793*^9, 3.589258893937683*^9}, 3.589258979371276*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.5964347925639057`*^9, 3.596434876212118*^9, 
  3.596434926739346*^9, 3.596435829319398*^9, 3.596441004144506*^9, 
  3.5964411462658043`*^9, 3.596441179780357*^9, 3.59644295648575*^9, 
  3.596448842215835*^9, 3.596546883527527*^9}],

Cell[BoxData["\<\"Correct result:\"\>"], "Print",
 CellChangeTimes->{3.5964347925661993`*^9, 3.5964348762145023`*^9, 
  3.59643492674214*^9, 3.596435829321761*^9, 3.5964410041475143`*^9, 
  3.596441146268594*^9, 3.5964411797818127`*^9, 3.596442956488529*^9, 
  3.596448842217945*^9, 3.5965468835295258`*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.5964347925639057`*^9, 3.596434876212118*^9, 
  3.596434926739346*^9, 3.596435829319398*^9, 3.596441004144506*^9, 
  3.5964411462658043`*^9, 3.596441179780357*^9, 3.59644295648575*^9, 
  3.596448842215835*^9, 3.596546883530676*^9}],

Cell[BoxData["\<\"Unexpected result:\"\>"], "Print",
 CellChangeTimes->{3.5964347925661993`*^9, 3.5964348762145023`*^9, 
  3.59643492674214*^9, 3.596435829321761*^9, 3.5964410041475143`*^9, 
  3.596441146268594*^9, 3.5964411797818127`*^9, 3.596442956488529*^9, 
  3.596448842217945*^9, 3.5965468835321627`*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.5964347925639057`*^9, 3.596434876212118*^9, 
  3.596434926739346*^9, 3.596435829319398*^9, 3.596441004144506*^9, 
  3.5964411462658043`*^9, 3.596441179780357*^9, 3.59644295648575*^9, 
  3.596448842215835*^9, 3.596546883533087*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Testing", "[", "onlyFailure", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{"1", "+", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"1", "+", "1"}], ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"1", "+", "1"}], ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5892586247940073`*^9, 3.589258666417079*^9}, {
  3.589258795829793*^9, 3.589258893937683*^9}, {3.5892589271456614`*^9, 
  3.5892589455782623`*^9}}],

Cell[BoxData["\<\"Unexpected result:\"\>"], "Print",
 CellChangeTimes->{3.596434792634911*^9, 3.596434876282764*^9, 
  3.596434926758506*^9, 3.596435829405294*^9, 3.596441004281218*^9, 
  3.596441146325828*^9, 3.5964411798231907`*^9, 3.596442956576384*^9, 
  3.596448842291812*^9, 3.596546883580611*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.596434792636126*^9, 3.596434876284328*^9, 
  3.5964349267600803`*^9, 3.5964358294123383`*^9, 3.5964410042831097`*^9, 
  3.596441146329912*^9, 3.59644117982444*^9, 3.596442956578083*^9, 
  3.596448842292715*^9, 3.5965468835818768`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Testing", "[", "skip", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"Print", "[", "\"\<Evaluating...\>\"", "]"}], ";", 
   RowBox[{"1", "+", "1"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", "\"\<Evaluating...\>\"", "]"}], ";", 
    RowBox[{"1", "+", "1"}]}], ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", "\"\<Evaluating...\>\"", "]"}], ";", 
    RowBox[{"1", "+", "1"}]}], ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5892586247940073`*^9, 3.589258666417079*^9}, {
  3.589258795829793*^9, 3.58925889234708*^9}, {3.589259023797659*^9, 
  3.589259024425068*^9}, {3.589259133440065*^9, 3.5892591422731867`*^9}}],

Cell[BoxData[
 RowBox[{"Testing", "[", "onlyFailure", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Conditional echoing", "Subsection",
 CellChangeTimes->{{3.58926669482307*^9, 3.589266708763124*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "Echoing", "]"}]], "Input",
 CellChangeTimes->{{3.589263563840345*^9, 3.589263568196186*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Echoing", "[", 
   RowBox[{"mode", ":", 
    RowBox[{"on", "|", "off"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"Echo", ",", "EchoRet"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Echo", "[", "args__", "]"}], ":=", 
     RowBox[{"Switch", "[", 
      RowBox[{"mode", ",", "\[IndentingNewLine]", "on", ",", 
       RowBox[{"Print", "[", "args", "]"}], ",", "\[IndentingNewLine]", "_", 
       ",", "Null"}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SetAttributes", "[", 
     RowBox[{"Echo", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EchoRet", "[", "args__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "values", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"values", "=", 
         RowBox[{"{", "args", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Echo", "@@", "values"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Last", "[", "values", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.589263350123364*^9, 3.589263420457431*^9}, {
  3.589263457324884*^9, 3.58926353138764*^9}, {3.589263680883387*^9, 
  3.589263759538889*^9}, {3.589263804013103*^9, 3.5892638456945972`*^9}, {
  3.589637375993494*^9, 3.589637395714943*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Echoing", "[", "on", "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Evaluating in Echo...\>\"", "]"}], ";", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{"\"\<Two: \>\"", ",", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EchoRet", "[", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Evaluating in EchoRet...\>\"", "]"}], ";", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EchoRet", "[", 
   RowBox[{"\"\<Two: \>\"", ",", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.589261663070055*^9, 3.5892619452919493`*^9}, {
  3.5892635839705973`*^9, 3.58926364318636*^9}, {3.58926386181581*^9, 
  3.5892638634911013`*^9}, {3.5904676140801153`*^9, 3.590467632906934*^9}, {
  3.590467705342095*^9, 3.590467709755794*^9}, {3.59046776440523*^9, 
  3.590467768820665*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Echoing", "[", "off", "]"}], "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Evaluating in Echo...\>\"", "]"}], ";", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{"\"\<Two: \>\"", ",", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EchoRet", "[", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Evaluating in EchoRet...\>\"", "]"}], ";", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EchoRet", "[", 
   RowBox[{"\"\<Two: \>\"", ",", 
    RowBox[{"1", "+", "1"}]}], "]"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.589261956153908*^9, 3.589261956426498*^9}, {
  3.589263655082891*^9, 3.589263657794405*^9}, {3.589263925612824*^9, 
  3.5892639270983973`*^9}, {3.590467661924736*^9, 3.590467672475038*^9}, {
  3.590467746941197*^9, 3.590467761986218*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Cached computation function", "Subsection",
 CellChangeTimes->{{3.590467902631277*^9, 3.59046791027407*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyPath", "[", 
   RowBox[{
    RowBox[{"dirNames", ":", 
     RowBox[{"_String", "..."}]}], ",", "fileName_String"}], "]"}], ":=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"dirNames", ",", "fileName"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyPath", "[", 
   RowBox[{"\"\<dir1\>\"", ",", "\"\<dir2\>\"", ",", "\"\<name\>\""}], "]"}], 
  "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.591511579222288*^9, 3.591511677579968*^9}, {
   3.5915123874343243`*^9, 3.591512448316432*^9}, 3.5915132556994667`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreateDirsInPath", "[", "path_String", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringLength", "[", 
        RowBox[{"DirectoryName", "[", "path", "]"}], "]"}], ">", "0"}], 
      "\[And]", 
      RowBox[{"Not", "[", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"DirectoryName", "[", "path", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"DirectoryName", "[", "path", "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.591613485828065*^9, 3.591613502785472*^9}, {
  3.591614565478942*^9, 3.5916145721803923`*^9}, {3.596288590654303*^9, 
  3.596288623606254*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoadOrCompute", "[", 
   RowBox[{"expr_", ",", "fileName_", ",", 
    RowBox[{"force_:", "False"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Not]", "force"}], "\[And]", 
     RowBox[{"FileExistsQ", "[", "fileName", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"File", " ", "exists"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", 
      RowBox[{
      "\"\<Found file: \\\"\>\"", "<>", "fileName", "<>", "\"\<\\\".\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{
      "\"\<Loaded expression from file \\\"\>\"", "<>", "fileName", "<>", 
       "\"\<\\\".\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Get", "[", "fileName", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<File \>\"", "<>", "fileName", "<>", "\"\< not found\>\""}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<Computing \>\"", "<>", 
       RowBox[{"FileBaseName", "[", "fileName", "]"}], "<>", "\"\<...\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "=", 
         RowBox[{"Timing", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDirsInPath", "[", "fileName", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Put", "[", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "fileName"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computed \>\"", "<>", 
          RowBox[{"FileBaseName", "[", "fileName", "]"}], "<>", 
          "\"\< in \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"r", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
          "\"\< seconds.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"LoadOrCompute", ",", "HoldFirst"}], "]"}]}], "Input",
 CellChangeTimes->{{3.583030825365444*^9, 3.5830310118792973`*^9}, {
   3.583031069544325*^9, 3.583031138964366*^9}, 3.58303118285036*^9, {
   3.5830313479581833`*^9, 3.5830313666391563`*^9}, {3.583031412413343*^9, 
   3.583031479764216*^9}, {3.5830315110231028`*^9, 3.583031791949767*^9}, {
   3.5830318420789633`*^9, 3.583031886157905*^9}, {3.583031942959347*^9, 
   3.5830321140907784`*^9}, {3.583032159115478*^9, 3.583032186017665*^9}, {
   3.5830322663001328`*^9, 3.583032437215551*^9}, {3.5830324852419453`*^9, 
   3.5830329012226267`*^9}, {3.583032976855022*^9, 3.583033069608927*^9}, {
   3.5830331649143953`*^9, 3.583033190617279*^9}, {3.583033333524211*^9, 
   3.583033449665202*^9}, {3.583033484783977*^9, 3.5830335272743587`*^9}, {
   3.583033559780279*^9, 3.583033571917498*^9}, {3.58303360733247*^9, 
   3.583033637868178*^9}, {3.5830346499383574`*^9, 3.583034653998927*^9}, {
   3.583040583282254*^9, 3.583040604982945*^9}, {3.584338276982613*^9, 
   3.5843383042635527`*^9}, {3.584338383344693*^9, 3.584338391647374*^9}, {
   3.584338593535831*^9, 3.5843386143419247`*^9}, {3.584338720914115*^9, 
   3.584338721120811*^9}, {3.584340394678647*^9, 3.584340403150473*^9}, {
   3.5843404490151052`*^9, 3.584340457643773*^9}, {3.584340544528728*^9, 
   3.5843405671422863`*^9}, {3.5843406001391497`*^9, 3.584340611147019*^9}, {
   3.5843407539717007`*^9, 3.5843408077606287`*^9}, {3.5843486118573112`*^9, 
   3.584348646255642*^9}, {3.5843490294976254`*^9, 3.584349042455964*^9}, {
   3.585971084373211*^9, 3.585971149623416*^9}, {3.585971186892397*^9, 
   3.5859711883912582`*^9}, {3.5859712262051363`*^9, 
   3.5859713411221943`*^9}, {3.58597141346266*^9, 3.585971417488861*^9}, {
   3.5880487338910437`*^9, 3.588048768760497*^9}, {3.588048856515045*^9, 
   3.588048861208584*^9}, {3.590467832484458*^9, 3.590467839858201*^9}, {
   3.5916148044802647`*^9, 3.591614817995153*^9}, {3.596288689798723*^9, 
   3.59628871292183*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{"expr_", ",", "fileName_", ",", 
     RowBox[{"force_:", "False"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Ignoring file \>\"", "<>", "fileName", "<>", 
       "\"\< and recomputing.\>\""}], "]"}], ";", "expr"}], ")"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.58444386870907*^9, 3.584443960558961*^9}, {
  3.5844439912042303`*^9, 3.5844439922482862`*^9}, {3.5879695678071117`*^9, 
  3.587969580097761*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "MyCachedMap", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyCachedMap", "[", 
   RowBox[{"function_", ",", "data_", ",", 
    RowBox[{"filePath", ":", 
     RowBox[{"Null", "|", "_String"}], ":", "Null"}], ",", 
    RowBox[{"overwrite", ":", 
     RowBox[{"True", "|", "False"}], ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"SmartCompute", ",", "partialResult", ",", "interrupted"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CreateDirsInPath", "[", "filePath", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partialResult", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringQ", "[", "filePath", "]"}], "\[And]", 
         RowBox[{"FileExistsQ", "[", "filePath", "]"}]}], ",", 
        RowBox[{"Get", "[", "filePath", "]"}], ",", 
        RowBox[{
         RowBox[{"Null", "&"}], "/@", "data"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", "partialResult", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"SmartCompute", "[", "index_", "]"}], ":=", 
      RowBox[{
       RowBox[{"SmartCompute", "[", "index", "]"}], "=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"partialResult", "[", 
          RowBox[{"[", "index", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         "Null", ",", 
         RowBox[{"If", "[", 
          RowBox[{"interrupted", ",", "Null", ",", 
           RowBox[{"function", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", "index", "]"}], "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"partialResult", "[", 
          RowBox[{"[", "index", "]"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "iter", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interrupted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iter", "=", "1"}], ",", 
         RowBox[{"iter", "\[LessEqual]", 
          RowBox[{"Length", "[", "data", "]"}]}], ",", 
         RowBox[{"iter", "++"}], ",", 
         RowBox[{"SmartCompute", "[", "iter", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"interrupted", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computation aborted while computing \>\"", "<>", 
          RowBox[{"IntegerString", "[", "iter", "]"}], "<>", "\"\< of \>\"", "<>", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"Length", "[", "data", "]"}], "]"}], "<>", "\"\<.\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"partialResult", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"SmartCompute", ",", 
        RowBox[{"Length", "[", "data", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Put", "[", 
      RowBox[{"partialResult", ",", "filePath"}], "]"}], ";", 
     "\[IndentingNewLine]", "partialResult"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyCachedMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Pause", "[", "1", "]"}], ";", 
       RowBox[{"f", "[", "#", "]"}]}], ")"}], "&"}], ",", 
    RowBox[{"Range", "[", "5", "]"}], ",", "\"\<test\>\"", ",", "True"}], 
   "]"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.5902113136358767`*^9, 3.5902113260615664`*^9}, {
   3.590211370043154*^9, 3.590211465268054*^9}, 3.59021150990839*^9, {
   3.590212129681808*^9, 3.590212142153081*^9}, {3.5902178756762857`*^9, 
   3.590218197344305*^9}, {3.5902182539063807`*^9, 3.590218552954279*^9}, {
   3.590218591270753*^9, 3.590218745505518*^9}, {3.59021884542656*^9, 
   3.590218906356862*^9}, {3.590239985424294*^9, 3.590239986572071*^9}, {
   3.590293086170554*^9, 3.590293096796049*^9}, {3.590293172745405*^9, 
   3.59029328210541*^9}, {3.590293393386629*^9, 3.590293400672482*^9}, {
   3.590293546241778*^9, 3.590293589479989*^9}, {3.590293625267084*^9, 
   3.590293665998857*^9}, {3.5902937185650587`*^9, 3.590293830538888*^9}, {
   3.590293877975286*^9, 3.590293914547838*^9}, {3.590293944740898*^9, 
   3.5902939754789677`*^9}, {3.590294021457844*^9, 3.590294077011448*^9}, {
   3.5902948096900682`*^9, 3.5902948243628197`*^9}, {3.59029491568465*^9, 
   3.590295051597254*^9}, {3.590295093924794*^9, 3.590295416583606*^9}, {
   3.590295447132217*^9, 3.590295448252901*^9}, {3.590295486308816*^9, 
   3.590295581146264*^9}, 3.5902957854857483`*^9, {3.590295833262047*^9, 
   3.590295877788363*^9}, {3.590295924169842*^9, 3.590295956940798*^9}, {
   3.590301154418272*^9, 3.5903012587806797`*^9}, {3.590301317868268*^9, 
   3.590301350208517*^9}, {3.590301421042544*^9, 3.5903014221995363`*^9}, 
   3.5904683068136673`*^9, {3.5904718853675222`*^9, 3.590472191094236*^9}, {
   3.5916148272893343`*^9, 3.591614836428879*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MyCachedMap", "[", 
    RowBox[{"function_", ",", "data_", ",", "filePath_String", ",", 
     RowBox[{"overwrite", ":", 
      RowBox[{"True", "|", "False"}], ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "partialResult", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partialResult", "=", 
       RowBox[{"LoadOrCompute", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "filePath", ",", "overwrite"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "partialResult", "]"}], ">", 
           RowBox[{"Length", "[", "data", "]"}]}], ",", 
          RowBox[{"partialResult", "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Echo", "[", "partialResult", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"ProgressIndicator", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "iter", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"CheckAbort", "[", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"iter", "=", 
           RowBox[{
            RowBox[{"Length", "[", "partialResult", "]"}], "+", "1"}]}], ",", 
          
          RowBox[{"iter", "\[LessEqual]", 
           RowBox[{"Length", "[", "data", "]"}]}], ",", 
          RowBox[{"iter", "++"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"partialResult", ",", 
            RowBox[{"function", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", "iter", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], ",",
         "Null"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "iter", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"PrintTemporary", "[", 
          RowBox[{
          "\"\<Writing results to \\\"\>\"", "<>", "filePath", "<>", 
           "\"\<\\\"...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Put", "[", 
          RowBox[{"partialResult", ",", "filePath"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "Null"}], "]"}], ";", "\[IndentingNewLine]", 
      "partialResult"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.5902113136358767`*^9, 3.5902113260615664`*^9}, {
   3.590211370043154*^9, 3.590211465268054*^9}, 3.59021150990839*^9, {
   3.590212129681808*^9, 3.590212142153081*^9}, {3.5902178756762857`*^9, 
   3.590218197344305*^9}, {3.5902182539063807`*^9, 3.590218552954279*^9}, {
   3.590218591270753*^9, 3.590218745505518*^9}, {3.59021884542656*^9, 
   3.590218906356862*^9}, {3.590239985424294*^9, 3.590239986572071*^9}, {
   3.590293086170554*^9, 3.590293096796049*^9}, {3.590293172745405*^9, 
   3.59029328210541*^9}, {3.590293393386629*^9, 3.590293400672482*^9}, {
   3.590293546241778*^9, 3.590293589479989*^9}, {3.590293625267084*^9, 
   3.590293665998857*^9}, {3.5902937185650587`*^9, 3.590293830538888*^9}, {
   3.590293877975286*^9, 3.590293914547838*^9}, {3.590293944740898*^9, 
   3.5902939754789677`*^9}, {3.590294021457844*^9, 3.590294077011448*^9}, {
   3.5903010189844093`*^9, 3.590301079760522*^9}, {3.590301311080173*^9, 
   3.590301355240321*^9}, 3.590301427354762*^9, {3.5903874024314203`*^9, 
   3.5903874104881163`*^9}, {3.590468055424148*^9, 3.5904680603867064`*^9}, {
   3.590468314167547*^9, 3.5904683222354794`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCachedMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Pause", "[", "1", "]"}], ";", 
       RowBox[{"f", "[", "#", "]"}]}], ")"}], "&"}], ",", 
    RowBox[{"Range", "[", "5", "]"}], ",", "\"\<test\>\"", ",", "True"}], 
   "]"}], "//", "Test"}]], "Input",
 CellChangeTimes->{{3.5902113136358767`*^9, 3.5902113260615664`*^9}, {
   3.590211370043154*^9, 3.590211465268054*^9}, 3.59021150990839*^9, {
   3.590212129681808*^9, 3.590212142153081*^9}, {3.5902178756762857`*^9, 
   3.590218197344305*^9}, {3.5902182539063807`*^9, 3.590218552954279*^9}, {
   3.590218591270753*^9, 3.590218745505518*^9}, {3.59021884542656*^9, 
   3.590218906356862*^9}, {3.590239985424294*^9, 3.590239986572071*^9}, {
   3.590293086170554*^9, 3.590293096796049*^9}, {3.590293172745405*^9, 
   3.59029328210541*^9}, {3.590293393386629*^9, 3.590293400672482*^9}, {
   3.590293546241778*^9, 3.590293589479989*^9}, {3.590293625267084*^9, 
   3.590293665998857*^9}, {3.5902937185650587`*^9, 3.590293830538888*^9}, {
   3.590293877975286*^9, 3.590293914547838*^9}, {3.590293944740898*^9, 
   3.5902939754789677`*^9}, {3.590294021457844*^9, 3.590294077011448*^9}, {
   3.5903010189844093`*^9, 3.590301079760522*^9}, {3.590301311080173*^9, 
   3.590301355240321*^9}, 3.590301427354762*^9, {3.5903874024314203`*^9, 
   3.5903874104881163`*^9}, {3.590468055424148*^9, 3.5904680603867064`*^9}, {
   3.590468314167547*^9, 3.5904683222354794`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyParallelCachedMap", "[", 
   RowBox[{"function_", ",", "data_", ",", 
    RowBox[{"filePath", ":", 
     RowBox[{"Null", "|", "_String"}], ":", "Null"}], ",", 
    RowBox[{"overwrite", ":", 
     RowBox[{"True", "|", "False"}], ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "SmartCompute", ",", "Progress", ",", "partialResult", ",", 
      "interrupted", ",", "elapsedTime", ",", "currentlyComputing"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CreateDirsInPath", "[", "filePath", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetSharedVariable", "[", 
      RowBox[{
      "partialResult", ",", "interrupted", ",", "elapsedTime", ",", 
       "currentlyComputing"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"partialResult", "=", 
        RowBox[{"LoadOrCompute", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Null", "&"}], "/@", "data"}], ",", "filePath", ",", 
          "overwrite"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"currentlyComputing", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"partialResult", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringQ", "[", "filePath", "]"}], "\[And]", 
         RowBox[{"FileExistsQ", "[", "filePath", "]"}], "\[And]", 
         RowBox[{"Not", "[", "overwrite", "]"}]}], ",", 
        RowBox[{"Get", "[", "filePath", "]"}], ",", 
        RowBox[{
         RowBox[{"Null", "&"}], "/@", "data"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Progress", ":=", 
      RowBox[{"Count", "[", 
       RowBox[{"partialResult", ",", 
        RowBox[{"Except", "[", "Null", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Progress", "\[Equal]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"Return", "[", "partialResult", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elapsedTime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"SmartCompute", "[", 
         RowBox[{"Null", ",", "index_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"timing", ",", "value"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"timing", ",", "value"}], "}"}], "=", 
             RowBox[{"Timing", "[", 
              RowBox[{"function", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", "index", "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"elapsedTime", "+=", "timing"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"partialResult", "[", 
              RowBox[{"[", "index", "]"}], "]"}], "=", "value"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], "/;", 
         RowBox[{"Not", "[", "interrupted", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SmartCompute", "[", 
         RowBox[{"_", ",", "_"}], "]"}], ":=", "Null"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SmartCompute", "[", "index_", "]"}], ":=", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"partialResult", "[", 
         RowBox[{"[", "index", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        "Null", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", "interrupted", "]"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"timing", ",", "value", ",", "msg"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"currentlyComputing", ",", "index"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"timing", ",", "value"}], "}"}], "=", 
              RowBox[{"Timing", "[", 
               RowBox[{"function", "[", 
                RowBox[{"data", "[", 
                 RowBox[{"[", "index", "]"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"elapsedTime", "+=", "timing"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"partialResult", "[", 
               RowBox[{"[", "index", "]"}], "]"}], "=", "value"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"PrintTemporary", "[", 
                RowBox[{"\"\<Computed term \>\"", "<>", 
                 RowBox[{"IntegerString", "[", "index", "]"}], "<>", 
                 "\"\< in \>\"", "<>", 
                 RowBox[{"ToString", "[", "timing", "]"}], "<>", 
                 "\"\< seconds.\>\""}], "]"}], ";"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"currentlyComputing", "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"currentlyComputing", ",", "index"}], "]"}]}], ";"}]}],
            "\[IndentingNewLine]", "]"}]}], "]"}], ",", "\[IndentingNewLine]",
         "_", ",", "Null"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interrupted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"\"\<Computed \>\"", "<>", 
        RowBox[{"IntegerString", "[", "Progress", "]"}], "<>", "\"\< of \>\"",
         "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"Length", "[", "data", "]"}], "]"}], "<>", 
        "\"\< terms.\>\""}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"\"\<Computing terms \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"currentlyComputing", ",", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{
              RowBox[{"partialResult", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "Null"}], "]"}], "&"}]}], 
          "]"}], "]"}], "<>", "\"\<. \>\""}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "Progress", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelArray", "[", 
        RowBox[{"SmartCompute", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"interrupted", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computation aborted while computing \>\"", "<>", 
          RowBox[{"IntegerString", "[", "Progress", "]"}], "<>", 
          "\"\< of \>\"", "<>", 
          RowBox[{"IntegerString", "[", 
           RowBox[{"Length", "[", "data", "]"}], "]"}], "<>", "\"\<.\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"elapsedTime", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Total computing time: \>\"", "<>", 
         RowBox[{"ToString", "[", "elapsedTime", "]"}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{
         "\"\<Writing results to \\\"\>\"", "<>", "filePath", "<>", 
          "\"\<\\\"...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringQ", "[", "filePath", "]"}], ",", 
          RowBox[{"Put", "[", 
           RowBox[{"partialResult", ",", "filePath"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "Null"}], "]"}], ";", "\[IndentingNewLine]", 
     "partialResult"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5902113136358767`*^9, 3.5902113260615664`*^9}, {
   3.590211370043154*^9, 3.590211465268054*^9}, 3.59021150990839*^9, {
   3.590212129681808*^9, 3.590212142153081*^9}, {3.5902178756762857`*^9, 
   3.590218197344305*^9}, {3.5902182539063807`*^9, 3.590218552954279*^9}, {
   3.590218591270753*^9, 3.590218745505518*^9}, {3.59021884542656*^9, 
   3.590218906356862*^9}, {3.590239985424294*^9, 3.590239986572071*^9}, {
   3.590293086170554*^9, 3.590293096796049*^9}, {3.590293172745405*^9, 
   3.59029328210541*^9}, {3.590293393386629*^9, 3.590293400672482*^9}, {
   3.590293546241778*^9, 3.590293589479989*^9}, {3.590293625267084*^9, 
   3.590293665998857*^9}, {3.5902937185650587`*^9, 3.590293830538888*^9}, {
   3.590293877975286*^9, 3.590293914547838*^9}, {3.590293944740898*^9, 
   3.5902939754789677`*^9}, {3.590294021457844*^9, 3.590294077011448*^9}, {
   3.5902948096900682`*^9, 3.5902948243628197`*^9}, {3.59029491568465*^9, 
   3.590295051597254*^9}, {3.590295093924794*^9, 3.590295416583606*^9}, {
   3.590295447132217*^9, 3.590295448252901*^9}, {3.590295486308816*^9, 
   3.590295581146264*^9}, 3.5902957854857483`*^9, {3.590295833262047*^9, 
   3.590295877788363*^9}, {3.590295924169842*^9, 3.590295991096403*^9}, {
   3.590296726695969*^9, 3.59029673168636*^9}, {3.590296787252281*^9, 
   3.590296831690124*^9}, {3.590296899069912*^9, 3.590296960619401*^9}, {
   3.590296999852336*^9, 3.590297145120769*^9}, {3.590298038679597*^9, 
   3.590298046426396*^9}, {3.59029808364182*^9, 3.590298084001184*^9}, {
   3.5902981352898684`*^9, 3.590298145093927*^9}, {3.590298207816513*^9, 
   3.59029828543047*^9}, {3.590300324879777*^9, 3.5903004173435698`*^9}, {
   3.590300449143867*^9, 3.590300449788043*^9}, {3.590300494668953*^9, 
   3.5903005093815947`*^9}, {3.590300571035817*^9, 3.590300572385497*^9}, {
   3.5903006211710663`*^9, 3.590300644345186*^9}, {3.590300677544026*^9, 
   3.5903007131696997`*^9}, {3.5903007814857063`*^9, 3.590300907289898*^9}, {
   3.5903009505606213`*^9, 3.590300955824666*^9}, {3.590300988737666*^9, 
   3.5903010118232203`*^9}, 3.590301068702347*^9, {3.5903256183265343`*^9, 
   3.590325632297724*^9}, {3.590325710159079*^9, 3.590325828968087*^9}, {
   3.590325874873434*^9, 3.5903258794758587`*^9}, {3.590325910446232*^9, 
   3.5903259286046343`*^9}, {3.590326009336453*^9, 3.590326127125019*^9}, {
   3.5903872076512403`*^9, 3.590387365219809*^9}, 3.590468154270686*^9, {
   3.59046821528188*^9, 3.590468235604851*^9}, {3.590468699346418*^9, 
   3.590468746146852*^9}, {3.590468941095332*^9, 3.590469046988407*^9}, {
   3.5904691014087343`*^9, 3.590469111962331*^9}, {3.590469145756432*^9, 
   3.590469190820112*^9}, {3.590469221885913*^9, 3.590469233337122*^9}, {
   3.590469267789584*^9, 3.590469275094898*^9}, {3.590469325599802*^9, 
   3.5904694130177402`*^9}, {3.5904695689760513`*^9, 3.590469607966587*^9}, {
   3.5904697758409357`*^9, 3.590469802198986*^9}, {3.590469834305711*^9, 
   3.590469838533416*^9}, {3.590469935330064*^9, 3.590469942736628*^9}, {
   3.590470074644787*^9, 3.590470142994339*^9}, {3.590471319324225*^9, 
   3.590471341558496*^9}, {3.590471462583601*^9, 3.5904714829113398`*^9}, {
   3.5904715248577013`*^9, 3.5904715716785107`*^9}, {3.5904722414132643`*^9, 
   3.590472246581115*^9}, {3.590472453044235*^9, 3.590472541382964*^9}, {
   3.5915121808984737`*^9, 3.59151218324923*^9}, {3.5915122292315474`*^9, 
   3.591512233591646*^9}, {3.591614846530899*^9, 3.591614847190324*^9}, {
   3.591705074742105*^9, 3.591705083801516*^9}, {3.5921898009609337`*^9, 
   3.5921898452597437`*^9}, {3.592189876839491*^9, 3.592189886711156*^9}, {
   3.594448790966324*^9, 3.594448803111205*^9}, {3.594449238026121*^9, 
   3.594449397755095*^9}, {3.59444959134643*^9, 3.594449606077643*^9}, {
   3.594449666445628*^9, 3.594449667605843*^9}, 3.594449699188909*^9, 
   3.5944497370879917`*^9, {3.5944507235500307`*^9, 3.5944507427651567`*^9}, {
   3.594450841730956*^9, 3.5944508834665527`*^9}, {3.59445092948174*^9, 
   3.59445102594372*^9}, {3.594451078540999*^9, 3.5944511567219677`*^9}, {
   3.594451233413747*^9, 3.594451242089546*^9}, {3.594451418623213*^9, 
   3.59445145789016*^9}, {3.594451499406067*^9, 3.594451514010544*^9}, {
   3.5944516057533903`*^9, 3.5944516319001102`*^9}, {3.594469371021285*^9, 
   3.594469387747746*^9}, {3.594471008965108*^9, 3.594471023522835*^9}, {
   3.5945380405081873`*^9, 3.59453811475322*^9}, {3.594538212107534*^9, 
   3.5945382324235773`*^9}, {3.5945382728741198`*^9, 3.594538273479557*^9}, {
   3.5945383913685617`*^9, 3.594538394543242*^9}, {3.5945386841538553`*^9, 
   3.594538777843767*^9}, 3.594556444325246*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyParallelCachedMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Pause", "[", "1", "]"}], ";", 
       RowBox[{"f", "[", "#", "]"}]}], ")"}], "&"}], ",", 
    RowBox[{"Range", "[", "10", "]"}], ",", "\"\<test\>\"", ",", "True"}], 
   "]"}], "//", "Test"}]], "Input",
 CellChangeTimes->{{3.5902113136358767`*^9, 3.5902113260615664`*^9}, {
   3.590211370043154*^9, 3.590211465268054*^9}, 3.59021150990839*^9, {
   3.590212129681808*^9, 3.590212142153081*^9}, {3.5902178756762857`*^9, 
   3.590218197344305*^9}, {3.5902182539063807`*^9, 3.590218552954279*^9}, {
   3.590218591270753*^9, 3.590218825022324*^9}, {3.590293110344426*^9, 
   3.590293113004692*^9}, {3.5902937652076063`*^9, 3.590293765562138*^9}, {
   3.590297218347252*^9, 3.5902972398179703`*^9}, {3.590298180821957*^9, 
   3.59029818237533*^9}, {3.590300926220139*^9, 3.590300926383369*^9}, {
   3.590301431375637*^9, 3.590301442158634*^9}, 3.590325851729993*^9, {
   3.590326132401079*^9, 3.590326133259679*^9}, {3.5903886102418613`*^9, 
   3.5903886206351852`*^9}, {3.590468628463879*^9, 3.590468631450692*^9}, {
   3.5904725964225397`*^9, 3.5904726029673033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelMapMonitor", "[", 
   RowBox[{"function_", ",", "exprList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"counter", ",", "elapsedTime"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"counter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"elapsedTime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetSharedVariable", "[", 
      RowBox[{"counter", ",", "elapsedTime"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<Computing \>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"Length", "[", "exprList", "]"}], "]"}], "<>", 
       "\"\< terms.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"value", ",", "partialTime", ",", "identifier"}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"identifier", "=", 
              RowBox[{"\"\<#\>\"", "<>", 
               RowBox[{"IntegerString", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\< of \>\"", 
               "<>", 
               RowBox[{"IntegerString", "[", 
                RowBox[{"Length", "[", "exprList", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"PrintTemporary", "[", 
                RowBox[{
                "\"\<Simplifying term \>\"", "<>", "identifier", "<>", 
                 "\"\<.\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"value", ",", "partialTime"}], "}"}], "=", 
              RowBox[{
               RowBox[{"function", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "Timing"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"counter", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"elapsedTime", "+=", "partialTime"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"PrintTemporary", "[", 
                RowBox[{
                "\"\<Term \>\"", "<>", "identifier", "<>", "\"\< done.\>\""}],
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "value"}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", "exprList"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"counter", ",", "elapsedTime"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.588312818964221*^9, 3.5883133035155573`*^9}, {
   3.588313441573595*^9, 3.5883134825502157`*^9}, {3.58831354987157*^9, 
   3.588313555366374*^9}, {3.588314124982374*^9, 3.588314243538238*^9}, {
   3.588314805440135*^9, 3.5883148342160273`*^9}, {3.588314942517207*^9, 
   3.5883149972961493`*^9}, {3.588315107521996*^9, 3.58831514616081*^9}, {
   3.588315216208538*^9, 3.588315229650731*^9}, {3.58900071919302*^9, 
   3.589000722810424*^9}, {3.589001741448675*^9, 3.589001959861608*^9}, {
   3.5890019967616158`*^9, 3.58900219298637*^9}, {3.589002223613011*^9, 
   3.589002273094634*^9}, {3.589004313003573*^9, 3.589004375161344*^9}, 
   3.589021503199514*^9, {3.590147612870631*^9, 3.590147646957655*^9}, {
   3.590147693515192*^9, 3.5901477521393127`*^9}, {3.5903255860091753`*^9, 
   3.590325590289744*^9}, {3.5916148535429792`*^9, 3.5916148593790073`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelMapMonitor", "[", 
   RowBox[{"function_", ",", "exprList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "counter", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"counter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetSharedVariable", "[", "counter", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<Computing \>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"Length", "[", "exprList", "]"}], "]"}], "<>", 
       "\"\< terms.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "counter", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "exprList", "]"}]}], "}"}]}], "]"}], "]"}], 
     ";", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"\"\<Computed \>\"", "<>", 
        RowBox[{"IntegerString", "[", "counter", "]"}], "<>", "\"\< of \>\"", 
        "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"Length", "[", "exprList", "]"}], "]"}]}], "]"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"value", ",", "identifier"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"identifier", "=", 
            RowBox[{"\"\<#\>\"", "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\< of \>\"", "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{"Length", "[", "exprList", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"PrintTemporary", "[", 
              RowBox[{
              "\"\<Simplifying term \>\"", "<>", "identifier", "<>", 
               "\"\<.\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"value", "=", 
            RowBox[{"function", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"counter", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"PrintTemporary", "[", 
              RowBox[{
              "\"\<Term \>\"", "<>", "identifier", "<>", "\"\< done.\>\""}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "value"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", "exprList"}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.588312818964221*^9, 3.5883133035155573`*^9}, {
   3.588313441573595*^9, 3.5883134825502157`*^9}, {3.58831354987157*^9, 
   3.588313555366374*^9}, {3.588314124982374*^9, 3.588314243538238*^9}, {
   3.588314805440135*^9, 3.5883148342160273`*^9}, {3.588314942517207*^9, 
   3.5883149972961493`*^9}, {3.588315107521996*^9, 3.58831514616081*^9}, {
   3.588315216208538*^9, 3.588315229650731*^9}, {3.58900071919302*^9, 
   3.589000722810424*^9}, {3.589001741448675*^9, 3.589001959861608*^9}, {
   3.5890019967616158`*^9, 3.58900219298637*^9}, {3.589002223613011*^9, 
   3.589002273094634*^9}, {3.589004313003573*^9, 3.589004375161344*^9}, 
   3.589021503199514*^9, {3.5902941136319027`*^9, 3.590294123844132*^9}, {
   3.5902941632735662`*^9, 3.5902942081054697`*^9}, {3.590294298876293*^9, 
   3.590294302797607*^9}, {3.590294369373416*^9, 3.590294530555788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelMapMonitor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Pause", "[", "1", "]"}], ";", 
       RowBox[{"f", "[", "#", "]"}]}], ")"}], "&"}], ",", 
    RowBox[{"Range", "[", "10", "]"}]}], "]"}], "//", "Test"}]], "Input",
 CellChangeTimes->{{3.5902942540849733`*^9, 3.590294283358315*^9}, {
  3.590294314512497*^9, 3.590294343127008*^9}, {3.590467949652946*^9, 
  3.590467950522938*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute Moments", "Section",
 CellChangeTimes->{{3.584442068849247*^9, 3.5844420721505957`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"\[Phi]", ">", "0"}], " ", "\[And]", 
    RowBox[{"\[Beta]", ">", "0"}], "\[And]", " ", 
    RowBox[{"\[Eta]", ">", "0"}], "\[And]", 
    RowBox[{"d1", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{"d2", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{"d3", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", "1", "]"}], "<", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", "2", "]"}], "<", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", "3", "]"}], "<", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", "4", "]"}], "<", "0"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.584100311775004*^9, 3.584100342961125*^9}, {
   3.584100374021575*^9, 3.584100503195498*^9}, {3.584153619364243*^9, 
   3.5841536198136787`*^9}, {3.584153713271676*^9, 3.584153762662994*^9}, {
   3.584153913598756*^9, 3.58415394841833*^9}, {3.58415400020898*^9, 
   3.584154016928357*^9}, {3.58909023597867*^9, 3.589090265925494*^9}, {
   3.5933347182374363`*^9, 3.593334719147563*^9}, 3.593334761002417*^9}],

Cell[CellGroupData[{

Cell["Define moment expressions", "Subsection",
 CellChangeTimes->{{3.587959775418461*^9, 3.587959784044819*^9}, {
  3.592121918448237*^9, 3.592121919834177*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"ELdExpr", ",", "ELd", ",", "EL"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ELdExpr", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[GreaterEqual]", "j"}], " ", ",", 
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "*", 
           SuperscriptBox["\[Phi]", "j"]}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], ".", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", "i", "]"}], "+", 
        RowBox[{"i", " ", "\[Eta]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ELd", "[", "nn_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ELdExpr", "[", 
    RowBox[{"[", 
     FractionBox["nn", "2"], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"EvenQ", "[", "nn", "]"}], "\[And]", 
    RowBox[{"nn", ">", "0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EL", "[", "2", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EL", "[", "nn_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ELd", "[", "nn", "]"}], "/;", 
   RowBox[{
    RowBox[{"EvenQ", "[", "nn", "]"}], "\[And]", 
    RowBox[{"nn", ">", "0"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.583814705443068*^9, 3.583814714332864*^9}, {
   3.583815149150559*^9, 3.583815154710577*^9}, {3.584098855599423*^9, 
   3.584098892397694*^9}, {3.5840991566654053`*^9, 3.584099256977193*^9}, {
   3.584104129872027*^9, 3.584104136795418*^9}, {3.584104242202445*^9, 
   3.5841042451310863`*^9}, {3.584104312760828*^9, 3.5841043692792788`*^9}, {
   3.584158541399439*^9, 3.584158543241229*^9}, {3.584255223279598*^9, 
   3.584255225694804*^9}, {3.58433378510915*^9, 3.584333844544725*^9}, {
   3.584333891752285*^9, 3.5843338956283197`*^9}, 3.584335722488833*^9, {
   3.584442246666407*^9, 3.5844424191153812`*^9}, {3.584442456695034*^9, 
   3.584442462295109*^9}, 3.588403487247078*^9}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "CExpr", ",", "CCached", ",", "EGS", ",", "EGSExpr", ",", "EGSCached"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CExpr", "[", 
   RowBox[{"k_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]", 
     RowBox[{"(", 
      RowBox[{"k", "-", "i"}], ")"}], 
     RowBox[{
      RowBox[{"EGS", "[", 
       RowBox[{
        RowBox[{"2", "i"}], ",", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"k", "-", "i", "-", "1"}], ")"}]}]}], "]"}], "[", "t", 
      "]"}]}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"2", "i"}], ",", 
         RowBox[{"2", "j"}]}], "]"}], 
       RowBox[{
        RowBox[{"EGS", "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"i", "-", "j"}], ")"}]}], ",", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"k", "-", "i", "+", "j"}], ")"}]}]}], "]"}], "[", "t", 
        "]"}], 
       RowBox[{"EL", "[", 
        RowBox[{"2", "j"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "i"}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"k", "-", "i"}], ",", "j"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{
            RowBox[{"2", "i"}], ",", 
            RowBox[{"2", "h"}]}], "]"}], 
          SuperscriptBox["\[Phi]", "j"], 
          RowBox[{"EL", "[", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"j", "+", "h"}], ")"}]}], "]"}], 
          RowBox[{
           RowBox[{"EGS", "[", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"i", "-", "h"}], ")"}]}], ",", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"k", "-", "i", "+", "h"}], ")"}]}]}], "]"}], "[", "t", 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "i"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"k", "-", "i"}]}], "}"}]}], "]"}]}], "/;", 
   RowBox[{"1", "\[LessEqual]", "i", "<", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCached", "[", 
   RowBox[{"k_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"CExpr", "[", 
     RowBox[{"k", ",", "i"}], "]"}], "=", 
    RowBox[{"CExpr", "[", 
     RowBox[{"k", ",", "i"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EGSExpr", "[", 
   RowBox[{"k_", ",", "0"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"k", "!"}], 
   SuperscriptBox["\[Beta]", "k"], 
   RowBox[{"Product", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      RowBox[{"\[CapitalPsi]", "[", "l", "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "k"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EGSExpr", "[", 
   RowBox[{"k_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"t", " ", 
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"k", "-", "i"}], "]"}]}], "]"}], 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CCached", "[", 
          RowBox[{"k", ",", "i"}], "]"}], "/.", 
         RowBox[{"t", "\[Rule]", "s"}]}], ")"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "s"}], " ", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"k", "-", "i"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", "t"}], "}"}]}], "]"}]}], "/;", 
   RowBox[{"1", "\[LessEqual]", "i", "<", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EGSExpr", "[", 
   RowBox[{"k_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{"2", "k"}], ",", 
       RowBox[{"2", "i"}]}], "]"}], 
     RowBox[{"EL", "[", 
      RowBox[{"2", "i"}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EGS", "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"k", "-", "i"}], ")"}]}], ",", 
          RowBox[{"2", "i"}]}], "]"}], "[", "s", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "t"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "k"}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"EGSName", "[", 
   RowBox[{"ii_", ",", "kmikmi_"}], "]"}], ":=", " ", 
  RowBox[{"MyStr", "[", 
   RowBox[{"\"\<EG\>\"", ",", "ii", ",", "\"\<S\>\"", ",", "kmikmi"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EGSCached", "[", 
   RowBox[{"ii_", ",", "kmikmi_"}], "]"}], ":=", 
  RowBox[{"LoadOrCompute", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"EGSExpr", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"kmikmi", "+", "ii"}], "2"], ",", 
       FractionBox["ii", "2"]}], "]"}], "//", "Simplify"}], ",", 
    RowBox[{"MyPath", "[", 
     RowBox[{"\"\<moments\>\"", ",", "\"\<EGS\>\"", ",", 
      RowBox[{"EGSName", "[", 
       RowBox[{"ii", ",", "kmikmi"}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EGS", "[", 
   RowBox[{"ii_", ",", "kmikmi_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"EGSCached", "[", 
         RowBox[{"ii", ",", "kmikmi"}], "]"}], "=", 
        RowBox[{"EGSCached", "[", 
         RowBox[{"ii", ",", "kmikmi"}], "]"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"t", "\[Rule]", 
        RowBox[{"Slot", "[", "1", "]"}]}], "}"}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"ii", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{"kmikmi", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{"EvenQ", "[", "ii", "]"}], "\[And]", 
    RowBox[{"EvenQ", "[", "kmikmi", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.5841542784708357`*^9, 3.5841543217725983`*^9}, {
   3.584154420499371*^9, 3.5841544571142282`*^9}, {3.584154515050136*^9, 
   3.5841545904279823`*^9}, {3.584154622500249*^9, 3.584154630824025*^9}, {
   3.5841546611649237`*^9, 3.584154683716488*^9}, {3.58415475700949*^9, 
   3.58415476774571*^9}, {3.5841548127900457`*^9, 3.58415489124487*^9}, {
   3.584155053835462*^9, 3.584155070676813*^9}, {3.584156568442107*^9, 
   3.584156573034329*^9}, {3.584156934836137*^9, 3.584156937242527*^9}, {
   3.584157162247768*^9, 3.584157178249097*^9}, {3.584157507630477*^9, 
   3.584157995425502*^9}, {3.5841580718694963`*^9, 3.584158091462018*^9}, {
   3.5841581427675457`*^9, 3.584158152075789*^9}, {3.584158299173094*^9, 
   3.5841583286912527`*^9}, {3.584158369846909*^9, 3.5841584645337963`*^9}, {
   3.584158510722374*^9, 3.584158522851781*^9}, 3.5841603229049377`*^9, {
   3.584160366002812*^9, 3.584160496391056*^9}, {3.584160551866581*^9, 
   3.584160574392386*^9}, 3.584160627401463*^9, {3.584160733854677*^9, 
   3.584160790618403*^9}, 3.5841613951874247`*^9, {3.584163717629642*^9, 
   3.584163726052904*^9}, {3.584165384763769*^9, 3.5841654462464857`*^9}, {
   3.5841662608357983`*^9, 3.584166418943096*^9}, {3.5841673716969357`*^9, 
   3.584167373017742*^9}, {3.584167403489807*^9, 3.584167406029998*^9}, {
   3.584167492890881*^9, 3.5841675208807592`*^9}, {3.5841675856238613`*^9, 
   3.584167669335989*^9}, {3.58416772347129*^9, 3.584167754594179*^9}, {
   3.58416787821883*^9, 3.584167889738035*^9}, {3.584167983234853*^9, 
   3.5841680701910257`*^9}, {3.584168177836821*^9, 3.584168261342299*^9}, 
   3.584168293877611*^9, {3.584168519773994*^9, 3.584168520983714*^9}, {
   3.584168592516344*^9, 3.58416865247633*^9}, {3.5841687480828657`*^9, 
   3.5841687487921667`*^9}, {3.584169822597234*^9, 3.584169878227487*^9}, {
   3.5841700989092407`*^9, 3.584170104276758*^9}, {3.584170226439432*^9, 
   3.584170227291098*^9}, {3.584170284183093*^9, 3.584170303615473*^9}, {
   3.584172578532856*^9, 3.584172580933713*^9}, 3.584175423582549*^9, {
   3.584175640578643*^9, 3.584175653685794*^9}, {3.584175991643778*^9, 
   3.5841760303642807`*^9}, {3.584177531945148*^9, 3.584177574748457*^9}, {
   3.584177638738473*^9, 3.5841776409705353`*^9}, {3.5841777774479113`*^9, 
   3.584177806078478*^9}, {3.5841833270185137`*^9, 3.584183330174595*^9}, {
   3.584183479816777*^9, 3.584183492253284*^9}, {3.584184461390451*^9, 
   3.584184462383165*^9}, {3.584184494519743*^9, 3.584184503953759*^9}, 
   3.584184581677018*^9, {3.584185642655854*^9, 3.5841856472006598`*^9}, 
   3.58418588571099*^9, {3.584186020999549*^9, 3.584186025614767*^9}, {
   3.584186307353462*^9, 3.584186311755122*^9}, 3.584186708832266*^9, {
   3.584250696767994*^9, 3.584250702199711*^9}, {3.584252973002393*^9, 
   3.5842530005590897`*^9}, {3.584253340485621*^9, 3.584253351164706*^9}, {
   3.5842534479604273`*^9, 3.5842534521545343`*^9}, {3.5842535111661158`*^9, 
   3.584253588252589*^9}, {3.5842542246199102`*^9, 3.584254262008473*^9}, {
   3.584254368206931*^9, 3.58425438788725*^9}, {3.584263516195063*^9, 
   3.584263538081151*^9}, {3.584276543614688*^9, 3.584276544356429*^9}, {
   3.584340890119632*^9, 3.584341085793489*^9}, {3.584349131365572*^9, 
   3.5843491362342463`*^9}, {3.584414522088344*^9, 3.584414555278846*^9}, {
   3.584442701833419*^9, 3.584442875287744*^9}, {3.584442915658901*^9, 
   3.5844429454703836`*^9}, {3.584443066581438*^9, 3.58444308302081*^9}, {
   3.584443640804798*^9, 3.584443684354135*^9}, {3.584443729220611*^9, 
   3.584443750317524*^9}, {3.584443783418236*^9, 3.584443784341034*^9}, {
   3.584444122909174*^9, 3.5844441276374187`*^9}, {3.5915118805119247`*^9, 
   3.591511889758453*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"J", ",", "JExpr", ",", "JCached"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JExpr", "[", 
   RowBox[{"k_", ",", "0", ",", "k0_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "i", ",", "vars", ",", "intervals", ",", "body"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"d1", "+", "d2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"i", "=", 
       RowBox[{"k", "-", "k0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<s\>\"", "<>", 
             RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "i"}], "}"}]}], "]"}], ",", "t"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"intervals", "=", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#2", ",", "0", ",", "#1"}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rest", "[", "vars", "]"}], ",", 
            RowBox[{"Most", "[", "vars", "]"}]}], "}"}]}], "]"}], "//", 
        "Reverse"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"body", "=", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Differences", "[", "vars", "]"}], ",", "s1"}], "]"}], 
          ".", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[CapitalPsi]", "[", "j", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"k", "-", "i"}], ",", "k"}], "}"}]}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", "0", "]"}], "\[Rule]", "0"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{"k", "!"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "i"}], ")"}], "!"}]], 
       SuperscriptBox["\[Beta]", "i"], 
       RowBox[{"Integrate", "@@", 
        RowBox[{"Prepend", "[", 
         RowBox[{"intervals", ",", "body"}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"0", "\[LessEqual]", "k0", "<", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JExpr", "[", 
   RowBox[{"k_", ",", "0", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"d1", "+", "d2"}], ")"}], 
    RowBox[{"\[CapitalPsi]", "[", "k", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JExpr", "[", 
   RowBox[{"k_", ",", "i_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sum0", ",", "sumA", ",", "sumB", ",", "sumC"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sum0", ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", "\[Equal]", "k"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k", "-", "i"}], ")"}], "\[Beta]", " ", 
          RowBox[{
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{"k", "-", "1"}], ",", "i", ",", "r"}], "]"}], "[", 
           RowBox[{"w", ",", "d2"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sumA", ":=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EL", "[", 
           RowBox[{"2", "j"}], "]"}], 
          RowBox[{"Binomial", "[", 
           RowBox[{
            RowBox[{"2", "i"}], ",", 
            RowBox[{"2", "j"}]}], "]"}], 
          RowBox[{
           RowBox[{"J", "[", 
            RowBox[{"k", ",", 
             RowBox[{"i", "-", "j"}], ",", "r"}], "]"}], "[", 
           RowBox[{"w", ",", "d2"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sumB", ":=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{
            RowBox[{"2", "i"}], ",", 
            RowBox[{"2", "m"}]}], "]"}], 
          RowBox[{
           RowBox[{"J", "[", 
            RowBox[{"k", ",", 
             RowBox[{"i", "-", "m"}], ",", "r"}], "]"}], "[", 
           RowBox[{"w", ",", "d2"}], "]"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{
               RowBox[{"k", "-", "i"}], ",", "j"}], "]"}], 
             SuperscriptBox["\[Phi]", "j"], 
             RowBox[{"EL", "[", 
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{"j", "+", "m"}], ")"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "i"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"d1", " ", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"k", "-", "i"}], "]"}]}], "]"}], 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sum0", "+", "sumA", "+", "sumB"}], ")"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "w"}], " ", 
            RowBox[{"\[CapitalPsi]", "[", 
             RowBox[{"k", "-", "i"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"w", ",", "0", ",", "d1"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"0", "<", "i", "<", "k"}], "&&", 
    RowBox[{
    "0", "\[LessEqual]", "r", "\[LessEqual]", 
     "k"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JExpr", "[", 
   RowBox[{"k_", ",", "k_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{
        RowBox[{"2", "k"}], ",", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"k", "-", "j"}], ")"}]}]}], "]"}], 
      RowBox[{"EL", "[", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"k", "-", "j"}], ")"}]}], "]"}], 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"k", ",", "j", ",", "r"}], "]"}], "[", 
         RowBox[{"u", ",", "d2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", "d1"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], "/;", 
   RowBox[{
   "0", "\[LessEqual]", "r", "\[LessEqual]", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JName", "[", 
   RowBox[{"k_", ",", "i_", ",", "r_"}], "]"}], ":=", 
  RowBox[{"MyStr", "[", 
   RowBox[{"\"\<J\>\"", ",", "k", ",", "i", ",", "r"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JCached", "[", 
   RowBox[{"k_", ",", "i_", ",", "r_"}], "]"}], ":=", 
  RowBox[{"LoadOrCompute", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"JExpr", "[", 
      RowBox[{"k", ",", "i", ",", "r"}], "]"}], "//", "Simplify"}], ",", 
    RowBox[{"MyPath", "[", 
     RowBox[{"\"\<moments\>\"", ",", "\"\<J\>\"", ",", " ", 
      RowBox[{"JName", "[", 
       RowBox[{"k", ",", "i", ",", "r"}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "[", 
   RowBox[{"k_Integer", ",", "i_Integer", ",", "r_Integer"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"JCached", "[", 
         RowBox[{"k", ",", "i", ",", "r"}], "]"}], "=", 
        RowBox[{"JCached", "[", 
         RowBox[{"k", ",", "i", ",", "r"}], "]"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", 
         RowBox[{"Slot", "[", "1", "]"}]}], ",", 
        RowBox[{"d2", "\[Rule]", 
         RowBox[{"Slot", "[", "2", "]"}]}]}], "}"}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"0", "<", "k"}], "\[And]", 
    RowBox[{"0", "\[LessEqual]", "i", "\[LessEqual]", "k"}], "\[And]", 
    RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "k"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.583839145096024*^9, 3.583839204715538*^9}, {
   3.583839242695816*^9, 3.5838392535439787`*^9}, {3.583839379433187*^9, 
   3.5838394216522827`*^9}, {3.583839459050167*^9, 3.583839519879633*^9}, 
   3.583839607615676*^9, {3.583839657885984*^9, 3.583839683878462*^9}, {
   3.583839738338251*^9, 3.5838398019764357`*^9}, {3.5838414341107197`*^9, 
   3.5838414360686483`*^9}, {3.583842121182238*^9, 3.583842128330937*^9}, {
   3.583843745500452*^9, 3.583843789132607*^9}, {3.58384395774087*^9, 
   3.583843983747509*^9}, {3.584098939478774*^9, 3.584098955488655*^9}, {
   3.584099373419733*^9, 3.5840994587812777`*^9}, {3.58409997018606*^9, 
   3.584099976472538*^9}, {3.5841001917347403`*^9, 3.584100206269329*^9}, {
   3.58410209716774*^9, 3.584102115930213*^9}, {3.584102215765071*^9, 
   3.584102217418414*^9}, {3.584102606143276*^9, 3.584102624765871*^9}, {
   3.584102745665393*^9, 3.5841027471469*^9}, {3.58410291255862*^9, 
   3.584102965864738*^9}, 3.584104380910512*^9, 3.584104891370504*^9, {
   3.58410538299317*^9, 3.5841054513622427`*^9}, 3.584106202051203*^9, {
   3.58410626854979*^9, 3.584106285229735*^9}, 3.584106321556032*^9, {
   3.584106486068027*^9, 3.584106488045218*^9}, {3.5841065396201067`*^9, 
   3.584106552024911*^9}, {3.584107228285678*^9, 3.58410730764135*^9}, {
   3.5841074459184628`*^9, 3.5841074896257067`*^9}, {3.584107785331126*^9, 
   3.584107866511908*^9}, {3.584169499314823*^9, 3.584169502646659*^9}, {
   3.584169589370267*^9, 3.584169589708778*^9}, {3.584170019070119*^9, 
   3.584170028570565*^9}, {3.584336089343773*^9, 3.584336225885248*^9}, {
   3.584336267091*^9, 3.584336384895288*^9}, {3.5843364762296*^9, 
   3.584336762387247*^9}, {3.584337703570572*^9, 3.58433781212468*^9}, {
   3.584337925782783*^9, 3.5843379352732*^9}, {3.58441440571642*^9, 
   3.5844145048972683`*^9}, {3.584442124926346*^9, 3.584442129213509*^9}, {
   3.5844421636468687`*^9, 3.5844421846119957`*^9}, {3.5844422150983143`*^9, 
   3.584442222333844*^9}, 3.584442471001808*^9, {3.584442507291677*^9, 
   3.584442662848137*^9}, {3.5844431687906733`*^9, 3.5844431760207148`*^9}, {
   3.584443282016143*^9, 3.584443282695492*^9}, {3.5844433305141993`*^9, 
   3.584443362923472*^9}, {3.584443559227024*^9, 3.584443605604355*^9}, {
   3.591511902805221*^9, 3.591511909611312*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"JMExpr", ",", "JMName", ",", "JMCached", ",", "JM"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JMExpr", "[", "exponents__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "expList", ",", "h", ",", "sumVars", ",", "Jindex1", ",", "Jindex2", ",",
       "Jindex3", ",", "Jindexes", ",", "Jargs", ",", "sumBounds", ",", 
      "Iter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expList", "=", 
      RowBox[{
       RowBox[{"{", "exponents", "}"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", "=", 
      RowBox[{"Length", "[", "expList", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sumVars", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<r\>\"", "<>", 
          RowBox[{"ToString", "[", "hh", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"hh", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Jindex2", "=", 
      RowBox[{"Most", "[", "expList", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jindex1", "=", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Most", "[", "sumVars", "]"}], ",", "0"}], "]"}], "+", 
       "Jindex2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jindex3", "=", "sumVars"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jindexes", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Jindex1", ",", "Jindex2", ",", "Jindex3"}], "}"}], "//", 
       "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jargs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<delta\>\"", "<>", 
             RowBox[{"ToString", "[", "hh", "]"}]}], "]"}], "-", "r"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"hh", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sumBounds", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sumVars", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"h", "-", "1"}], "}"}]}], "]"}], ",", "Jindex1"}], "}"}], 
       "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Iter", "[", 
       RowBox[{"factor_", ",", 
        RowBox[{"{", 
         RowBox[{"Jindex_", ",", "Jarg_", ",", "sumBound_"}], "}"}]}], "]"}], 
      ":=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"factor", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"J", "@@", "Jindex"}], ")"}], "@@", "Jarg"}], ")"}]}], 
        ",", "sumBound"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{"Iter", ",", 
       RowBox[{
        RowBox[{"EGS", "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"Last", "[", "expList", "]"}]}], ",", 
          RowBox[{"2", 
           RowBox[{"Last", "[", "sumVars", "]"}]}]}], "]"}], "[", "r", "]"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Jindexes", ",", "Jargs", ",", "sumBounds"}], "}"}], "//", 
         "Transpose"}], "//", "Reverse"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JMName", "[", "exponents__", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<EG\>\"", ",", 
    RowBox[{"Riffle", "[", 
     RowBox[{
      RowBox[{"IntegerString", "/@", 
       RowBox[{"{", "exponents", "}"}]}], ",", "\"\<G\>\""}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JMCached", "[", "exponents__", "]"}], ":=", 
  RowBox[{"LoadOrCompute", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"JMExpr", "[", "exponents", "]"}], "//", "Simplify"}], ",", 
    RowBox[{"MyPath", "[", 
     RowBox[{"\"\<moments\>\"", ",", "\"\<JM\>\"", ",", 
      RowBox[{"JMName", "[", "exponents", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JM", "[", "exponents__", "]"}], ":=", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"JMCached", "[", "exponents", "]"}], "=", 
        RowBox[{"JMCached", "[", "exponents", "]"}]}], ")"}], "/.", 
      "\[IndentingNewLine]", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MySym", "[", 
            RowBox[{"\"\<delta\>\"", ",", "hh"}], "]"}], "\[Rule]", 
           RowBox[{"Slot", "[", "hh", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"hh", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "exponents", "}"}], "]"}], "-", "1"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"r", "\[Rule]", 
         RowBox[{"Slot", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "exponents", "}"}], "]"}], "]"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", "exponents", "}"}], "]"}], ">", "1"}], "\[And]", 
    RowBox[{"And", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"EvenQ", "[", "#", "]"}], "\[And]", 
         RowBox[{"#", ">", "0"}]}], "&"}], "/@", 
       RowBox[{"{", "exponents", "}"}]}], ")"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.5843511938164186`*^9, 3.5843511942379713`*^9}, {
   3.5843513630018253`*^9, 3.584351384622403*^9}, {3.584351428017096*^9, 
   3.5843514420348186`*^9}, {3.584351475894603*^9, 3.5843515101886*^9}, {
   3.584352048329707*^9, 3.5843520564219418`*^9}, {3.58435209316533*^9, 
   3.5843523007872133`*^9}, {3.58435240048919*^9, 3.584352468814745*^9}, {
   3.584361748407675*^9, 3.5843621047627687`*^9}, {3.584362146532194*^9, 
   3.584362255584416*^9}, {3.584362328192021*^9, 3.5843623411581173`*^9}, {
   3.58436243939983*^9, 3.584362746803545*^9}, {3.584362807649973*^9, 
   3.584362847542822*^9}, {3.584365024809019*^9, 3.5843650745468636`*^9}, {
   3.5843651058116517`*^9, 3.5843651068737125`*^9}, {3.5843651793228564`*^9, 
   3.5843651808369427`*^9}, {3.5843652158349447`*^9, 3.584365376787151*^9}, {
   3.584365412913217*^9, 3.584365784404465*^9}, {3.5843658311251373`*^9, 
   3.58436583204519*^9}, {3.584365863177971*^9, 3.584365882874097*^9}, {
   3.5843659168820424`*^9, 3.584365920087226*^9}, {3.5844142867671432`*^9, 
   3.58441428907486*^9}, {3.584414350582086*^9, 3.584414351074009*^9}, {
   3.58441438824328*^9, 3.584414392433198*^9}, {3.5844149024208508`*^9, 
   3.584414908634828*^9}, {3.584414982924366*^9, 3.584415025411421*^9}, {
   3.584415057708028*^9, 3.584415164337595*^9}, {3.584415444652136*^9, 
   3.584415584526105*^9}, {3.5844156456179943`*^9, 3.584415697814974*^9}, {
   3.584415734912854*^9, 3.584415738337366*^9}, {3.584415780830619*^9, 
   3.584415856275386*^9}, {3.584415957271817*^9, 3.58441595778815*^9}, {
   3.584416020535655*^9, 3.5844160383896637`*^9}, {3.584416618953536*^9, 
   3.584416634196971*^9}, {3.584417007587648*^9, 3.584417014329281*^9}, {
   3.584418046807077*^9, 3.5844180479489594`*^9}, {3.584443125196115*^9, 
   3.58444312813192*^9}, {3.584444172415312*^9, 3.584444174537483*^9}, {
   3.584444358991025*^9, 3.5844443590550117`*^9}, 3.584444401808064*^9, {
   3.5844444379499187`*^9, 3.5844444559285603`*^9}, {3.584444658390078*^9, 
   3.584444660717733*^9}, {3.584445994935824*^9, 3.584446066015276*^9}, {
   3.584446099423307*^9, 3.58444612448882*^9}, {3.584446495992127*^9, 
   3.584446587212322*^9}, {3.584446711085236*^9, 3.584446713274427*^9}, {
   3.5844472636288147`*^9, 3.584447265345084*^9}, {3.584447380347527*^9, 
   3.584447412751334*^9}, 3.584447481497933*^9, {3.584447603171547*^9, 
   3.584447674877665*^9}, {3.587210954453331*^9, 3.587210956662768*^9}, {
   3.59151192778539*^9, 3.59151193346349*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EG", "[", "exponent_", "]"}], ":=", 
  RowBox[{"EGS", "[", 
   RowBox[{"exponent", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EG", "[", "exponents__", "]"}], ":=", 
  RowBox[{"JM", "[", "exponents", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EGName", "[", "exponents_", "]"}], ":=", 
  RowBox[{"\"\<E\>\"", "<>", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<G\>\"", "<>", 
       RowBox[{"IntegerString", "[", "#", "]"}]}], "&"}], "/@", "exponents"}],
     "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.587207108807716*^9, 3.587207190404015*^9}, {
  3.5872072708666267`*^9, 3.587207275823298*^9}, {3.5872079768629313`*^9, 
  3.587207980585743*^9}, {3.587373884812249*^9, 3.587373889496437*^9}, {
  3.587985568119751*^9, 3.58798556842766*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Extract exponents coefficients ", "Subsection",
 CellChangeTimes->{{3.585791147034127*^9, 3.5857911472238398`*^9}, {
  3.5879596082000637`*^9, 3.5879596188500843`*^9}, {3.58795968685625*^9, 
  3.587959687744053*^9}, {3.5879597378256693`*^9, 3.587959739136116*^9}, {
  3.5879597908423433`*^9, 3.587959803664343*^9}}],

Cell["\<\
We encode exponentials with exponent \[CapitalPsi][i]\[Delta][j] with a two \
character code. The first character ranges ranges on A, B, C, D, chosen \
orderly depending on the argument of \[CapitalPsi] (which ranges on 1,2,3,4). \
The second character ranges on W, D, H, chosen orderly depending on the \
argument of \[Delta] (that ranges on 1,2,3). Note that \[CapitalPsi][4] never \
appears as an exponent in our expressions.\
\>", "Text",
 CellChangeTimes->{{3.591500266712224*^9, 3.5915005693558807`*^9}, {
  3.591500647652471*^9, 3.591500796421801*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExponentialsToNames", "[", "expr_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"ReplaceAll", ",", "expr", ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", "e_", "]"}], "\[RuleDelayed]", 
       RowBox[{"SecretExp", "[", 
        RowBox[{"Expand", "[", "e", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SecretExp", "[", "e_Plus", "]"}], "\[RuleDelayed]", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"SecretExp", "/@", "e"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SecretExp", "[", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", "i_", "]"}], 
         RowBox[{"\[Delta]", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Symbol", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Characters", "[", "\"\<ABCD\>\"", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<>", 
         RowBox[{
          RowBox[{"Characters", "[", "\"\<WDH\>\"", "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SecretExp", "\[Rule]", "Exp"}]}], "\[IndentingNewLine]", 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.585660352317823*^9, 3.5856603806824102`*^9}, {
  3.585749749031118*^9, 3.585749902825273*^9}, {3.585749943659502*^9, 
  3.585749985529662*^9}, {3.585750020238052*^9, 3.585750057115005*^9}, {
  3.585750096718635*^9, 3.585750124581848*^9}, {3.585801896124876*^9, 
  3.58580190972795*^9}, {3.5858058114488573`*^9, 3.58580581212399*^9}, {
  3.59142843637223*^9, 3.59142844162481*^9}, {3.5915000636102552`*^9, 
  3.5915000854595957`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NamesToExponentials", "=", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Characters", "[", "\"\<ABCD\>\"", "]"}], "[", 
          RowBox[{"[", "#1", "]"}], "]"}], "<>", 
         RowBox[{
          RowBox[{"Characters", "[", "\"\<WDH\>\"", "]"}], "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"\[CapitalPsi]", "[", "#1", "]"}], 
         RowBox[{"\[Delta]", "[", "#2", "]"}]}], "]"}]}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.591499986549857*^9, 3.591499987748551*^9}, {
  3.591500114180036*^9, 3.591500118308854*^9}, {3.591500161683009*^9, 
  3.5915001984940977`*^9}, {3.591500817200281*^9, 3.591500826433896*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"AW", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "1", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "1", "]"}]}]]}], ",", 
   RowBox[{"AD", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "2", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "1", "]"}]}]]}], ",", 
   RowBox[{"AH", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "3", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "1", "]"}]}]]}], ",", 
   RowBox[{"BW", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "1", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "2", "]"}]}]]}], ",", 
   RowBox[{"BD", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "2", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "2", "]"}]}]]}], ",", 
   RowBox[{"BH", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "3", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "2", "]"}]}]]}], ",", 
   RowBox[{"CW", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "1", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "3", "]"}]}]]}], ",", 
   RowBox[{"CD", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "2", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "3", "]"}]}]]}], ",", 
   RowBox[{"CH", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "3", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "3", "]"}]}]]}], ",", 
   RowBox[{"DW", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "1", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "4", "]"}]}]]}], ",", 
   RowBox[{"DD", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "2", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "4", "]"}]}]]}], ",", 
   RowBox[{"DH", "\[Rule]", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "3", "]"}], " ", 
      RowBox[{"\[CapitalPsi]", "[", "4", "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.596434793277399*^9, 3.596434935010233*^9, 
  3.596435829885002*^9, 3.596441004692706*^9, 3.596441146725951*^9, 
  3.596441180504766*^9, 3.596442957126478*^9, 3.596448843026813*^9, 
  3.596546884235219*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExponentialNames", "=", 
  RowBox[{"First", "/@", "NamesToExponentials"}]}]], "Input",
 CellChangeTimes->{{3.5858058363111887`*^9, 3.585805847608694*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "AW", ",", "AD", ",", "AH", ",", "BW", ",", "BD", ",", "BH", ",", "CW", ",",
    "CD", ",", "CH", ",", "DW", ",", "DD", ",", "DH"}], "}"}]], "Output",
 CellChangeTimes->{3.596434793333914*^9, 3.596434935084299*^9, 
  3.596435829976323*^9, 3.5964410047394733`*^9, 3.5964411470242233`*^9, 
  3.596441180542506*^9, 3.5964429571951838`*^9, 3.596448843208125*^9, 
  3.59654688424673*^9}]
}, Open  ]],

Cell["Encode a list of exponents as a symbol.", "Text",
 CellChangeTimes->{{3.579063706875512*^9, 3.579063757952426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExponentListToSymbol", "[", 
   RowBox[{"exponents_", ",", "prefix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ExpToString", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ExpToString", "[", 
       RowBox[{"exp_", ",", "name_"}], "]"}], ":=", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "exp", ",", "\[IndentingNewLine]", "0", ",", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", "1", ",", "name", ",", "\[IndentingNewLine]", 
        "_", ",", 
        RowBox[{"name", "<>", 
         RowBox[{"ToString", "[", "exp", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coeff", "[", 
      RowBox[{"Symbol", "[", 
       RowBox[{"prefix", "<>", "\"\<c\>\"", "<>", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"ExpToString", ",", 
           RowBox[{"{", 
            RowBox[{"exponents", ",", 
             RowBox[{"ToString", "/@", "ExponentialNames"}]}], "}"}]}], "]"}],
          "]"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.5789105045268583`*^9, 3.5789105503645477`*^9}, {
   3.578911053466173*^9, 3.578911079111865*^9}, {3.578913683087743*^9, 
   3.578913730042549*^9}, 3.578913893304525*^9, {3.5789140079073763`*^9, 
   3.5789140801093683`*^9}, {3.578917296375153*^9, 3.5789173345060787`*^9}, {
   3.5789173715080767`*^9, 3.578917374927247*^9}, {3.578919706724846*^9, 
   3.578919717291136*^9}, {3.585802022677796*^9, 3.585802160088784*^9}, 
   3.5858022300748034`*^9, {3.5858029104977903`*^9, 3.58580291174578*^9}, 
   3.585805857073292*^9, {3.588333388794783*^9, 3.588333396837574*^9}, {
   3.588398338284086*^9, 3.588398338363316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MomentToCoefficients", "[", 
   RowBox[{"name_String", ",", "expr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fff", ",", "coefficientsRaw", ",", "coefficients", ",", "moment"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", 
      RowBox[{
      "\"\<Splitting \>\"", "<>", "name", "<>", 
       "\"\< in coefficients...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fff", "[", 
       RowBox[{"expList_", "\[Rule]", "coeff_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"ExponentListToSymbol", "[", 
        RowBox[{"expList", ",", "name"}], "]"}], "\[Rule]", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Factor", "[", "coeff", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coefficientsRaw", "=", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{
        RowBox[{"ExponentialsToNames", "[", "expr", "]"}], ",", 
        "ExponentialNames"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"moment", "=", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ExponentListToSymbol", "[", 
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], ",", "name"}], "]"}], 
           RowBox[{"Inner", "[", 
            RowBox[{"Power", ",", "ExponentialNames", ",", 
             RowBox[{"First", "[", "#", "]"}], ",", "Times"}], "]"}]}], "&"}],
          "/@", "coefficientsRaw"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coefficients", "=", 
      RowBox[{"fff", "/@", "coefficientsRaw"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Prepend", "[", 
      RowBox[{"coefficients", ",", 
       RowBox[{
        RowBox[{"Symbol", "[", "name", "]"}], "\[Rule]", "moment"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.585802373598402*^9, 3.585802401676235*^9}, {
   3.58580482168552*^9, 3.585804861253093*^9}, {3.585804900363309*^9, 
   3.5858049353376207`*^9}, {3.585804986332468*^9, 3.585805154293222*^9}, {
   3.585805187670186*^9, 3.585805188590756*^9}, {3.58580572525482*^9, 
   3.585805782552376*^9}, {3.5858062747556343`*^9, 3.5858063398718023`*^9}, {
   3.585820039201973*^9, 3.585820084421763*^9}, {3.5858201156165533`*^9, 
   3.585820223829356*^9}, {3.585820255920878*^9, 3.5858202763769417`*^9}, {
   3.585820315285578*^9, 3.5858203179728727`*^9}, {3.5858216819229507`*^9, 
   3.585821728090803*^9}, {3.5858217890971537`*^9, 3.585821883485627*^9}, {
   3.58582241742807*^9, 3.585822422480875*^9}, {3.587198623637899*^9, 
   3.587198646394402*^9}, 3.587198678760685*^9, {3.587293071748213*^9, 
   3.5872930783089037`*^9}, {3.587293374570945*^9, 3.587293399183958*^9}, {
   3.587359495304249*^9, 3.587359544099663*^9}, {3.587985609818385*^9, 
   3.5879856434012833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListMomentIndexes", "[", "order_Integer", "]"}], ":=", 
  RowBox[{
   RowBox[{"Reverse", "[", 
    RowBox[{"2", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Permutations", "/@", 
        RowBox[{"IntegerPartitions", "[", 
         FractionBox["order", "2"], "]"}]}], ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{"EvenQ", "[", "order", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.591524624331442*^9, 3.591524677822311*^9}, {
  3.5915247322034063`*^9, 3.591524754506742*^9}, {3.591524815669729*^9, 
  3.591524841231962*^9}, {3.591525078174646*^9, 3.5915250864711943`*^9}}],

Cell["\<\
The order the moments are listed in is important, since they have to appear \
in this order as cases in a switch statement in the generated C code.\
\>", "Text",
 CellChangeTimes->{{3.591704421826271*^9, 3.5917044468747873`*^9}, {
  3.591704500639791*^9, 3.591704583233078*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"moment2Indexes", "=", 
   RowBox[{"{", 
    RowBox[{"{", "2", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"moment4Indexes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"moment6Indexes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"moment8Indexes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "8", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momentIndexes", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "moment2Indexes", ",", "moment4Indexes", ",", "moment6Indexes", ",", 
     "moment8Indexes"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5872078269810467`*^9, 3.5872079431248493`*^9}, {
   3.5872100850583477`*^9, 3.587210104533845*^9}, 3.587210316529442*^9, {
   3.5879694419500437`*^9, 3.587969443573084*^9}, {3.593522268932571*^9, 
   3.593522302978073*^9}, {3.593522358852276*^9, 3.5935224080283833`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EGArgs", "[", 
   RowBox[{"{", "_", "}"}], "]"}], ":=", 
  RowBox[{"{", "t", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EGArgs", "[", "exponents_", "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"\[Delta]", "/@", 
     RowBox[{"Most", "[", 
      RowBox[{"Accumulate", "[", 
       RowBox[{"exponents", "/", "2"}], "]"}], "]"}]}], ",", "r"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5872878875451612`*^9, 3.5872879772649527`*^9}, {
  3.587288092254161*^9, 3.587288167168435*^9}, {3.587288206724779*^9, 
  3.587288206830258*^9}, {3.587291379682251*^9, 3.5872913968168583`*^9}, {
  3.5872914625379457`*^9, 3.587291467930992*^9}, {3.587291663286077*^9, 
  3.587291665212141*^9}, {3.587382250499382*^9, 3.587382268077677*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeCoefficients", "[", 
   RowBox[{"name_String", ",", "indexes_"}], "]"}], ":=", 
  RowBox[{"MyParallelCachedMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MomentToCoefficients", "[", 
      RowBox[{
       RowBox[{"EGName", "[", "#", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"EG", "@@", "#"}], ")"}], "@@", 
        RowBox[{"EGArgs", "[", "#", "]"}]}]}], "]"}], "&"}], ",", "indexes", 
    ",", 
    RowBox[{"MyPath", "[", 
     RowBox[{"\"\<moments\>\"", ",", "\"\<Coefficients\>\"", ",", "name"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.587378043425844*^9, 3.5873780811032*^9}, {
  3.587969395572494*^9, 3.587969416114689*^9}, {3.587980123222398*^9, 
  3.587980124239929*^9}, {3.588403243890645*^9, 3.5884032790114927`*^9}, {
  3.591501436619433*^9, 3.591501454133347*^9}, {3.591513092222845*^9, 
  3.591513108956684*^9}, {3.59151315475994*^9, 3.591513163302733*^9}, {
  3.591514052958284*^9, 3.5915140689813967`*^9}, {3.591514384545998*^9, 
  3.591514414777042*^9}, {3.5915200503218203`*^9, 3.591520057554305*^9}, {
  3.5915205106446743`*^9, 3.5915205128041477`*^9}, {3.596435483856915*^9, 
  3.596435491846546*^9}, {3.596435587231509*^9, 3.596435588358749*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert Expressions to C", "Subsection",
 CellChangeTimes->{{3.5860950017118273`*^9, 3.586095004814591*^9}, {
  3.587961305566779*^9, 3.5879613073012238`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"powerFuncSubs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"y_", "/;", 
         RowBox[{
          RowBox[{"y", "\[Element]", "Integers"}], "&&", 
          RowBox[{"y", "<", 
           RowBox[{"-", "1"}]}]}]}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<Power\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"-", "y"}], "]"}]}], "]"}], "[", 
       RowBox[{"1", "/", "x"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"y_", "/;", 
         RowBox[{
          RowBox[{"y", "\[Element]", "Integers"}], "&&", 
          RowBox[{"y", ">", "1"}]}]}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<Power\>\"", "<>", 
         RowBox[{"IntegerString", "[", "y", "]"}]}], "]"}], "[", "x", "]"}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"E", ",", "y_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Exponential", "[", "y", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Max3", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Min3", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.578998398062252*^9, 3.578998407120541*^9}, {
   3.578998521617898*^9, 3.57899855144681*^9}, {3.579428853569434*^9, 
   3.5794288599298887`*^9}, {3.579428950233567*^9, 3.5794290106804943`*^9}, {
   3.5814255464713697`*^9, 3.5814255465774193`*^9}, {3.582966843967614*^9, 
   3.582966854973529*^9}, 3.582968966587081*^9, 3.582976016229823*^9, {
   3.587189069160927*^9, 3.58718907470931*^9}, {3.5872003350850563`*^9, 
   3.587200349796233*^9}, {3.587200863172887*^9, 3.5872008634891977`*^9}, {
   3.5872009756005373`*^9, 3.58720101460684*^9}, 3.5872010449493237`*^9, {
   3.587201107874614*^9, 3.587201136916849*^9}, {3.587300440564694*^9, 
   3.58730044189812*^9}, {3.5873816664840593`*^9, 3.587381687613614*^9}, {
   3.5873817243412647`*^9, 3.587381731802733*^9}, {3.589545968861773*^9, 
   3.5895459882079067`*^9}, {3.589546041625483*^9, 3.589546042305978*^9}, {
   3.589546123556072*^9, 3.589546206805958*^9}, {3.590130253193959*^9, 
   3.590130254606536*^9}, {3.594472720379719*^9, 3.594472730079973*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymbolsToC", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "\[Rule]", "kappa"}], ",", 
     RowBox[{"\[Nu]", "\[Rule]", "nu"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", "beta"}], ",", 
     RowBox[{"\[Eta]", "\[Rule]", "eta"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{
      RowBox[{"\[CapitalPsi]", "[", "i_Integer", "]"}], "\[RuleDelayed]", 
      RowBox[{"MySym", "[", 
       RowBox[{"Psi", ",", "i"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"b", "[", "i_", "]"}], "\[RuleDelayed]", 
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{
      SubscriptBox["a", "0"], "\[Rule]", "azero"}], ",", 
     RowBox[{
      RowBox[{"coeff", "[", "i_", "]"}], "\[RuleDelayed]", 
      RowBox[{"coeff", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"psiexp", "[", "i_", "]"}], "\[RuleDelayed]", 
      RowBox[{"psiexp", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.586095018580516*^9, 3.5860951566466637`*^9}, 
   3.587200441190205*^9, 3.5872005101689377`*^9, {3.587294493127706*^9, 
   3.5872945437709084`*^9}, {3.5872945886601677`*^9, 3.587294624488529*^9}, {
   3.5872972661358023`*^9, 3.587297267243505*^9}, 3.587365966534429*^9, {
   3.5883125704507017`*^9, 3.588312595125401*^9}, {3.588398320558858*^9, 
   3.5883983226731*^9}, {3.588398620567893*^9, 3.58839864541103*^9}, {
   3.588401109275941*^9, 3.5884011287926083`*^9}, {3.58841926162918*^9, 
   3.588419284997408*^9}, 3.588419347684607*^9, {3.592486140271029*^9, 
   3.5924861482421913`*^9}, {3.5933346734545383`*^9, 3.593334676321397*^9}, 
   3.5933383007481728`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimpleExprToC", "[", "expr_", "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "//.", "powerFuncSubs"}], ")"}], "//", "SymbolsToC"}],
       "//", "CForm"}], "//", "ToString"}], ",", 
    RowBox[{"{", 
     StyleBox[
      RowBox[{
       RowBox[{"Part", "::", "pspec"}], ",", 
       RowBox[{"Part", "::", "partd"}]}], "MessageName"], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.578998765908993*^9, 3.578998800431834*^9}, 
   3.5790639537061043`*^9, 3.57943386717498*^9, {3.5807082238855457`*^9, 
   3.580708246901956*^9}, {3.580712323883595*^9, 3.580712378298661*^9}, {
   3.5807979541842318`*^9, 3.580797962164874*^9}, {3.584070588873321*^9, 
   3.5840705901080313`*^9}, {3.584079065862568*^9, 3.584079102529642*^9}, {
   3.584079285313995*^9, 3.584079290755331*^9}, {3.584079339460094*^9, 
   3.5840793425384398`*^9}, {3.584095521848782*^9, 3.584095531506155*^9}, {
   3.584178625912492*^9, 3.584178626502028*^9}, {3.584768929116556*^9, 
   3.584768940584281*^9}, {3.584769295589821*^9, 3.584769299339307*^9}, {
   3.58718908998378*^9, 3.587189096485671*^9}, 3.5872004388788223`*^9, {
   3.587200505317861*^9, 3.587200512303254*^9}, 3.5873816114503117`*^9, {
   3.5883126037940693`*^9, 3.58831264992391*^9}, {3.58900111333176*^9, 
   3.589001113679291*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "AssignVarC", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssignVarC", "[", 
   RowBox[{"varName_", ",", "expr_", ",", "mode_Symbol"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"type", ",", "operator", ",", "assignment"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "mode", ",", "\[IndentingNewLine]", "Declaration", ",", 
        "\"\<scalar \>\"", ",", "\[IndentingNewLine]", "_", ",", "\"\<\>\""}],
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"operator", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "mode", ",", "\[IndentingNewLine]", "Declaration", ",", "\"\<=\>\"", 
        ",", "\[IndentingNewLine]", "Assignment", ",", "\"\<=\>\"", ",", 
        "\[IndentingNewLine]", "AdditionAssignment", ",", "\"\<+=\>\""}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assignment", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "expr", ",", "\[IndentingNewLine]", "Null", ",", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", "_", ",", 
        RowBox[{"\"\< \>\"", "<>", "operator", "<>", "\"\< \>\"", "<>", 
         RowBox[{"SimpleExprToC", "[", "expr", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "type", "<>", "varName", "<>", "assignment", "<>", "\"\<;\>\""}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssignVarC", "[", 
   RowBox[{
    RowBox[{"var_", "\[Rule]", "expr_"}], ",", "mode_Symbol"}], "]"}], ":=", 
  RowBox[{"AssignVarC", "[", 
   RowBox[{
    RowBox[{"SimpleExprToC", "[", "var", "]"}], ",", "expr", ",", "mode"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.583044807073142*^9, 3.583044835325528*^9}, {
   3.583044949851877*^9, 3.583044975506647*^9}, {3.5830457939968243`*^9, 
   3.583045838304339*^9}, {3.583046094197013*^9, 3.5830461227961903`*^9}, 
   3.584070623436404*^9, {3.584072448439474*^9, 3.584072489675626*^9}, {
   3.584078767580604*^9, 3.5840789969842577`*^9}, {3.584079040347062*^9, 
   3.5840790412333517`*^9}, {3.584079167648028*^9, 3.584079175329084*^9}, {
   3.584079743539464*^9, 3.584079756549782*^9}, {3.5840798252312202`*^9, 
   3.58408001825839*^9}, {3.584090414679407*^9, 3.5840906729007196`*^9}, {
   3.584090783495365*^9, 3.5840909711201973`*^9}, 3.588398187044224*^9, {
   3.588398238761086*^9, 3.588398305874268*^9}, {3.588398366487988*^9, 
   3.5883983850743523`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AssignVarC", "[", 
   RowBox[{"\"\<x\>\"", ",", "Null", ",", "Declaration"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssignVarC", "[", 
   RowBox[{"\"\<v\>\"", ",", 
    RowBox[{"a", "+", "b"}], ",", "Declaration"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssignVarC", "[", 
   RowBox[{"\"\<v\>\"", ",", 
    RowBox[{
     RowBox[{"b", "[", "i", "]"}], 
     RowBox[{"b", "[", "j", "]"}]}], ",", "AdditionAssignment"}], "]"}], "//",
   "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssignVarC", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"coeff", "[", "MOMENTcCOEFF", "]"}], "\[Rule]", 
     RowBox[{"a", "+", "b"}]}], ",", "Assignment"}], "]"}], "//", 
  "Test"}]}], "Input",
 CellChangeTimes->{{3.583044807073142*^9, 3.583044835325528*^9}, {
   3.583044949851877*^9, 3.583044975506647*^9}, {3.5830457939968243`*^9, 
   3.583045838304339*^9}, {3.583046094197013*^9, 3.5830461227961903`*^9}, 
   3.584070623436404*^9, {3.584072448439474*^9, 3.584072489675626*^9}, {
   3.584078767580604*^9, 3.5840789969842577`*^9}, {3.584079040347062*^9, 
   3.5840790412333517`*^9}, {3.584079167648028*^9, 3.584079175329084*^9}, {
   3.584079743539464*^9, 3.584079756549782*^9}, {3.5840798252312202`*^9, 
   3.58408001825839*^9}, {3.584090414679407*^9, 3.5840906729007196`*^9}, {
   3.584090783495365*^9, 3.5840909711201973`*^9}, 3.588398187044224*^9, {
   3.588398663745036*^9, 3.588398726976605*^9}, {3.588399059446814*^9, 
   3.5883990764437723`*^9}, {3.5901384005239677`*^9, 3.590138425066045*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlattenCode", "[", "code_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"code", "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"lines", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Except", "[", "\"\<\>\"", "]"}], ",", "___"}], "}"}]}], 
        "\[RuleDelayed]", 
        RowBox[{"Prepend", "[", 
         RowBox[{"lines", ",", "\"\<\>\""}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"lines", ":", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Except", "[", "\"\<\>\"", "]"}]}], "}"}]}], 
        "\[RuleDelayed]", 
        RowBox[{"Append", "[", 
         RowBox[{"lines", ",", "\"\<\>\""}], "]"}]}]}], "}"}]}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", "lines__"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"lines__", ",", "\"\<\>\""}], "}"}]}], "\[RuleDelayed]", 
      RowBox[{"{", "lines", "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "linesA__", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", "linesB__"}], "}"}],
       "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{"linesA", ",", "\"\<\>\"", ",", "linesB"}], "}"}]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlattenCode", "[", "lines__", "]"}], ":=", 
  RowBox[{"FlattenCode", "[", 
   RowBox[{"{", "lines", "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.594032345954708*^9, 3.594032352709206*^9}, {
  3.594032389835723*^9, 3.5940325438975773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"LineJoin", "[", 
     RowBox[{"lines", ":", 
      RowBox[{"{", 
       RowBox[{"_String", "..."}], "}"}]}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Riffle", "[", 
      RowBox[{"lines", ",", "\"\<\\n\>\""}], "]"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PrintCCode", "[", "lines__", "]"}], ":=", 
   RowBox[{"Print", "/@", 
    RowBox[{"FlattenCode", "[", "lines", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5840914599682407`*^9, 3.5840914706491423`*^9}, {
  3.59404047817715*^9, 3.594040586572524*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteCBlock", "[", 
   RowBox[{"innerLines", ":", 
    RowBox[{"{", 
     RowBox[{"_String", ".."}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "varName", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\"\<{\>\"", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<\\t\>\"", "<>", "#"}], "&"}], "/@", "innerLines"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\"\<}\>\"", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteCBlock", "[", "innerLines_List", "]"}], ":=", 
  RowBox[{"WriteCBlock", "[", 
   RowBox[{"FlattenCode", "[", "innerLines", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteCBlock", "[", "innerLines__", "]"}], ":=", 
  RowBox[{"WriteCBlock", "[", 
   RowBox[{"FlattenCode", "[", 
    RowBox[{"{", "innerLines", "}"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.587960031941004*^9, 3.587960037208255*^9}, 
   3.587962638857747*^9, {3.593517640006423*^9, 3.59351765936775*^9}, {
   3.593869054814625*^9, 3.5938690923758793`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Coefficients", "Subsection",
 CellChangeTimes->{{3.5892677794792843`*^9, 3.589267824682001*^9}, {
  3.590138436710595*^9, 3.590138439293151*^9}, {3.596349534493227*^9, 
  3.596349535389917*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"moments2", "=", 
   RowBox[{"ComputeCoefficients", "[", 
    RowBox[{"\"\<moments2\>\"", ",", "moment2Indexes"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moments4", "=", 
   RowBox[{"ComputeCoefficients", "[", 
    RowBox[{"\"\<moments4\>\"", ",", "moment4Indexes"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moments6", "=", 
   RowBox[{"ComputeCoefficients", "[", 
    RowBox[{"\"\<moments6\>\"", ",", "moment6Indexes"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moments8", "=", 
   RowBox[{"ComputeCoefficients", "[", 
    RowBox[{"\"\<moments8\>\"", ",", "moment8Indexes"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moments", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"moments2", ",", "moments4", ",", "moments6", ",", "moments8"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5915205654297457`*^9, 3.591520568381487*^9}, {
  3.591704306941553*^9, 3.591704325570539*^9}, {3.596435602351706*^9, 
  3.5964356198698463`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Coefficient consistency checks", "Subsection",
 CellChangeTimes->{{3.591525408746769*^9, 3.591525417205186*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListMomentIndexes", "[", "order_Integer", "]"}], ":=", 
  RowBox[{
   RowBox[{"Reverse", "[", 
    RowBox[{"2", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Permutations", "/@", 
        RowBox[{"IntegerPartitions", "[", 
         FractionBox["order", "2"], "]"}]}], ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{"EvenQ", "[", "order", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.591524624331442*^9, 3.591524677822311*^9}, {
  3.5915247322034063`*^9, 3.591524754506742*^9}, {3.591524815669729*^9, 
  3.591524841231962*^9}, {3.591525078174646*^9, 3.5915250864711943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpWithDeltas", "[", "deltas0_", "]"}], ":=", 
   RowBox[{"First", "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"NamesToExponentials", ",", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Alternatives", "@@", "deltas0"}], ",", "\[Infinity]"}], 
        "]"}], "&"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.591621977445224*^9, 3.591622002038645*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpWithoutDeltas", "[", "deltas0_", "]"}], ":=", 
   RowBox[{"First", "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"NamesToExponentials", ",", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Alternatives", "@@", "deltas0"}]}], "]"}], "&"}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.591600227954751*^9, {3.5916219705016727`*^9, 3.591621970809903*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RelevantRule", "[", 
   RowBox[{"A_", "\[Rule]", "B_"}], "]"}], ":=", 
  RowBox[{"Not", "[", 
   RowBox[{"SameQ", "[", 
    RowBox[{"A", ",", "B"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"RelevantRule", "[", 
    RowBox[{"a", "\[Rule]", "b"}], "]"}], ",", "True"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"RelevantRule", "[", 
    RowBox[{"a", "\[Rule]", "a"}], "]"}], ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.59161798016877*^9, 3.591618127253223*^9}, {
  3.5916189138545017`*^9, 3.591618936372364*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MomentNameToExpr", "[", "name_", "]"}], ":=", 
  RowBox[{"name", "/.", 
   RowBox[{"(", 
    RowBox[{"First", "/@", 
     RowBox[{"Join", "[", 
      RowBox[{"moments2", ",", "moments4", ",", "moments6", ",", "moments8"}],
       "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"MomentNameToExpr", "[", "EG2G2", "]"}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2c", "]"}], "+", 
    RowBox[{"AW", " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.591618469360633*^9, 3.591618613317834*^9}, {
  3.5916187837331533`*^9, 3.591618907947887*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MomentIndexesToExpr", "[", "indexes_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"name", "=", 
      RowBox[{"Symbol", "[", 
       RowBox[{"EGName", "[", "indexes", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"MomentNameToExpr", "[", "name", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"MomentIndexesToExpr", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], "]"}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2c", "]"}], "+", 
    RowBox[{"AW", " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5916207408040123`*^9, 3.591620906725239*^9}, {
  3.591620949981433*^9, 3.5916210187060413`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ASDF", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ASDF", "[", "indexes_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "deltas", ",", "deltaSubsets", ",", "indArgList0", ",", "LimitDelta", 
      ",", "LimitDeltaL", ",", "ToMomentCoeff", ",", "decompositions", ",", 
      "LimitBelta", ",", "bbq", ",", "equalities"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"LimitDelta", "[", 
       RowBox[{"indArgList_", ",", "\[Delta]_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"indArgList", ",", "\[Delta]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"p", ",", "\[IndentingNewLine]", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "indArgList", "}"}], ",", "\[IndentingNewLine]", "_", 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"indArgList", ",", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "]"}], 
             ",", 
             RowBox[{"Drop", "[", 
              RowBox[{"indArgList", ",", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LimitDeltaL", "[", 
       RowBox[{"indArgListList_", ",", "\[Delta]_"}], "]"}], ":=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"LimitDelta", "[", 
           RowBox[{"#", ",", "\[Delta]"}], "]"}], "&"}], "/@", 
         "indArgListList"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"LimitBelta", "[", "decomposition_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"deltasToInf", ",", "expToZero"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deltasToInf", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"deltas", ",", 
            RowBox[{
             RowBox[{"Alternatives", "@@", 
              RowBox[{"Cases", "[", 
               RowBox[{"decomposition", ",", 
                RowBox[{"\[Delta]", "[", "_", "]"}], ",", "\[Infinity]"}], 
               "]"}]}], "//", "Union"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"expToZero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", "0"}], "&"}], "/@", 
           RowBox[{"ExpWithDeltas", "[", "deltasToInf", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MomentIndexesToExpr", "[", "indexes", "]"}], "/.", 
          "expToZero"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ToMomentCoeff", "[", "indArgList_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "indexes0", ",", "exp0", ",", "exp1", ",", "name", ",", "subs"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indexes0", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"indArgList", ",", "_Integer"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"exp0", "=", 
          RowBox[{"ExpWithDeltas", "[", 
           RowBox[{
            RowBox[{"EGArgs", "[", "indexes0", "]"}], "//", "Most"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"exp1", "=", 
          RowBox[{"ExpWithDeltas", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"indArgList", ",", 
             RowBox[{"\[Delta]", "[", "_", "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"subs", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"exp0", ",", "exp1"}], "}"}]}], "]"}], ",", 
            "RelevantRule"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MomentIndexesToExpr", "[", "indexes0", "]"}], "/.", 
          "subs"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deltas", "=", 
      RowBox[{
       RowBox[{"indexes", "//", "EGArgs"}], "//", "Most"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indArgList0", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{"indexes", ",", "deltas"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deltaSubsets", "=", 
      RowBox[{
       RowBox[{"deltas", "//", "Subsets"}], "//", "Rest"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"decompositions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Fold", "[", 
         RowBox[{"LimitDeltaL", ",", 
          RowBox[{"{", "indArgList0", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
       "deltaSubsets"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bbq", "=", 
      RowBox[{"Times", "@@@", 
       RowBox[{"Map", "[", 
        RowBox[{"ToMomentCoeff", ",", "decompositions", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"equalities", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Equal", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LimitBelta", "/@", "decompositions"}], ",", "bbq"}], 
         "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ASDF", "[", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], "]"}], "//", "Test"}]}], "Input",\

 CellChangeTimes->{{3.591591133818268*^9, 3.591591274316576*^9}, {
   3.5915913291685963`*^9, 3.591591346340047*^9}, {3.591591413366066*^9, 
   3.591591509401391*^9}, {3.591591546087241*^9, 3.591591729912982*^9}, {
   3.591591823980198*^9, 3.5915918248912907`*^9}, {3.5915919040693073`*^9, 
   3.591591909482011*^9}, {3.591591947241781*^9, 3.5915919574865093`*^9}, {
   3.591592045996524*^9, 3.591592062670437*^9}, {3.591592125753641*^9, 
   3.591592214899287*^9}, {3.591592257975553*^9, 3.591592267083797*^9}, {
   3.591592298723486*^9, 3.591592324232133*^9}, {3.591592358043236*^9, 
   3.5915925256742487`*^9}, {3.591592587748109*^9, 3.5915927677406588`*^9}, {
   3.591592806508917*^9, 3.591592867390431*^9}, {3.591592925243658*^9, 
   3.591593057252707*^9}, {3.5915931224728737`*^9, 3.5915932517593184`*^9}, {
   3.59159328312272*^9, 3.5915933588445883`*^9}, {3.5915934014943447`*^9, 
   3.591593458363728*^9}, 3.591593502449544*^9, {3.591593538103031*^9, 
   3.5915936081506863`*^9}, {3.5915938304624567`*^9, 3.591593953438777*^9}, {
   3.59159399004603*^9, 3.59159408253314*^9}, {3.591594113442751*^9, 
   3.5915941927407618`*^9}, {3.591595592194791*^9, 3.591595801469164*^9}, {
   3.5915958624735518`*^9, 3.59159590940903*^9}, {3.59159712373892*^9, 
   3.5915971500025473`*^9}, {3.591597189742832*^9, 3.591597192905417*^9}, {
   3.591597509563403*^9, 3.591597554876451*^9}, {3.59159764740633*^9, 
   3.59159767809772*^9}, {3.5915978154965754`*^9, 3.5915978718561907`*^9}, {
   3.591598726918069*^9, 3.591598845586308*^9}, {3.591598898072991*^9, 
   3.591598904781122*^9}, {3.591598955661126*^9, 3.591598976063596*^9}, {
   3.59159901298146*^9, 3.591599117759263*^9}, {3.5915991837113037`*^9, 
   3.5915992292513733`*^9}, {3.591599265874292*^9, 3.591599674076783*^9}, {
   3.5915997302829227`*^9, 3.591599772201489*^9}, {3.591599805032041*^9, 
   3.5915999209387074`*^9}, {3.59160013492793*^9, 3.591600147745083*^9}, {
   3.591600200348913*^9, 3.591600220140645*^9}, 3.5916002530735083`*^9, {
   3.591600403258625*^9, 3.5916005514919977`*^9}, {3.591600663822941*^9, 
   3.59160072828545*^9}, {3.591600773208393*^9, 3.591600776046865*^9}, {
   3.591615869947554*^9, 3.5916159171200323`*^9}, {3.591615981120088*^9, 
   3.591615993441656*^9}, {3.5916181370064583`*^9, 3.59161815897016*^9}, {
   3.591618719028007*^9, 3.5916187693473377`*^9}, {3.591618967233036*^9, 
   3.591619022169629*^9}, 3.591619054448296*^9, {3.5916204694227448`*^9, 
   3.591620480526696*^9}, {3.591620590497766*^9, 3.591620591073241*^9}, {
   3.591620719542885*^9, 3.591620730917657*^9}, {3.591621035240424*^9, 
   3.591621096238819*^9}, {3.5916212524765253`*^9, 3.591621365445106*^9}, {
   3.591621408260371*^9, 3.591621538413425*^9}, {3.5916216084870367`*^9, 
   3.591621799330736*^9}, {3.591621831098995*^9, 3.591621947840763*^9}, {
   3.5916220350746326`*^9, 3.5916221022738457`*^9}, {3.5916221361707993`*^9, 
   3.591622197105275*^9}, {3.5916222315176992`*^9, 3.591622234438991*^9}, {
   3.591622271901301*^9, 3.591622294450189*^9}, {3.591622383013419*^9, 
   3.591622387309741*^9}, {3.591622455657555*^9, 3.591622621431069*^9}, {
   3.591622682261242*^9, 3.591622685208972*^9}, 3.591699776989443*^9, {
   3.591699982121814*^9, 3.591700054554751*^9}, {3.591700088699377*^9, 
   3.591700091232806*^9}, {3.591700203176058*^9, 3.591700228573786*^9}, {
   3.591700399823298*^9, 3.591700403770722*^9}, {3.5917015801664543`*^9, 
   3.5917015810883408`*^9}, {3.5917046396729317`*^9, 
   3.5917046448060827`*^9}, {3.5917052600197678`*^9, 3.591705260432527*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EqualityForCoeffs", "[", 
   RowBox[{"expr1_", "\[Equal]", "expr2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coeff1", ",", "coeff2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"coeff1", "=", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{"expr1", ",", "ExponentialNames"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeff2", "=", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{"expr2", ",", "ExponentialNames"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "/@", "coeff1"}], "\[Equal]", 
        RowBox[{"First", "/@", "coeff2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Equal", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "coeff1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "coeff2"}]}], 
          "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       "\"\<Error: incompatible coefficients.\>\""}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EqualityForCoeffs", "[", 
   RowBox[{
    RowBox[{"ASDF", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.591699926365559*^9, 3.5916999530936747`*^9}, {
   3.5917004069820538`*^9, 3.5917004451262493`*^9}, {3.591700491551997*^9, 
   3.5917005321882772`*^9}, {3.59170057993645*^9, 3.591700871065724*^9}, {
   3.591701304060718*^9, 3.5917013099988194`*^9}, 3.59170175211756*^9, 
   3.591703192056142*^9, {3.591705253297303*^9, 3.591705253569572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoeffToExpr", "[", "expr_", "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
       "moments2", ",", "moments4", ",", "moments6", ",", "moments8"}], "}"}],
       "]"}]}], ",", 
    RowBox[{"t", "\[Equal]", "r"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.591352537118391*^9, 3.591352568721796*^9}, {
  3.5915980114970713`*^9, 3.591598033540205*^9}, {3.5917033988075237`*^9, 
  3.591703427773744*^9}, {3.5917051310898867`*^9, 3.591705141451668*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"EqualityForCoeffs", "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ASDF", "/@", "moment8Indexes"}], "]"}]}], "]"}], "//", 
   "CoeffToExpr"}], "//", "Test"}]], "Input",
 CellChangeTimes->{{3.591701462729007*^9, 3.591701476199079*^9}, {
   3.59170152175513*^9, 3.591701549788356*^9}, {3.591701656653688*^9, 
   3.591701697843421*^9}, {3.5917017395955553`*^9, 3.591701815778655*^9}, 
   3.591705229242519*^9, {3.591705284329815*^9, 3.5917052870603333`*^9}, 
   3.593522365558012*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"EqualityForCoeffs", "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ASDF", "/@", "moment6Indexes"}], "]"}]}], "]"}], "//", 
   "CoeffToExpr"}], "//", "Test"}]], "Input",
 CellChangeTimes->{{3.591701851428494*^9, 3.591701851464739*^9}, 
   3.5917052328964157`*^9, {3.591705292436561*^9, 3.5917052936597*^9}, 
   3.593522379837512*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"EqualityForCoeffs", "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ASDF", "/@", "moment4Indexes"}], "]"}]}], "]"}], "//", 
   "CoeffToExpr"}], "//", "Test"}]], "Input",
 CellChangeTimes->{{3.591701851428494*^9, 3.591701861195651*^9}, 
   3.591705234590485*^9, {3.591705296587234*^9, 3.591705304381221*^9}, 
   3.5935223966024*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coeffSubs", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"EqualityForCoeffs", "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ASDF", "/@", "momentIndexes"}], "]"}]}], "]"}], "/.", 
   RowBox[{"Equal", "\[Rule]", "Rule"}]}]}]], "Input",
 CellChangeTimes->{{3.592458618463089*^9, 3.592458712940988*^9}, {
  3.593522336328053*^9, 3.593522340937796*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2c", "]"}], "\[Rule]", 
    SuperscriptBox[
     RowBox[{"coeff", "[", "EG2c", "]"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2cAD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2cAW", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2c", "]"}], "\[Rule]", 
    SuperscriptBox[
     RowBox[{"coeff", "[", "EG2c", "]"}], "3"]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G4c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cADAH", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAWAD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cADBH", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAWBD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAH", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAWAH", "]"}], "\[Rule]", 
    SuperscriptBox[
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAW", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2G2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAH", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2G2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2c", "]"}], "\[Rule]", 
    SuperscriptBox[
     RowBox[{"coeff", "[", "EG2G2c", "]"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAWAD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAWAD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAWBD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAWBD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAW", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2cAD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G2G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAH", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG2G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAD", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG2G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2cAW", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG2G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G2G2c", "]"}], "\[Rule]", 
    SuperscriptBox[
     RowBox[{"coeff", "[", "EG2c", "]"}], "4"]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G2G2cAH", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2G2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G2G2cAD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4G2cAD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G2G2cBD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4G2cBD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G2G2c", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G4G2cAH", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4G2cAD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G4G2cBH", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4G2cBD", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G4G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4G2c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G4G2cAW", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G4cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G4G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G4G2c", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG6G2c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG6c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G4cAD", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G4cAW", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G4c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG2G4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G4cAW", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2G2cAW", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G4c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2G2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G2G4c", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"coeff", "[", "EG2c", "]"}], "2"], " ", 
     RowBox[{"coeff", "[", "EG4c", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG4G4c", "]"}], "\[Rule]", 
    SuperscriptBox[
     RowBox[{"coeff", "[", "EG4c", "]"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"coeff", "[", "EG2G6c", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"coeff", "[", "EG2c", "]"}], " ", 
     RowBox[{"coeff", "[", "EG6c", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.596434796623893*^9, 3.596439710120385*^9, 
  3.5964410055323057`*^9, 3.596441147996131*^9, 3.596441181341227*^9, 
  3.596442958483596*^9, 3.596448843725664*^9, 3.596546885167006*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moments to C", "Subsection",
 CellChangeTimes->{{3.587191903824419*^9, 3.587191923193903*^9}, {
  3.594040848899064*^9, 3.5940408496772614`*^9}, {3.596347845589808*^9, 
  3.5963478464305573`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "WriteFile", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteFile", "[", 
   RowBox[{"path_String", ",", "lines__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "file", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"DirectoryName", "[", "path", "]"}], "]"}], "]"}], ",", 
       RowBox[{"CreateDirectory", "[", 
        RowBox[{"DirectoryName", "[", "path", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"file", "=", 
      RowBox[{"OpenWrite", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"WriteString", "[", 
          RowBox[{"file", ",", "#"}], "]"}], ";", 
         RowBox[{"Write", "[", "file", "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"FlattenCode", "[", "lines", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "file", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5958556600302553`*^9, 3.595855687662684*^9}, {
   3.595855864556869*^9, 3.595855960760343*^9}, {3.5958560035057297`*^9, 
   3.595856091013253*^9}, {3.595856147636898*^9, 3.595856162885561*^9}, {
   3.595919262306684*^9, 3.595919269387697*^9}, {3.5962872521778173`*^9, 
   3.596287253878433*^9}, 3.596288504519598*^9, {3.596434285961184*^9, 
   3.596434312511346*^9}, {3.596434348361785*^9, 3.5964343490183477`*^9}, {
   3.596434384443021*^9, 3.5964344176900682`*^9}, {3.596434497332902*^9, 
   3.5964345316938953`*^9}, 3.596440740325498*^9, {3.596441067850115*^9, 
   3.5964410761472883`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "WriteFile", "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteFile", "[", 
     RowBox[{"path_String", ",", 
      RowBox[{"lines", ":", 
       RowBox[{"{", 
        RowBox[{"_String", ".."}], "}"}]}]}], "]"}]}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "file", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"DirectoryQ", "[", 
            RowBox[{"DirectoryName", "[", "path", "]"}], "]"}], "]"}], ",", 
          RowBox[{"CreateDirectory", "[", 
           RowBox[{"DirectoryName", "[", "path", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"file", "=", 
         RowBox[{"OpenWrite", "[", "path", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"WriteString", "[", 
             RowBox[{"file", ",", "#"}], "]"}], ";", 
            RowBox[{"Write", "[", "file", "]"}]}], ")"}], "&"}], "/@", 
         "lines"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Close", "[", "file", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", 
     RowBox[{"WriteFile", "[", 
      RowBox[{"name_String", ",", "lines_List"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"WriteFile", "[", 
       RowBox[{"name", ",", 
        RowBox[{"FlattenCode", "[", "lines", "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"WriteFile", "[", 
       RowBox[{"name_String", ",", "lines__"}], "]"}]}], ":=", 
     RowBox[{"WriteFile", "[", 
      RowBox[{"name", ",", 
       RowBox[{"FlattenCode", "[", "lines", "]"}]}], "]"}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.596440939795814*^9, 3.596440997113125*^9}, {
  3.5964410811847677`*^9, 3.596441081895956*^9}, {3.5964411286244373`*^9, 
  3.596441132184692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"generatedCCodeDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<src\>\"", ",", 
      "\"\<generatedCode\>\""}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5958556600302553`*^9, 3.595855687662684*^9}, {
   3.595855864556869*^9, 3.595855960760343*^9}, {3.5958560035057297`*^9, 
   3.595856091013253*^9}, {3.595856147636898*^9, 3.595856162885561*^9}, {
   3.595919262306684*^9, 3.595919269387697*^9}, {3.5962872521778173`*^9, 
   3.596287253878433*^9}, 3.596288504519598*^9, 3.596434285961184*^9, {
   3.59643467946865*^9, 3.596434688188862*^9}, {3.596535248442671*^9, 
   3.596535249402231*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"generatedRCodeDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<R\>\"", ",", 
      "\"\<generatedCode\>\""}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.596434670203143*^9, 3.5964346894893837`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"WriteCFile", "[", 
    RowBox[{"name_String", ",", 
     RowBox[{"lines", ":", 
      RowBox[{"{", 
       RowBox[{"_String", ".."}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "file", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"DirectoryQ", "[", "generatedCodeDirectory", "]"}], "]"}], 
          ",", 
          RowBox[{"CreateDirectory", "[", "generatedCodeDirectory", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"file", "=", 
         RowBox[{"OpenWrite", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"generatedCodeDirectory", ",", "name"}], "}"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"WriteString", "[", 
           RowBox[{"file", ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{"lines", ",", "\"\<\\n\>\""}], "]"}], "]"}]}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"WriteString", "[", 
             RowBox[{"file", ",", "#"}], "]"}], ";", 
            RowBox[{"Write", "[", "file", "]"}]}], ")"}], "&"}], "/@", 
         "lines"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Close", "[", "file", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", 
     RowBox[{"WriteCFile", "[", 
      RowBox[{"name_String", ",", "lines_List"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"WriteCFile", "[", 
       RowBox[{"name", ",", 
        RowBox[{"FlattenCode", "[", "lines", "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"WriteCFile", "[", 
       RowBox[{"name_String", ",", "lines__"}], "]"}]}], ":=", 
     RowBox[{"WriteCFile", "[", 
      RowBox[{"name", ",", 
       RowBox[{"FlattenCode", "[", "lines", "]"}]}], "]"}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5958556600302553`*^9, 3.595855687662684*^9}, {
   3.595855864556869*^9, 3.595855960760343*^9}, {3.5958560035057297`*^9, 
   3.595856091013253*^9}, {3.595856147636898*^9, 3.595856162885561*^9}, {
   3.595919262306684*^9, 3.595919269387697*^9}, {3.5962872521778173`*^9, 
   3.596287253878433*^9}, 3.596288504519598*^9, 3.596434285961184*^9, {
   3.596440880953446*^9, 3.59644088452551*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteCFile", "[", 
   RowBox[{"fileName_String", ",", "lines__"}], "]"}], ":=", 
  RowBox[{"WriteFile", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"generatedCCodeDirectory", ",", "fileName"}], "}"}], "]"}], ",",
     "lines"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.59643453529784*^9, 3.596434541995247*^9}, {
   3.5964345732206783`*^9, 3.5964346468543777`*^9}, 3.596434695566018*^9, {
   3.596440899962672*^9, 3.596440900823778*^9}, {3.5964411094143467`*^9, 
   3.5964411172668962`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteRFile", "[", 
   RowBox[{"fileName_String", ",", "lines__"}], "]"}], ":=", 
  RowBox[{"WriteFile", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"generatedRCodeDirectory", ",", "fileName"}], "}"}], "]"}], ",",
     "lines"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.596434649334825*^9, 3.596434654526142*^9}, 
   3.5964346984298286`*^9, {3.596441111339945*^9, 3.59644111603725*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Characters", "[", "\"\<ABC\>\"", "]"}], "[", 
         RowBox[{"[", "#1", "]"}], "]"}], "<>", 
        RowBox[{
         RowBox[{"Characters", "[", "\"\<WDH\>\"", "]"}], "[", 
         RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "\[Rule]", 
      RowBox[{"psiexp", "[", 
       RowBox[{
        RowBox[{"3", 
         RowBox[{"MySym", "[", 
          RowBox[{"\"\<delta\>\"", ",", "#2"}], "]"}]}], "+", 
        RowBox[{"(", 
         RowBox[{"#1", "-", "1"}], ")"}]}], "]"}]}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}]], "Input",
 CellChangeTimes->{{3.591606372628261*^9, 3.591606384530109*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"AW", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"3", " ", "delta1"}], "]"}]}], ",", 
   RowBox[{"AD", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"3", " ", "delta2"}], "]"}]}], ",", 
   RowBox[{"AH", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"3", " ", "delta3"}], "]"}]}], ",", 
   RowBox[{"BW", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"1", "+", 
      RowBox[{"3", " ", "delta1"}]}], "]"}]}], ",", 
   RowBox[{"BD", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"1", "+", 
      RowBox[{"3", " ", "delta2"}]}], "]"}]}], ",", 
   RowBox[{"BH", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"1", "+", 
      RowBox[{"3", " ", "delta3"}]}], "]"}]}], ",", 
   RowBox[{"CW", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", "delta1"}]}], "]"}]}], ",", 
   RowBox[{"CD", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", "delta2"}]}], "]"}]}], ",", 
   RowBox[{"CH", "\[Rule]", 
    RowBox[{"psiexp", "[", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", "delta3"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.5964347967860203`*^9, 3.596439710200795*^9, 
  3.596441005724028*^9, 3.596441148152821*^9, 3.5964411814960413`*^9, 
  3.596442958643858*^9, 3.596448843866194*^9, 3.59654688534074*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteSwitchToFile", "[", 
   RowBox[{"resultName_String", ",", "assignments_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"WriteCase", ",", "out", ",", "lines", ",", "subs"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"subs", "=", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Characters", "[", "\"\<ABC\>\"", "]"}], "[", 
              RowBox[{"[", "#1", "]"}], "]"}], "<>", 
             RowBox[{
              RowBox[{"Characters", "[", "\"\<WDH\>\"", "]"}], "[", 
              RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "\[Rule]", 
           RowBox[{"psiexp", "[", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"MySym", "[", 
               RowBox[{"\"\<delta\>\"", ",", "#2"}], "]"}]}], "+", 
             RowBox[{"(", 
              RowBox[{"#1", "-", "1"}], ")"}]}], "]"}]}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteCase", "[", 
       RowBox[{
        RowBox[{"name_", "\[Rule]", "expr_"}], ",", "case_"}], "]"}], ":=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<case \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"case", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "]"}], "<>", 
         "\"\<: // \>\"", "<>", 
         RowBox[{"ToString", "[", "name", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"\"\<return \>\"", "<>", 
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"SimpleExprToC", "[", 
             RowBox[{"Map", "[", 
              RowBox[{"fff", ",", "expr", ",", 
               RowBox[{"{", 
                RowBox[{"-", "1"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             StyleBox[
              RowBox[{"Part", "::", "pspec"}], "MessageName"], "}"}]}], "]"}],
           "<>", "\"\<;\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\"\<return \>\"", "<>", 
         RowBox[{"SimpleExprToC", "[", 
          RowBox[{"expr", "//.", "subs"}], "]"}], "<>", "\"\<;\>\""}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{
       RowBox[{"MapIndexed", "[", 
        RowBox[{"WriteCase", ",", "assignments"}], "]"}], "//", "Flatten"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"WriteCFile", "[", 
      RowBox[{
       RowBox[{"resultName", "<>", "\"\<.part.c\>\""}], ",", "lines"}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.587205816325942*^9, 3.587205817541853*^9}, {
   3.587209668654622*^9, 3.587209714355802*^9}, {3.587209953173914*^9, 
   3.587209991058045*^9}, {3.587293857842525*^9, 3.587293890356207*^9}, {
   3.587293954020027*^9, 3.587293977792354*^9}, {3.587294112063767*^9, 
   3.587294125517706*^9}, {3.587294293505748*^9, 3.587294395456469*^9}, {
   3.587294440674563*^9, 3.587294478226041*^9}, {3.5872950019382067`*^9, 
   3.587295040074346*^9}, {3.587297969010254*^9, 3.587297970502282*^9}, {
   3.5872980208702583`*^9, 3.5872980365159483`*^9}, {3.5872980709509783`*^9, 
   3.587298074915394*^9}, {3.587298409026971*^9, 3.587298411297309*^9}, {
   3.587357918569993*^9, 3.587357929020527*^9}, {3.587358698966851*^9, 
   3.587358703104087*^9}, {3.58736446392631*^9, 3.587364511062999*^9}, {
   3.587364906430509*^9, 3.5873649661732807`*^9}, {3.587365112985705*^9, 
   3.5873651246500196`*^9}, {3.587365177320512*^9, 3.587365239438857*^9}, {
   3.5873652719306593`*^9, 3.5873653686454687`*^9}, {3.587365940108276*^9, 
   3.587365950544724*^9}, 3.587374684028038*^9, {3.587374831648485*^9, 
   3.587374840972041*^9}, {3.5873793781248426`*^9, 3.587379378511039*^9}, {
   3.58738111986001*^9, 3.58738114027386*^9}, {3.587381373015519*^9, 
   3.587381408794249*^9}, {3.587381448369336*^9, 3.5873815236352654`*^9}, {
   3.5879857399755163`*^9, 3.587985783101129*^9}, {3.58799000923038*^9, 
   3.5879900098735657`*^9}, {3.588399120721518*^9, 3.588399140123294*^9}, {
   3.588400149658334*^9, 3.588400153693829*^9}, {3.5884004847340403`*^9, 
   3.5884004924655743`*^9}, {3.5884005626514072`*^9, 3.588400589083839*^9}, {
   3.5884007644322977`*^9, 3.588400785868054*^9}, {3.588400817888144*^9, 
   3.588400833112115*^9}, {3.5884008637492228`*^9, 3.588400915040516*^9}, {
   3.5914175450516987`*^9, 3.5914175471470613`*^9}, {3.59142854878097*^9, 
   3.591428567057639*^9}, {3.591428983196074*^9, 3.591428988016461*^9}, 
   3.591501025239143*^9, {3.591519879508011*^9, 3.5915199077320023`*^9}, {
   3.596287398954*^9, 3.596287423659634*^9}, {3.5963507855174007`*^9, 
   3.596350786457493*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoeffParamListForExpr", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "paramList", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramList", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<const scalar r    = *hParam;\>\"", ",", "r"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar t    = *hParam;\>\"", ",", "t"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<const scalar beta = thetaParam[0];\>\"", ",", "\[Beta]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<const scalar eta  = thetaParam[1];\>\"", ",", "\[Eta]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<const scalar tau  = thetaParam[2];\>\"", ",", "\[Tau]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<const scalar phi  = thetaParam[3];\>\"", ",", "\[Phi]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar Psi1 = psiParam[0];\>\"", ",", 
           RowBox[{"\[CapitalPsi]", "[", "1", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar Psi2 = psiParam[1];\>\"", ",", 
           RowBox[{"\[CapitalPsi]", "[", "2", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar Psi3 = psiParam[2];\>\"", ",", 
           RowBox[{"\[CapitalPsi]", "[", "3", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar Psi4 = psiParam[3];\>\"", ",", 
           RowBox[{"\[CapitalPsi]", "[", "4", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar delta1 = *delta1Param;\>\"", ",", 
           RowBox[{"\[Delta]", "[", "1", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar delta2 = *delta2Param;\>\"", ",", 
           RowBox[{"\[Delta]", "[", "2", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<const scalar delta3 = *delta3Param;\>\"", ",", 
           RowBox[{"\[Delta]", "[", "3", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"First", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"paramList", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593772884305534*^9, 3.593772932658535*^9}, 
   3.593773015998925*^9, {3.5937850491803713`*^9, 3.593785098001932*^9}, {
   3.593843673435626*^9, 3.5938437082304897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientAsFunctionSym", "[", 
   RowBox[{"coeffName_Symbol", "|", 
    RowBox[{"coeff", "[", "coeffName_", "]"}]}], "]"}], ":=", 
  RowBox[{"MySym", "[", 
   RowBox[{"\"\<Compute\>\"", ",", "coeffName"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.59401961708219*^9, 3.59401962013839*^9}, {
  3.59401970470641*^9, 3.5940197398988333`*^9}, {3.594029433630209*^9, 
  3.5940294894264593`*^9}, {3.59403043592143*^9, 3.594030445762307*^9}, {
  3.59403053173048*^9, 3.594030536726369*^9}, {3.594030640039282*^9, 
  3.594030640640253*^9}, {3.596349943376513*^9, 3.5963499518272657`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientAsFunction", "[", 
   RowBox[{"c_coeff", "\[Rule]", "expr_"}], "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<scalar \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"CoefficientAsFunctionSym", "[", "c", "]"}], "]"}], "<>", 
      "\"\<(const scalar *hParam, const scalar thetaParam[], const scalar \
psiParam[])\>\""}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"WriteCBlock", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CoeffParamListForExpr", "[", "expr", "]"}], ",", 
      RowBox[{"\"\<return \>\"", "<>", 
       RowBox[{"SimpleExprToC", "[", 
        RowBox[{"expr", "/.", 
         RowBox[{"c0_coeff", "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"CoefficientAsFunctionSym", "[", "c0", "]"}], "[", 
           RowBox[{"hParam", ",", "thetaParam", ",", "psiParam"}], "]"}]}]}], 
        "]"}], "<>", "\"\<;\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoefficientAsFunction", "[", 
    RowBox[{"coeffList", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", "PrintCCode"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoefficientAsFunction", "[", 
    RowBox[{"coeffList", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], "//", "PrintCCode"}], "//", 
  "Test"}]}], "Input",
 CellChangeTimes->{
  3.593776765480044*^9, 3.5937768023734007`*^9, {3.593776849851808*^9, 
   3.593776962767314*^9}, {3.593777052194786*^9, 3.5937771154344053`*^9}, {
   3.593777192557996*^9, 3.593777193100864*^9}, {3.59377724888923*^9, 
   3.593777309050234*^9}, {3.5937773753499928`*^9, 3.593777426734601*^9}, 
   3.593777606038515*^9, {3.593779451535125*^9, 3.593779456180314*^9}, {
   3.59378345777702*^9, 3.593783459294652*^9}, {3.593843617902072*^9, 
   3.593843639286285*^9}, {3.593843711882968*^9, 3.593843725761902*^9}, 
   3.59384402944452*^9, {3.593846261436852*^9, 3.5938462700162*^9}, {
   3.594028976344159*^9, 3.5940289936135607`*^9}, {3.5940293527162313`*^9, 
   3.5940293935841293`*^9}, {3.594029500258243*^9, 3.594029516999159*^9}, {
   3.594029566511167*^9, 3.594029578451128*^9}, {3.5940301270436897`*^9, 
   3.594030170575019*^9}, {3.594030453910873*^9, 3.594030457770575*^9}, {
   3.5940305446502666`*^9, 3.5940305493534117`*^9}, {3.5940309068143473`*^9, 
   3.594030925367062*^9}, {3.5940310101569023`*^9, 3.594031033099744*^9}, {
   3.594031079636553*^9, 3.5940310818618917`*^9}, {3.594031161473352*^9, 
   3.594031198135941*^9}, {3.594040478142168*^9, 3.594040478154454*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientAsVariableSym", "[", 
   RowBox[{"coeffName_Symbol", "|", 
    RowBox[{"coeff", "[", "coeffName_", "]"}]}], "]"}], ":=", 
  RowBox[{"MySym", "[", 
   RowBox[{"\"\<v\>\"", ",", "coeffName"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.59401961708219*^9, 3.59401962013839*^9}, {
   3.59401970470641*^9, 3.5940197398988333`*^9}, {3.594029433630209*^9, 
   3.5940294894264593`*^9}, {3.59403032518723*^9, 3.5940303831243887`*^9}, 
   3.594031269442995*^9, {3.596349960842835*^9, 3.596349966031296*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientAsVariable", "[", 
   RowBox[{"c_coeff", "\[Rule]", "expr_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"\"\<const \>\"", "<>", 
   RowBox[{"AssignVarC", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CoefficientAsVariableSym", "[", "c", "]"}], "\[Rule]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"expr", ",", "coeff"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CoefficientAsFunctionSym", "[", "c", "]"}], "[", 
         RowBox[{"hParam", ",", "thetaParam", ",", "psiParam"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"expr", "/.", 
         RowBox[{"c0_coeff", "\[RuleDelayed]", 
          RowBox[{"CoefficientAsVariableSym", "[", "c0", "]"}]}]}]}], "]"}]}],
      ",", "Declaration"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientAsVariable", "[", 
   RowBox[{"coeffList", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientAsVariable", "[", 
   RowBox[{"coeffList", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.594028943399879*^9, 3.594028958879071*^9}, {
  3.594029182516673*^9, 3.594029203205888*^9}, {3.594029314488817*^9, 
  3.594029327556327*^9}, {3.594030297507268*^9, 3.5940302986022377`*^9}, {
  3.594030391796664*^9, 3.594030426625836*^9}, {3.594031280678033*^9, 
  3.594031341835133*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientAsArrayEntry", "[", 
   RowBox[{"c_coeff", "\[Rule]", "expr_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"AssignVarC", "[", 
   RowBox[{
    RowBox[{"c", "\[Rule]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"expr", ",", "coeff"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CoefficientAsFunctionSym", "[", "c", "]"}], "[", 
        RowBox[{"hParam", ",", "thetaParam", ",", "psiParam"}], "]"}], ",", 
       "\[IndentingNewLine]", "expr"}], "]"}]}], ",", "Assignment"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientAsArrayEntry", "[", 
   RowBox[{"coeffList", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientAsArrayEntry", "[", 
   RowBox[{"coeffList", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.594032851050995*^9, 3.5940328519043417`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MomentToC", "[", "indexes__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "momentExpr", ",", "args", ",", "argsC", ",", "functionHead", ",", 
      "functionBody", ",", "wrapperR"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momentExpr", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{"EGName", "[", 
           RowBox[{"{", "indexes", "}"}], "]"}], "]"}], "/.", 
         RowBox[{"Flatten", "[", "moments", "]"}]}], "/.", 
        "NamesToExponentials"}], "/.", 
       RowBox[{"c_coeff", "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"CoefficientAsFunctionSym", "[", "c", "]"}], "[", 
         RowBox[{"hParam", ",", "thetaParam", ",", "psiParam"}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"args", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "indexes", "}"}], "//", "EGArgs"}], "//", "Most"}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"\[Delta]", "[", "i_", "]"}], "\[RuleDelayed]", 
          RowBox[{"MySym", "[", 
           RowBox[{"\"\<delta\>\"", ",", "i"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"h", ",", "theta", ",", "psi"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"functionHead", "=", 
      RowBox[{"\"\<void \>\"", "<>", 
       RowBox[{"EGName", "[", 
        RowBox[{"{", "indexes", "}"}], "]"}], "<>", "\"\<(\>\"", "<>", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<const scalar *\>\"", "<>", 
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<Param, \>\""}], 
          "&"}], "/@", "args"}], "]"}], "<>", "\"\<scalar *result)\>\""}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"functionBody", "=", 
      RowBox[{"WriteCBlock", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CoeffParamListForExpr", "[", "momentExpr", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AssignVarC", "[", 
         RowBox[{"\"\<*result\>\"", ",", 
          RowBox[{"momentExpr", "/.", 
           RowBox[{
            RowBox[{"\[Delta]", "[", "i_", "]"}], "\[RuleDelayed]", 
            RowBox[{"MySym", "[", 
             RowBox[{"\"\<delta\>\"", ",", "i"}], "]"}]}]}], ",", 
          "Assignment"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"wrapperR", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"EGName", "[", 
          RowBox[{"{", "indexes", "}"}], "]"}], "<>", "\"\< <- function(\>\"",
          "<>", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"ToString", "/@", "args"}], ",", "\"\<, \>\""}], "]"}], 
          "]"}], "<>", "\"\<)\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<.C(\\\"\>\"", "<>", 
         RowBox[{"EGName", "[", 
          RowBox[{"{", "indexes", "}"}], "]"}], "<>", "\"\<\\\", \>\"", "<>", 
         
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MyStr", "[", 
             RowBox[{"\"\<as.double(\>\"", ",", "#", ",", "\"\<), \>\""}], 
             "]"}], "&"}], "/@", "args"}], "]"}], "<>", 
         "\"\<result=as.double(numeric(1)))$result\>\""}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"functionHead", "<>", "\"\<;\>\""}], ",", 
       RowBox[{"Prepend", "[", 
        RowBox[{"functionBody", ",", "functionHead"}], "]"}], ",", 
       "wrapperR"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MomentToC", "[", 
     RowBox[{"2", ",", "2", ",", "2"}], "]"}], "//", "Flatten"}], "//", 
   "PrintCCode"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.593504947233778*^9, 3.593505185397485*^9}, {
   3.5935052806221657`*^9, 3.593505430951539*^9}, {3.593505465088957*^9, 
   3.593505539419306*^9}, {3.593505571748131*^9, 3.593505593299501*^9}, {
   3.5935129513304033`*^9, 3.593512988000572*^9}, {3.5935132832525587`*^9, 
   3.593513321627507*^9}, {3.593514298988221*^9, 3.593514306693379*^9}, {
   3.593515100336833*^9, 3.593515127408078*^9}, {3.593515179456554*^9, 
   3.593515217382756*^9}, {3.593516027103849*^9, 3.593516064679161*^9}, {
   3.593516102243741*^9, 3.5935161721641903`*^9}, {3.593516337198699*^9, 
   3.593516621072125*^9}, {3.593516715510581*^9, 3.593516842637224*^9}, {
   3.593517675085766*^9, 3.593517790345022*^9}, {3.593517946786334*^9, 
   3.59351796469036*^9}, {3.593518082819512*^9, 3.593518203923236*^9}, {
   3.5935190521945763`*^9, 3.593519171837528*^9}, {3.59351928681439*^9, 
   3.593519295573367*^9}, {3.593519346290634*^9, 3.5935193553555737`*^9}, {
   3.593521743342058*^9, 3.593521819843156*^9}, {3.5935225492390537`*^9, 
   3.5935225494735107`*^9}, {3.593522696941687*^9, 3.59352272284475*^9}, {
   3.593522808335197*^9, 3.59352281382053*^9}, {3.593523695634101*^9, 
   3.593523702994134*^9}, {3.593526755242732*^9, 3.5935267574980583`*^9}, {
   3.593526899722334*^9, 3.5935269433895407`*^9}, 3.593782292694612*^9, {
   3.593782871725217*^9, 3.593782872530252*^9}, {3.593783173290753*^9, 
   3.5937831772462597`*^9}, {3.593783307282452*^9, 3.593783317547268*^9}, {
   3.593783348179956*^9, 3.59378337434264*^9}, {3.59378449035034*^9, 
   3.593784514567445*^9}, {3.593784566215229*^9, 3.5937846013178587`*^9}, {
   3.593784719278203*^9, 3.5937847197979603`*^9}, {3.593784814067561*^9, 
   3.5937848585763083`*^9}, {3.5937848998738537`*^9, 3.593784922665745*^9}, {
   3.593784967739979*^9, 3.5937849689146023`*^9}, {3.5937851542396793`*^9, 
   3.593785293694354*^9}, {3.593785335477076*^9, 3.5937853511146593`*^9}, 
   3.593785407799678*^9, {3.593785447133945*^9, 3.593785458786805*^9}, {
   3.593843845805787*^9, 3.5938438732969837`*^9}, {3.5938439292161083`*^9, 
   3.593843930321559*^9}, {3.5938452467309923`*^9, 3.593845255749229*^9}, {
   3.5938462847507353`*^9, 3.593846302659775*^9}, {3.5938473050994043`*^9, 
   3.5938473059554253`*^9}, {3.5938487222262*^9, 3.593848750415085*^9}, {
   3.593849271483502*^9, 3.593849293770754*^9}, {3.593849354140027*^9, 
   3.593849413570464*^9}, {3.5938494450790873`*^9, 3.593849446919765*^9}, {
   3.593849776734886*^9, 3.593850061755892*^9}, {3.593850168349015*^9, 
   3.593850205564619*^9}, {3.593850249379238*^9, 3.5938503464575357`*^9}, {
   3.593856792967121*^9, 3.593856806207282*^9}, {3.593857399999332*^9, 
   3.59385754943884*^9}, {3.593857596036944*^9, 3.593857630607463*^9}, {
   3.593857683710264*^9, 3.593857693157214*^9}, {3.593857794398781*^9, 
   3.593857794608366*^9}, {3.5938578349160633`*^9, 3.5938579149027843`*^9}, {
   3.593857969346259*^9, 3.593858093884272*^9}, {3.593858125986429*^9, 
   3.59385817527417*^9}, {3.5938584820147676`*^9, 3.5938585848754396`*^9}, {
   3.5938586438045397`*^9, 3.593858654761977*^9}, {3.5938586953315973`*^9, 
   3.5938587087897987`*^9}, {3.593858836739943*^9, 3.593858878216765*^9}, {
   3.594036260965767*^9, 3.5940362774506702`*^9}, {3.594038087724885*^9, 
   3.594038093853148*^9}, 3.594040478157669*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write coefficients to C files", "Subsection",
 CellChangeTimes->{{3.5963494967371683`*^9, 3.5963495029279833`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteSwitchToFile", "[", 
   RowBox[{"\"\<moments4cases\>\"", ",", 
    RowBox[{"First", "/@", "moments4"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteSwitchToFile", "[", 
   RowBox[{"\"\<moments6cases\>\"", ",", 
    RowBox[{"First", "/@", "moments6"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteSwitchToFile", "[", 
   RowBox[{"\"\<moments8cases\>\"", ",", 
    RowBox[{"First", "/@", "moments8"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteCoeffToCFile", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Rest", ",", 
      RowBox[{"{", 
       RowBox[{
       "moments2", ",", "moments4", ",", "moments6", ",", "moments8"}], "}"}],
       ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.587378157744711*^9, 3.587378334548864*^9}, {
   3.587378373011785*^9, 3.587378539327285*^9}, {3.587378610856662*^9, 
   3.587378611164824*^9}, {3.5873793119892073`*^9, 3.587379315887702*^9}, {
   3.587386317577545*^9, 3.587386341452633*^9}, {3.5879803927987003`*^9, 
   3.587980399051*^9}, {3.588398543545424*^9, 3.5883985719791327`*^9}, {
   3.5884001044102077`*^9, 3.588400107159749*^9}, {3.5884012571466722`*^9, 
   3.5884012701431847`*^9}, {3.591514335042698*^9, 3.591514367840239*^9}, {
   3.591520409080844*^9, 3.591520412701954*^9}, 3.59152055610002*^9, {
   3.591520689056229*^9, 3.5915206893611298`*^9}, {3.596287433929802*^9, 
   3.596287459499441*^9}, {3.5962884108256617`*^9, 3.5962884183498697`*^9}, {
   3.5963507278447*^9, 3.596350731233094*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffList", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coeffDefs", ",", "ReplaceCoeff"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplaceCoeff", "[", 
        RowBox[{"coeff_", "\[Rule]", "expr_"}], "]"}], ":=", 
       RowBox[{"coeff", "\[Rule]", 
        RowBox[{"Last", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"coeffSubs", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"coeff", "\[Rule]", "otherExpr_"}], ")"}], 
              "\[RuleDelayed]", "otherExpr"}]}], "]"}], ",", "expr"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coeffDefs", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", 
          RowBox[{"{", 
           RowBox[{
           "moments2", ",", "moments4", ",", "moments6", ",", "moments8"}], 
           "}"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplaceCoeff", "/@", "coeffDefs"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593526014012187*^9, 3.593526019361802*^9}, 
   3.593526807567019*^9, {3.593776529675749*^9, 3.5937765817679377`*^9}, {
   3.5937766508819733`*^9, 3.5937766559861183`*^9}, 3.5937773598510647`*^9}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "functions", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"functions", "=", 
     RowBox[{"CoefficientAsFunction", "/@", "coeffList"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteCFile", "[", 
     RowBox[{
     "\"\<coefficientFunctions.h\>\"", ",", "\[IndentingNewLine]", 
      "\"\<#include \\\"common.h\\\"\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<;\>\""}], "&"}], "/@", 
       "functions"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteCFile", "[", 
     RowBox[{
     "\"\<coefficientFunctions.c\>\"", ",", "\[IndentingNewLine]", 
      "\"\<#include \\\"common.h\\\"\>\"", ",", "\[IndentingNewLine]", 
      "\"\<#include \\\"common.c\\\"\>\"", ",", "\[IndentingNewLine]", 
      "functions"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5937776247285013`*^9, 3.593777683230297*^9}, 
   3.593777739136447*^9, {3.593777804706274*^9, 3.593777856974835*^9}, {
   3.593777928963909*^9, 3.59377794318242*^9}, {3.593782447930861*^9, 
   3.593782493888365*^9}, {3.59378264561471*^9, 3.593782680774592*^9}, {
   3.593783474450941*^9, 3.593783476733445*^9}, {3.593843734206827*^9, 
   3.593843797670309*^9}, 3.593844334733842*^9, {3.5940302516192827`*^9, 
   3.594030266662627*^9}, {3.5940312302808743`*^9, 3.5940312500702477`*^9}, {
   3.59628727633919*^9, 3.596287286490163*^9}, {3.596291371304255*^9, 
   3.596291373189783*^9}}],

Cell[BoxData[
 RowBox[{"WriteCFile", "[", 
  RowBox[{"\"\<coefficientsAsVariables.part.c\>\"", ",", 
   RowBox[{"CoefficientAsVariable", "/@", "coeffList"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.594029058419592*^9, 3.594029060414341*^9}, {
   3.594029115969293*^9, 3.5940291667462063`*^9}, 3.594029340952169*^9, {
   3.59403141646481*^9, 3.594031418851807*^9}, 3.596287305237246*^9}],

Cell[BoxData[{
 RowBox[{"WriteCFile", "[", 
  RowBox[{
  "\"\<coefficientsAsArray.h\>\"", ",", "\[IndentingNewLine]", 
   "\"\<#include \\\"coefficientFunctions.h\\\"\>\"", ",", 
   "\[IndentingNewLine]", "\"\<enum\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"WriteCBlock", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SymbolName", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "<>", "\"\<,\>\""}], 
       "&"}], "/@", "coeffList"}], ",", "\"\<COEFF_COUNT\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", "\"\<;\>\""}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteCFile", "[", 
  RowBox[{
  "\"\<coefficientsAsArray.part.c\>\"", ",", "\[IndentingNewLine]", 
   "\"\<scalar *coeff=(scalar*)malloc(sizeof(scalar)*COEFF_COUNT);\>\"", ",", 
   "\[IndentingNewLine]", "\"\<assert(coeff!=NULL);\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"CoefficientAsArrayEntry", "/@", "coeffList"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.58737909327115*^9, 3.58737930088196*^9}, {
   3.5883984586009293`*^9, 3.588398506807761*^9}, {3.5884010061233253`*^9, 
   3.588401006288681*^9}, 3.594032756589778*^9, {3.594033263836094*^9, 
   3.594033423956306*^9}, {3.5940340624087687`*^9, 3.5940340637957973`*^9}, {
   3.594034124481414*^9, 3.5940341805942497`*^9}, {3.5940355908088303`*^9, 
   3.5940355924882927`*^9}, {3.594036485994254*^9, 3.594036507875737*^9}, {
   3.59403666446139*^9, 3.594036759073803*^9}, {3.5962873094142447`*^9, 
   3.5962873114085617`*^9}, {3.596291264829095*^9, 3.5962912933538437`*^9}, {
   3.596350561206684*^9, 3.596350565126575*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "standaloneMoments", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"standaloneMoments", "=", 
     RowBox[{"MomentToC", "@@@", "momentIndexes"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteCFile", "[", 
     RowBox[{
     "\"\<standaloneMoments.h\>\"", ",", "\[IndentingNewLine]", 
      "\"\<#include \\\"common.h\\\"\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "standaloneMoments"}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"WriteCFile", "[", 
     RowBox[{
     "\"\<standaloneMoments.c\>\"", ",", "\[IndentingNewLine]", 
      "\"\<#include \\\"common.c\\\"\>\"", ",", "\[IndentingNewLine]", 
      "\"\<#include \\\"coefficientFunctions.h\\\"\>\"", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "standaloneMoments"}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"WriteRFile", "[", 
     RowBox[{"\"\<standaloneMoments.R\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "standaloneMoments"}]}],
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.5937776247285013`*^9, 3.593777683230297*^9}, 
   3.593777739136447*^9, {3.593777804706274*^9, 3.593777856974835*^9}, {
   3.593777928963909*^9, 3.59377794318242*^9}, {3.593782447930861*^9, 
   3.593782493888365*^9}, {3.593782526959236*^9, 3.593782605399363*^9}, {
   3.5937828820807943`*^9, 3.593782903389351*^9}, {3.593783266565626*^9, 
   3.593783267353506*^9}, {3.593785503675539*^9, 3.593785514121928*^9}, {
   3.5938439002912493`*^9, 3.59384390172208*^9}, {3.593847315719533*^9, 
   3.593847316120736*^9}, {3.593848495593313*^9, 3.5938485514459343`*^9}, {
   3.593858617884582*^9, 3.593858631056106*^9}, {3.5938587418123493`*^9, 
   3.59385876543822*^9}, {3.593858948843225*^9, 3.593858952974492*^9}, 
   3.594038164999382*^9, {3.596287313729704*^9, 3.596287316092621*^9}, {
   3.596350059294629*^9, 3.596350062472272*^9}, {3.5964411578424253`*^9, 
   3.596441158151518*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cases", "Section",
 CellChangeTimes->{{3.587961765451872*^9, 3.5879617662284803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"6", "\[LessEqual]", "q"}], "\[And]", 
    RowBox[{
     RowBox[{"q", "+", "2"}], "\[LessEqual]", "n"}], "\[And]", 
    RowBox[{"8", "\[LessEqual]", "n"}], "\[And]", 
    RowBox[{"1", "\[LessEqual]", "j", "\[LessEqual]", "q"}], "\[And]", 
    RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "q"}], "\[And]", 
    RowBox[{"0", "\[LessEqual]", "\[Nu]", "\[LessEqual]", "q"}], "\[And]", 
    RowBox[{"0", "\[LessEqual]", "\[Kappa]", "\[LessEqual]", "q"}], "\[And]", 
    
    RowBox[{"1", "\[LessEqual]", "i", "\[LessEqual]", 
     RowBox[{"n", "-", "q", "-", "1"}]}], "\[And]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", "q", ",", "j", ",", "k", ",", "\[Nu]", ",", "\[Kappa]", ",", 
       "i"}], "}"}], "\[Element]", "Integers"}], "\[And]", "$Assumptions"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.589103395881548*^9, 3.589103419675901*^9}, {
   3.589103535088934*^9, 3.589103593984045*^9}, 3.589200442064685*^9, {
   3.589201453689884*^9, 3.5892014649995537`*^9}, {3.589700503229292*^9, 
   3.5897005144790497`*^9}, {3.589700553186789*^9, 3.589700571205401*^9}, {
   3.5897147369040117`*^9, 3.5897147439866753`*^9}, {3.5897161339790907`*^9, 
   3.5897161491792183`*^9}, {3.59031901059597*^9, 3.5903190514910727`*^9}, {
   3.5921923520076227`*^9, 3.59219236691704*^9}, {3.592192475070456*^9, 
   3.592192495134301*^9}}],

Cell[CellGroupData[{

Cell["Generate Raw Cases", "Subsection",
 CellChangeTimes->{{3.583553133649728*^9, 3.583553136406356*^9}, {
  3.587962901766533*^9, 3.5879629046935797`*^9}, {3.587962966548365*^9, 
  3.587962967947907*^9}}],

Cell["\<\
Extends a sorted time list with an element in all the possible ways. 
Return a list of couples of extended lists and conditions.\
\>", "Text",
 CellChangeTimes->{{3.583553064957448*^9, 3.58355311289895*^9}, {
  3.583553149730476*^9, 3.583553157629147*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InsertElement", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "e_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "e", "}"}], "}"}], ",", "True"}], "}"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InsertElement", "[", 
   RowBox[{"sorted_", ",", "e_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Assert", "[", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"sorted", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "__", "}"}], ".."}], "}"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"before", " ", "the", " ", "first", " ", "element"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"sorted", ",", 
            RowBox[{"{", "e", "}"}]}], "]"}], ",", 
          RowBox[{"e", "<", 
           RowBox[{"sorted", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"between", " ", "two", " ", "elements"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Insert", "[", 
            RowBox[{"sorted", ",", 
             RowBox[{"{", "e", "}"}], ",", 
             RowBox[{"#", "+", "1"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"sorted", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "1"}], "]"}], "]"}], "<", "e", "<", 
            RowBox[{"sorted", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "+", "1"}], ",", "1"}], "]"}], "]"}]}]}], "}"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Length", "[", "sorted", "]"}], "-", "1"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"after", " ", "the", " ", "last", " ", "element"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"sorted", ",", 
            RowBox[{"{", "e", "}"}]}], "]"}], ",", 
          RowBox[{"e", ">", 
           RowBox[{"sorted", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}]}], "}"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"equal", " ", "to", " ", "an", " ", "element"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Insert", "[", 
            RowBox[{"sorted", ",", "e", ",", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"e", "\[Equal]", 
            RowBox[{"sorted", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "1"}], "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "sorted", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InsertElement", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "a"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InsertElement", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "a", "}"}], "}"}], ",", "b"}], "]"}], "//", "MatrixForm"}],
   "//", "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InsertElement", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}], ",", "e"}], "]"}], "//", 
   "MatrixForm"}], "//", "Test"}]}], "Input",
 CellChangeTimes->{{3.583551665667837*^9, 3.583551724583156*^9}, {
   3.583551796891143*^9, 3.5835518121108418`*^9}, {3.5835518743069553`*^9, 
   3.5835518996227207`*^9}, {3.583551953374366*^9, 3.5835520464339943`*^9}, {
   3.5835522687336206`*^9, 3.583552415851017*^9}, {3.583552468220812*^9, 
   3.5835524868431187`*^9}, {3.583552606456658*^9, 3.583552639955019*^9}, {
   3.583552719543953*^9, 3.583552766115212*^9}, {3.583552844530064*^9, 
   3.5835528741332693`*^9}, {3.5835529388099613`*^9, 3.583552940284339*^9}, {
   3.583553454301455*^9, 3.583553456154118*^9}, {3.5835789196163483`*^9, 
   3.583578934747385*^9}, {3.5835790144748297`*^9, 3.583579056541236*^9}, 
   3.583644705528585*^9, {3.58960667234658*^9, 3.5896066726412077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MappableInsertElement", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sortedList_", ",", "condition_"}], "}"}], ",", "e_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"MapAt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[And]", "condition"}], "&"}], ",", "#", ",", "2"}], 
     "]"}], "&"}], "/@", 
   RowBox[{"InsertElement", "[", 
    RowBox[{"sortedList", ",", "e"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.583553743794036*^9, 3.583553801708894*^9}, {
   3.583554031227293*^9, 3.583554123951462*^9}, {3.583554461502411*^9, 
   3.583554484209094*^9}, {3.583554675116666*^9, 3.583554684032736*^9}, {
   3.583578002360734*^9, 3.58357806592032*^9}, 3.5835785799028*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FoldableInsertElement", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "e_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"InsertElement", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "e"}], "]"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FoldableInsertElement", "[", 
   RowBox[{"list_", ",", "e_"}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"MappableInsertElement", "[", 
       RowBox[{"#", ",", "e"}], "]"}], "&"}], "/@", "list"}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.583553440770297*^9, 3.583553448552846*^9}, {
  3.583553561903842*^9, 3.58355356971276*^9}, {3.583553626277611*^9, 
  3.583553627217805*^9}, {3.5835536776163197`*^9, 3.583553686794228*^9}, {
  3.5835546171124907`*^9, 3.5835546228727083`*^9}, {3.583554665318697*^9, 
  3.583554687812838*^9}, {3.583577870033176*^9, 3.5835778900121927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InsertElements", "[", 
   RowBox[{"sortedList_", ",", "elements_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Assert", "[", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"sortedList", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "__", "}"}], "..."}], "}"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{"FoldableInsertElement", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"sortedList", ",", "True"}], "}"}], "}"}], ",", "elements"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.58355327072043*^9, 3.583553387445368*^9}, {
   3.5835534796433277`*^9, 3.583553487037654*^9}, {3.583553713327664*^9, 
   3.5835537135137672`*^9}, {3.583554636484888*^9, 3.583554636568637*^9}, {
   3.583554703548332*^9, 3.583554749071851*^9}, {3.583554795855874*^9, 
   3.583554848796596*^9}, {3.583555201754163*^9, 3.583555234430293*^9}, {
   3.58355547605306*^9, 3.5835554845401897`*^9}, 3.583555878817494*^9, {
   3.583556162686995*^9, 3.583556165444886*^9}, {3.583576021597292*^9, 
   3.583576050811801*^9}, {3.583578645894792*^9, 3.583578670693462*^9}, {
   3.583578724833129*^9, 3.5835787344854517`*^9}, {3.583578793688821*^9, 
   3.583578799219005*^9}, {3.583578847819419*^9, 3.583578880446712*^9}, {
   3.583579087072619*^9, 3.583579087412908*^9}, 3.583644705532012*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InsertElements", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}]}], "]"}], "//", "MatrixForm"}], "//", 
  "Test"}]], "Input",
 CellChangeTimes->{{3.583577749501732*^9, 3.583577770350263*^9}, {
  3.5835787376076508`*^9, 3.5835787399203587`*^9}, {3.583578893365575*^9, 
  3.58357889569282*^9}, {3.589606638409196*^9, 3.589606639682078*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InsertElements", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "//", "MatrixForm"}],
   "//", "Test"}]], "Input",
 CellChangeTimes->{{3.5835560433440533`*^9, 3.583556084106535*^9}, {
  3.583556368207588*^9, 3.583556399578782*^9}, {3.583576056318091*^9, 
  3.58357605825526*^9}, {3.583578968001089*^9, 3.583578969651781*^9}, {
  3.589606644052761*^9, 3.589606645284671*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"InsertElements", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Range", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "7"}], "}"}]}], "]"}]}], "//", 
  "Test"}]], "Input",
 CellChangeTimes->{{3.583556402005981*^9, 3.583556478211339*^9}, {
  3.58357607490215*^9, 3.5835760750980463`*^9}, {3.591417169448243*^9, 
  3.591417171725519*^9}, {3.594105335526441*^9, 3.5941053364699373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MapAt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Reduce", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "c", "}"}], ",", "Reals"}], "]"}], "&"}], ",", "#", 
       ",", "2"}], "]"}], "&"}], "/@", 
    RowBox[{"InsertElements", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "-", "a"}], ",", 
        RowBox[{"c", "-", "b"}]}], "}"}]}], "]"}]}], "//", "MatrixForm"}], "//",
   "Test"}]], "Input",
 CellChangeTimes->{{3.5835799494526052`*^9, 3.5835799639579153`*^9}, {
  3.5835799995223494`*^9, 3.583580084119618*^9}, {3.583580167101924*^9, 
  3.583580197201743*^9}, {3.587963009597843*^9, 3.587963015903635*^9}, {
  3.594105330354164*^9, 3.5941053314269657`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Range Restriction", "Subsection",
 CellChangeTimes->{{3.5835563131591454`*^9, 3.5835563218036327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RestrictVariable", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"var_", ",", "from_", ",", "to_"}], "}"}], ",", "restriction_", 
    ",", "assumptions_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InequalityToRange", ",", "newFrom", ",", "newTo", ",", "bestFrom", ",", 
      "bestTo"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"InequalityToRange", "[", "True", "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Equal", "[", 
        RowBox[{"var", ",", "value_"}], "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"value", ",", "value"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"Less", "[", 
         RowBox[{"var", ",", "upper_"}], "]"}], "|", 
        RowBox[{"Greater", "[", 
         RowBox[{"upper_", ",", "var"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Infinity"}], ",", 
        RowBox[{"upper", "-", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"LessEqual", "[", 
         RowBox[{"var", ",", "upper_"}], "]"}], "|", 
        RowBox[{"GreaterEqual", "[", 
         RowBox[{"upper_", ",", "var"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Infinity"}], ",", "upper"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"Less", "[", 
         RowBox[{"lower_", ",", "var"}], "]"}], "|", 
        RowBox[{"Greater", "[", 
         RowBox[{"var", ",", "lower_"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lower", "+", "1"}], ",", "Infinity"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"LessEqual", "[", 
         RowBox[{"lower_", ",", "var"}], "]"}], "|", 
        RowBox[{"GreaterEqual", "[", 
         RowBox[{"var", ",", "lower_"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"lower", ",", "Infinity"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{"var", ",", "Equal", ",", "value_"}], "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"value", ",", "value"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "Less", ",", "var", ",", "Less", ",", "upper_"}], 
        "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lower", "+", "1"}], ",", 
        RowBox[{"upper", "-", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "LessEqual", ",", "var", ",", "Less", ",", "upper_"}], 
        "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"lower", ",", 
        RowBox[{"upper", "-", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "Less", ",", "var", ",", "LessEqual", ",", "upper_"}], 
        "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lower", "+", "1"}], ",", "upper"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "LessEqual", ",", "var", ",", "LessEqual", ",", 
         "upper_"}], "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"lower", ",", "upper"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"conditions", ":", "_And"}], "]"}], ":=", 
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"conditions", ",", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", "x_", "]"}], ":=", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Var \>\"", ",", "var", ",", "\"\< cond \>\"", ",", "x"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newFrom", ",", "newTo"}], "}"}], "=", 
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Reduce", "[", 
        RowBox[{"restriction", ",", 
         RowBox[{"{", "var", "}"}], ",", "Reals"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bestFrom", ",", "bestTo"}], "}"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"newFrom", ",", "from"}], "]"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{"to", ",", "newTo"}], "]"}]}], "}"}], ",", 
        RowBox[{"Assumptions", "\[RuleDelayed]", "assumptions"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"var", ",", "bestFrom", ",", "bestTo"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5835811178165293`*^9, 3.583581143718897*^9}, {
   3.583584790846408*^9, 3.5835848056855307`*^9}, 3.5836447055472193`*^9, {
   3.5836489575065327`*^9, 3.583648967712529*^9}, {3.583649352465701*^9, 
   3.583649357309456*^9}, {3.5836704898414707`*^9, 3.58367049581266*^9}, {
   3.583675207409265*^9, 3.583675208430698*^9}, 3.588396897552434*^9, {
   3.589700677770245*^9, 3.589700688362277*^9}, {3.589700866727063*^9, 
   3.58970087319562*^9}, {3.5897011784343576`*^9, 3.58970118730429*^9}, {
   3.5897013023645277`*^9, 3.589701305143077*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OrList", "[", "formula_Or", "]"}], ":=", 
  RowBox[{"List", "@@", "formula"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrList", "[", "formula_", "]"}], ":=", 
  RowBox[{"{", "formula", "}"}]}]}], "Input",
 CellChangeTimes->{{3.583668461507921*^9, 3.58366851911672*^9}, 
   3.58840197292105*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AndList", "[", "formula_And", "]"}], ":=", 
  RowBox[{"List", "@@", "formula"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AndList", "[", "formula_", "]"}], ":=", 
  RowBox[{"{", "formula", "}"}]}]}], "Input",
 CellChangeTimes->{{3.583668461507921*^9, 3.5836685373870792`*^9}, 
   3.588401975022862*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckDisjointness", "[", "cases_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"Reduce", "[", 
         RowBox[{
          RowBox[{"And", "@@", "#"}], ",", 
          RowBox[{"{", "}"}], ",", "Integers"}], "]"}]}], "}"}], "&"}], "/@", 
     
     RowBox[{"Permutations", "[", 
      RowBox[{"cases", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=!=", "False"}], "&"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.583675799277657*^9, 3.583675816596858*^9}, {
  3.583748303409656*^9, 3.583748308097563*^9}, {3.583748420864066*^9, 
  3.583748427877768*^9}, {3.583748516595416*^9, 3.58374851824277*^9}, {
  3.583748627984741*^9, 3.58374878143848*^9}, {3.5837488312942877`*^9, 
  3.58374883211348*^9}, {3.58375118856715*^9, 3.583751198462009*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FreeFromQ", "[", 
   RowBox[{"expr_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"FreeQ", "[", 
   RowBox[{"expr", ",", 
    RowBox[{"Alternatives", "@@", "vars"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.583564844937448*^9, 3.583564871043642*^9}, {
  3.583564927318347*^9, 3.583564938565069*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RestrictVariables", "[", 
   RowBox[{"variables_", ",", "restrictions_", ",", "assumptions_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cases", ",", "disjointCases", ",", "FindIndex", ",", "AddCondition", 
      ",", "ff", ",", "disjointness"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cases", "=", 
      RowBox[{"OrList", "[", 
       RowBox[{"LogicalExpand", "[", 
        RowBox[{"Reduce", "[", 
         RowBox[{"restrictions", ",", 
          RowBox[{"First", "/@", "variables"}], ",", "Reals"}], "]"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"disjointness", "=", 
      RowBox[{"CheckDisjointness", "[", "cases", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"disjointCases", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"disjointness", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Non disjoint cases: \>\"", ",", "disjointness"}], 
          "]"}], ";", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Reduce", "[", 
             RowBox[{
              RowBox[{"#1", "\[And]", 
               RowBox[{"\[Not]", 
                RowBox[{"(", 
                 RowBox[{"Or", "@@", 
                  RowBox[{"Take", "[", 
                   RowBox[{"cases", ",", 
                    RowBox[{"#2", "-", "1"}]}], "]"}]}], ")"}]}]}], ",", 
              RowBox[{"First", "/@", "variables"}], ",", "Reals"}], "]"}], 
            "&"}], ",", "cases"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "cases"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FindIndex", "[", "condition_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "variables", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Not", "[", 
              RowBox[{"FreeFromQ", "[", 
               RowBox[{"condition", ",", 
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", "variables"}], ",", 
                  RowBox[{"-", "#"}]}], "]"}]}], "]"}], "]"}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"First", "[", "a", "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AddCondition", "[", 
       RowBox[{"conditionList_", ",", "True"}], "]"}], ":=", 
      "conditionList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AddCondition", "[", 
       RowBox[{"conditionList_", ",", "condition_"}], "]"}], ":=", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[And]", "condition"}], "&"}], ",", "conditionList", 
        ",", 
        RowBox[{"FindIndex", "[", "condition", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ff", "[", "condition_", "]"}], ":=", 
      RowBox[{"Fold", "[", 
       RowBox[{"AddCondition", ",", 
        RowBox[{
         RowBox[{"True", "&"}], "/@", "variables"}], ",", "condition"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RestrictVariable", "[", 
           RowBox[{"#1", ",", "#2", ",", "assumptions"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"variables", ",", 
           RowBox[{"ff", "[", 
            RowBox[{"AndList", "[", "#", "]"}], "]"}]}], "}"}]}], "]"}], 
       "&"}], "/@", "cases"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5836446446619377`*^9, 3.583644673567235*^9}, 
   3.583644705555285*^9, {3.5836452213694353`*^9, 3.583645230027803*^9}, {
   3.5836455523251*^9, 3.583645560283185*^9}, {3.583646978485379*^9, 
   3.5836470441443253`*^9}, {3.58364716214084*^9, 3.583647185148582*^9}, {
   3.583647216585754*^9, 3.5836473358601418`*^9}, {3.5836474543542967`*^9, 
   3.583647456956017*^9}, {3.583647495730134*^9, 3.583647617364272*^9}, 
   3.583647661088532*^9, {3.583647692493802*^9, 3.583647741798853*^9}, {
   3.583647859449625*^9, 3.583647935905892*^9}, {3.583648710026723*^9, 
   3.583648714344797*^9}, {3.583649996716239*^9, 3.583649997941421*^9}, {
   3.583663733675763*^9, 3.583663852154324*^9}, {3.58366389049496*^9, 
   3.5836639575940037`*^9}, {3.5836643931073112`*^9, 3.583664468002783*^9}, {
   3.583664563126719*^9, 3.58366456911593*^9}, {3.583664641244843*^9, 
   3.5836648363527403`*^9}, {3.583665484744028*^9, 3.583665486408791*^9}, {
   3.583665557109825*^9, 3.583665625733178*^9}, {3.5836665687714853`*^9, 
   3.583666638731256*^9}, {3.5836666843104553`*^9, 3.583666734578333*^9}, {
   3.583666787978092*^9, 3.583666803096407*^9}, {3.583666952340432*^9, 
   3.583666980122864*^9}, {3.58366855644106*^9, 3.583668628143606*^9}, {
   3.5836687206584187`*^9, 3.583668729839519*^9}, {3.583668766534688*^9, 
   3.583668855205319*^9}, {3.5836689008511257`*^9, 3.5836689262143908`*^9}, {
   3.583669287503819*^9, 3.5836692920546293`*^9}, {3.583669369347295*^9, 
   3.583669387168468*^9}, {3.5836695121544743`*^9, 3.583669521782387*^9}, {
   3.5836695843756247`*^9, 3.583669590555729*^9}, {3.583674487819498*^9, 
   3.583674514176515*^9}, {3.583674573970443*^9, 3.583674580679831*^9}, {
   3.583674615827458*^9, 3.583674678092593*^9}, {3.583674747562326*^9, 
   3.583674801272292*^9}, 3.583748792451912*^9, {3.5837488735826893`*^9, 
   3.583749010771625*^9}, {3.588396871409881*^9, 3.588396898754623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RangeToCondition", "[", 
   RowBox[{"{", 
    RowBox[{"var_", ",", "from_", ",", "to_"}], "}"}], "]"}], ":=", 
  RowBox[{"from", "\[LessEqual]", "var", "\[LessEqual]", "to"}]}]], "Input",
 CellChangeTimes->{{3.583046819805818*^9, 3.5830468383155403`*^9}, 
   3.583046868760591*^9, {3.5835650945436993`*^9, 3.58356510762389*^9}, {
   3.5835655745649233`*^9, 3.58356562594414*^9}, 3.587961828792741*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GenerateCasesRec", "[", 
   RowBox[{"restrictedVariables_", ",", 
    RowBox[{"{", "}"}], ",", "sortedList_", ",", "unsortedElements_", ",", 
    "assumptions_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Assert", "[", 
      RowBox[{"unsortedElements", "\[Equal]", 
       RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"restrictedVariables", ",", "sortedList"}], "}"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateCasesRec", "[", 
   RowBox[{
   "restrictedVariables_", ",", "unrestrictedVariables_", ",", 
    "partialSortedList_", ",", "unsortedElements_", ",", "assumptions_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "currentVariable", ",", "newUnrestrictedVariables", ",", 
      "newUnsortedElements", ",", "previousConditions", ",", 
      "currentElements", ",", "tentativeCases", ",", "possibleCases", ",", 
      "casesWithRanges", ",", "ff"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Assert", "[", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"restrictedVariables", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], "..."}], "}"}]}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"unrestrictedVariables", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"partialSortedList", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "__", "}"}], "..."}], "}"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"unsortedElements", ",", "_List"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"currentVariable", "=", 
      RowBox[{"First", "[", "unrestrictedVariables", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"\"\<Current variable: \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"currentVariable", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newUnrestrictedVariables", "=", 
      RowBox[{"Rest", "[", "unrestrictedVariables", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"currentElements", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"unsortedElements", ",", 
        RowBox[{
         RowBox[{"FreeFromQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"First", "/@", "newUnrestrictedVariables"}]}], "]"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newUnsortedElements", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"unsortedElements", ",", "currentElements"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"previousConditions", "=", 
      RowBox[{"assumptions", "\[And]", 
       RowBox[{"RangeToCondition", "[", "currentVariable", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"\"\<Inserting elements: \>\"", "<>", 
       RowBox[{"ToString", "[", "currentElements", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tentativeCases", "=", 
      RowBox[{"InsertElements", "[", 
       RowBox[{"partialSortedList", ",", "currentElements"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"\"\<Tentative insertions: \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "tentativeCases", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"possibleCases", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tentativeCases", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Reduce", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[And]", 
              "previousConditions"}], ",", 
             RowBox[{"{", "}"}], ",", "Integers"}], "]"}], "=!=", "False"}], 
          "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"\"\<Possible insertions: \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "possibleCases", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ff", "[", 
       RowBox[{"{", 
        RowBox[{"sortedList_", ",", "condition_"}], "}"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "newRestrictedVariable", ",", "newRestrictedVariables", ",", 
          "newAssumptions"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newRestrictedVariables", "=", 
          RowBox[{"RestrictVariables", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"restrictedVariables", ",", "currentVariable"}], "]"}], 
            ",", "condition", ",", "assumptions"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newAssumptions", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"assumptions", "\[And]", 
             RowBox[{"RangeToCondition", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}]}], "&"}], "/@", 
           "newRestrictedVariables"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"GenerateCasesRec", "[", 
             RowBox[{
             "#1", ",", "newUnrestrictedVariables", ",", "sortedList", ",", 
              "newUnsortedElements", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"newRestrictedVariables", ",", "newAssumptions"}], 
            "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"ff", "/@", "possibleCases"}], ",", "2"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.583557539768074*^9, 3.583557762465724*^9}, {
   3.58355782104672*^9, 3.5835578565233583`*^9}, {3.583558027412915*^9, 
   3.58355803716234*^9}, {3.5835629176683283`*^9, 3.5835629683853703`*^9}, {
   3.583563980939489*^9, 3.583564001966956*^9}, {3.583564056718583*^9, 
   3.58356409756966*^9}, {3.5835643733652*^9, 3.583564405256228*^9}, {
   3.583564554124687*^9, 3.583564644134193*^9}, {3.583564682474427*^9, 
   3.583564727057745*^9}, {3.583564771597574*^9, 3.5835648270296926`*^9}, {
   3.583564943477764*^9, 3.583565045732439*^9}, {3.583565126920644*^9, 
   3.583565158922567*^9}, {3.583565257902947*^9, 3.5835653113276863`*^9}, {
   3.5835653497359543`*^9, 3.583565534365399*^9}, {3.583565636191558*^9, 
   3.583565698338326*^9}, {3.583565742059122*^9, 3.583565748965234*^9}, {
   3.58356607665364*^9, 3.583566079620064*^9}, {3.583566166548798*^9, 
   3.5835661690747538`*^9}, {3.583567044700079*^9, 3.583567082849334*^9}, {
   3.58356712117845*^9, 3.583567151524308*^9}, 3.583571152188492*^9, {
   3.583572924103853*^9, 3.583572937055072*^9}, {3.5835732685119467`*^9, 
   3.5835732687069397`*^9}, {3.583573443498252*^9, 3.583573710173971*^9}, {
   3.583573764662854*^9, 3.583573810232126*^9}, {3.583573843339868*^9, 
   3.5835738736650553`*^9}, {3.583574200870504*^9, 3.583574252316443*^9}, {
   3.583575541521962*^9, 3.583575593042808*^9}, {3.583575651244084*^9, 
   3.58357579383456*^9}, {3.583575850559669*^9, 3.5835758784279823`*^9}, {
   3.583575917882612*^9, 3.5835759555772057`*^9}, {3.583576795955521*^9, 
   3.583576824698715*^9}, {3.5835768797347813`*^9, 3.583576881253284*^9}, {
   3.583576919032723*^9, 3.583577135366416*^9}, {3.583577200678216*^9, 
   3.583577202670073*^9}, {3.583577241965527*^9, 3.5835772510550613`*^9}, {
   3.58357730911159*^9, 3.5835773152987423`*^9}, {3.583579130423779*^9, 
   3.583579241356235*^9}, {3.5835792740276012`*^9, 3.583579309370728*^9}, {
   3.583580705363285*^9, 3.5835807233126507`*^9}, {3.583580762859995*^9, 
   3.583580766675058*^9}, {3.583585192548523*^9, 3.583585243785944*^9}, {
   3.5835855467482224`*^9, 3.5835857091591578`*^9}, 3.58358583685244*^9, {
   3.583585997333563*^9, 3.583586028871332*^9}, {3.583633934523099*^9, 
   3.5836339788746357`*^9}, {3.5836358067791862`*^9, 
   3.5836359964440346`*^9}, {3.5836447054948874`*^9, 3.583644705506629*^9}, {
   3.5836479708145657`*^9, 3.583647978595047*^9}, {3.583648012646912*^9, 
   3.5836480133425407`*^9}, {3.58364829936615*^9, 3.583648439615933*^9}, 
   3.58364860770573*^9, {3.583648751724841*^9, 3.58364879950019*^9}, 
   3.583649940976664*^9, {3.5836692045490522`*^9, 3.583669212554818*^9}, {
   3.5836692720492887`*^9, 3.5836692724360237`*^9}, {3.583671895376348*^9, 
   3.583670968458259*^9}, {3.583674369548357*^9, 3.5836743740987*^9}, {
   3.5836744193782177`*^9, 3.5836744290587177`*^9}, {3.583674717382567*^9, 
   3.583674720591298*^9}, {3.583675513385536*^9, 3.583675538137966*^9}, 
   3.588396883877122*^9, {3.592489754977849*^9, 3.59248976991066*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateCases", "[", 
   RowBox[{
   "unrestrictedVariables_", ",", "unsortedElements_", ",", "assumptions_"}], 
   "]"}], ":=", 
  RowBox[{"GenerateCasesRec", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "unrestrictedVariables", ",", 
    RowBox[{"{", "}"}], ",", "unsortedElements", ",", "assumptions"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.583557539768074*^9, 3.583557762465724*^9}, {
   3.58355782104672*^9, 3.5835578565233583`*^9}, {3.583558027412915*^9, 
   3.58355803716234*^9}, {3.5835629176683283`*^9, 3.5835629683853703`*^9}, {
   3.583563980939489*^9, 3.583564001966956*^9}, {3.583564056718583*^9, 
   3.58356409756966*^9}, {3.5835643733652*^9, 3.583564405256228*^9}, {
   3.583564554124687*^9, 3.583564644134193*^9}, {3.583564682474427*^9, 
   3.583564727057745*^9}, {3.583564771597574*^9, 3.5835648270296926`*^9}, {
   3.583564943477764*^9, 3.583565045732439*^9}, {3.583565126920644*^9, 
   3.583565158922567*^9}, {3.583565257902947*^9, 3.5835653113276863`*^9}, {
   3.5835653497359543`*^9, 3.583565534365399*^9}, {3.583565636191558*^9, 
   3.583565698338326*^9}, {3.583565742059122*^9, 3.583565748965234*^9}, {
   3.58356607665364*^9, 3.583566079620064*^9}, {3.583566166548798*^9, 
   3.5835661690747538`*^9}, {3.583567044700079*^9, 3.583567082849334*^9}, {
   3.58356712117845*^9, 3.583567151524308*^9}, 3.583571152188492*^9, {
   3.583572924103853*^9, 3.583572937055072*^9}, {3.5835732685119467`*^9, 
   3.5835732687069397`*^9}, {3.583573443498252*^9, 3.583573710173971*^9}, {
   3.583573764662854*^9, 3.583573810232126*^9}, {3.583573843339868*^9, 
   3.5835738736650553`*^9}, {3.583574200870504*^9, 3.583574252316443*^9}, {
   3.583575541521962*^9, 3.583575593042808*^9}, {3.583575651244084*^9, 
   3.58357579383456*^9}, {3.583575850559669*^9, 3.5835758784279823`*^9}, {
   3.583575917882612*^9, 3.5835759555772057`*^9}, {3.583576795955521*^9, 
   3.583576824698715*^9}, {3.5835768797347813`*^9, 3.583576881253284*^9}, {
   3.583576919032723*^9, 3.583577135366416*^9}, {3.583577200678216*^9, 
   3.583577202670073*^9}, {3.583577241965527*^9, 3.5835772510550613`*^9}, {
   3.58357730911159*^9, 3.5835773152987423`*^9}, {3.583579130423779*^9, 
   3.583579241356235*^9}, {3.5835792740276012`*^9, 3.583579309370728*^9}, {
   3.583580705363285*^9, 3.5835807233126507`*^9}, {3.583580762859995*^9, 
   3.583580766675058*^9}, {3.583585192548523*^9, 3.583585243785944*^9}, {
   3.5835855467482224`*^9, 3.5835857091591578`*^9}, 3.58358583685244*^9, {
   3.583585997333563*^9, 3.583586028871332*^9}, {3.583633934523099*^9, 
   3.5836339788746357`*^9}, {3.5836358067791862`*^9, 
   3.5836359964440346`*^9}, {3.5836447054948874`*^9, 3.583644705506629*^9}, {
   3.5836479708145657`*^9, 3.583647978595047*^9}, {3.583648012646912*^9, 
   3.5836480133425407`*^9}, {3.58364829936615*^9, 3.583648439615933*^9}, {
   3.58364860770573*^9, 3.5836486122127237`*^9}, {3.589267654213949*^9, 
   3.589267657196208*^9}, {3.589710504742592*^9, 3.589710505810424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RefineCase", "/@", " ", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "amin", ",", "amax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "bmin", ",", "bmax"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", 
       RowBox[{"a", "+", "b"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"0", "\[LessEqual]", "amin", "\[LessEqual]", "amax"}], "\[And]", 
      RowBox[{"0", "\[LessEqual]", "bmin", "\[LessEqual]", "bmax"}], "\[And]", 
      RowBox[{"0", "\[LessEqual]", "cmin", "\[LessEqual]", "cmax"}]}]}], 
    "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.594105699480682*^9, 3.594105831230609*^9}, {
  3.59410604275655*^9, 3.594106059349556*^9}, {3.594106288073255*^9, 
  3.5941063612543716`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"RefineCase", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", "amin"}], "]"}], ",", "amax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", "bmin"}], "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "a"}], ",", "bmax"}], "]"}]}], 
             "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", "+", "b"}], "}"}]}], "}"}]}], "}"}], "]"}]},
      {
       RowBox[{"RefineCase", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", "amin"}], "]"}], ",", "amax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "bmin", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", 
              RowBox[{"a", "+", "b"}]}], "}"}]}], "}"}]}], "}"}], "]"}]},
      {
       RowBox[{"RefineCase", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", "amin"}], "]"}], ",", "amax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"1", "+", "a"}], ",", "bmin"}], "]"}], ",", "bmax"}], 
             "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", "+", "b"}], "}"}]}], "}"}]}], "}"}], "]"}]},
      {
       RowBox[{"RefineCase", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "amin", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", "bmin"}], "]"}], ",", "bmax"}], "}"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"a", "+", "b"}]}], "}"}]}], "}"}]}], "}"}], "]"}]},
      {
       RowBox[{"RefineCase", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", "amin"}], "]"}], ",", "amax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"a", ",", "bmin"}], "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{"a", ",", "bmax"}], "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", "+", "b"}], "}"}]}], "}"}]}], "}"}], "]"}]},
      {
       RowBox[{"RefineCase", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "amin", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "bmin", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", 
             RowBox[{"a", "+", "b"}]}], "}"}], "}"}]}], "}"}], "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.596434803164405*^9, 3.596439712973422*^9, 
  3.5964410080345163`*^9, 3.5964411498990307`*^9, 3.596441182877193*^9, 
  3.596442962116743*^9, 3.5964488452798357`*^9, 3.5965468900624113`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Refine Ranges", "Subsection",
 CellChangeTimes->{{3.58971076633636*^9, 3.589710781211298*^9}}],

Cell[BoxData[
 RowBox[{"Test", "[", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "&"}], "/@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
     "allIlastImom8"}], ",", 
    RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.589102120296152*^9, 3.5891021282933483`*^9}, {
  3.589102172408558*^9, 3.58910223677885*^9}, {3.589102270919026*^9, 
  3.589102418857777*^9}, {3.5891025038302317`*^9, 3.589102507001256*^9}, {
  3.5892668309684563`*^9, 3.589266850539564*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RestrictRange", "]"}]], "Input",
 CellChangeTimes->{{3.589182359455215*^9, 3.589182366345334*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RestrictRange", "[", 
   RowBox[{
    RowBox[{"range", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "conditions_List"}], 
   "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"RestrictRange", ",", "range", ",", "conditions"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RestrictRange", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"var_", ",", "from_", ",", "to_"}], "}"}], ",", "condition_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"InequalityToRange", ",", "newFrom", ",", "newTo"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"cond_", "/;", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"cond", ",", "var"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"from", ",", "to"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Equal", "[", 
        RowBox[{"var", ",", "value_"}], "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"value", ",", "value"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"Less", "[", 
         RowBox[{"var", ",", "upper_"}], "]"}], "|", 
        RowBox[{"Greater", "[", 
         RowBox[{"upper_", ",", "var"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"from", ",", 
        RowBox[{"upper", "-", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"LessEqual", "[", 
         RowBox[{"var", ",", "upper_"}], "]"}], "|", 
        RowBox[{"GreaterEqual", "[", 
         RowBox[{"upper_", ",", "var"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"from", ",", "upper"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"Less", "[", 
         RowBox[{"lower_", ",", "var"}], "]"}], "|", 
        RowBox[{"Greater", "[", 
         RowBox[{"var", ",", "lower_"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lower", "+", "1"}], ",", "to"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{
        RowBox[{"LessEqual", "[", 
         RowBox[{"lower_", ",", "var"}], "]"}], "|", 
        RowBox[{"GreaterEqual", "[", 
         RowBox[{"var", ",", "lower_"}], "]"}]}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"lower", ",", "to"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{"var", ",", "Equal", ",", "value_"}], "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"value", ",", "value"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "Less", ",", "var", ",", "Less", ",", "upper_"}], 
        "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lower", "+", "1"}], ",", 
        RowBox[{"upper", "-", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "LessEqual", ",", "var", ",", "Less", ",", "upper_"}], 
        "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"lower", ",", 
        RowBox[{"upper", "-", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "Less", ",", "var", ",", "LessEqual", ",", "upper_"}], 
        "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lower", "+", "1"}], ",", "upper"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Inequality", "[", 
        RowBox[{
        "lower_", ",", "LessEqual", ",", "var", ",", "LessEqual", ",", 
         "upper_"}], "]"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"lower", ",", "upper"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InequalityToRange", "[", "cond_", "]"}], ":=", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<InequalityToRange[\>\"", ",", "cond", ",", 
        "\"\<], original condition: \>\"", ",", "condition"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newFrom", ",", "newTo"}], "}"}], "=", 
      RowBox[{"InequalityToRange", "[", 
       RowBox[{"Reduce", "[", 
        RowBox[{"condition", ",", "var", ",", "Reals"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"var", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"newFrom", ",", "from"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"to", ",", "newTo"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.5835811178165293`*^9, 3.583581143718897*^9}, {
   3.583584790846408*^9, 3.5835848056855307`*^9}, 3.5836447055472193`*^9, {
   3.5836489575065327`*^9, 3.583648967712529*^9}, {3.583649352465701*^9, 
   3.583649357309456*^9}, {3.5836704898414707`*^9, 3.58367049581266*^9}, {
   3.583675207409265*^9, 3.583675208430698*^9}, 3.588396897552434*^9, {
   3.589116372094862*^9, 3.589116416747821*^9}, {3.5891165070341253`*^9, 
   3.589116524390921*^9}, {3.589176591139172*^9, 3.589176710420115*^9}, {
   3.5891777007871037`*^9, 3.589177728062894*^9}, {3.5891784048057003`*^9, 
   3.58917859189776*^9}, {3.589178767145697*^9, 3.5891787713605337`*^9}, {
   3.589179241932678*^9, 3.5891792901596537`*^9}, {3.5891793246911907`*^9, 
   3.589179353481875*^9}, {3.5891805717864847`*^9, 3.589180572987508*^9}, {
   3.589182328541422*^9, 3.5891823311644373`*^9}, {3.5891823852522917`*^9, 
   3.5891824115250072`*^9}, {3.5892020492948847`*^9, 3.589202050659313*^9}, {
   3.5892031296038237`*^9, 3.5892031886469593`*^9}, {3.5892032495437307`*^9, 
   3.5892032989732857`*^9}, {3.589259245618294*^9, 3.589259256598778*^9}, {
   3.589264230920257*^9, 3.589264296273332*^9}, {3.589264509862447*^9, 
   3.5892645344494267`*^9}, {3.589264588595933*^9, 3.5892646393217382`*^9}, {
   3.58970061437605*^9, 3.589700651774637*^9}, {3.589700850216066*^9, 
   3.589700858336844*^9}, {3.589701203468651*^9, 3.589701208671132*^9}, {
   3.589701319364579*^9, 3.589701322017041*^9}}],

Cell[BoxData[{
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"RestrictRange", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
     RowBox[{"y", "<", 
      RowBox[{"-", "2"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", "10"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"RestrictRange", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
     RowBox[{"x", "<", "n"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"n", "-", "1"}], ",", "10"}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{"RestrictRange", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "x"}], "-", "1"}], ">", "2"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.589176732220557*^9, 3.589176736129939*^9}, {
   3.5891822869226217`*^9, 3.5891823063409843`*^9}, {3.589189451757101*^9, 
   3.5891894521001797`*^9}, {3.589191702733626*^9, 3.589191717142434*^9}, 
   3.589202062381701*^9, {3.5892597337075777`*^9, 3.589259821065755*^9}, {
   3.589264669845296*^9, 3.589264716808223*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "RestrictRanges111", "]"}]], "Input",
 CellChangeTimes->{{3.5892644165650187`*^9, 3.589264426942258*^9}, {
  3.589264771576661*^9, 3.5892647720169086`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RestrictRanges111", "[", 
   RowBox[{"ranges_", ",", "restrictions_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "variables", ",", "simplifiedRestrictions", ",", "restrictionsByVar", 
      ",", "RestrictionVar", ",", "VarRestrictions", ",", 
      "otherRestrictions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"variables", "=", 
      RowBox[{"First", "/@", "ranges"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{
      "\"\<RestrictRanges111: restrictions = \>\"", ",", "restrictions"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "RestrictionVar", " ", "is", " ", "true", " ", "iff", " ", "varIndex", 
       " ", "is", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
       "variable", " ", "restriction", " ", "should", " ", "be", " ", 
       "applied", " ", "to"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RestrictionVar", "[", 
       RowBox[{"varIndex_", ",", "restriction_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"restriction", ",", 
         RowBox[{"variables", "[", 
          RowBox[{"[", "varIndex", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "]"}], "\[And]", 
       RowBox[{"FreeFromQ", "[", 
        RowBox[{"restriction", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"variables", ",", "varIndex"}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "the", " ", "restrictions", " ", "must", " ", "be", " ", "simplified", 
       " ", "before", " ", "proceeding", " ", "to", " ", "eliminate", " ", 
       "useless", " ", "variables", " ", "which", " ", "could", " ", 
       "confuse", " ", "RestrictionVar"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"simplifiedRestrictions", "=", 
      RowBox[{"Simplify", "[", "restrictions", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Selects", " ", "all", " ", "the", " ", "restrictions", " ", "that", 
       " ", "apply", " ", "to", " ", "a", " ", "given", " ", "variable"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"VarRestrictions", "[", "varIndex_", "]"}], ":=", 
      RowBox[{"Select", "[", 
       RowBox[{"simplifiedRestrictions", ",", 
        RowBox[{
         RowBox[{"RestrictionVar", "[", 
          RowBox[{"varIndex", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RestrictionVar", "[", 
             RowBox[{"ii", ",", "rr"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"rr", ",", "restrictions"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", 
              RowBox[{"Length", "[", "ranges", "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"restrictions", ",", "variables"}], "}"}]}]}], "]"}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"restrictionsByVar", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"VarRestrictions", ",", 
        RowBox[{"Length", "[", "ranges", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"\"\<RestrictRanges111: \>\"", ",", "restrictionsByVar"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"otherRestrictions", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"simplifiedRestrictions", ",", 
        RowBox[{
         RowBox[{"FreeFromQ", "[", 
          RowBox[{"#", ",", "variables"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"otherRestrictions", ",", 
        RowBox[{"MapThread", "[", 
         RowBox[{"RestrictRange", ",", 
          RowBox[{"{", 
           RowBox[{"ranges", ",", "restrictionsByVar"}], "}"}]}], "]"}]}], 
       "}"}], "//", "Simplify"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.5836446446619377`*^9, 3.583644673567235*^9}, 
   3.583644705555285*^9, {3.5836452213694353`*^9, 3.583645230027803*^9}, {
   3.5836455523251*^9, 3.583645560283185*^9}, {3.583646978485379*^9, 
   3.5836470441443253`*^9}, {3.58364716214084*^9, 3.583647185148582*^9}, {
   3.583647216585754*^9, 3.5836473358601418`*^9}, {3.5836474543542967`*^9, 
   3.583647456956017*^9}, {3.583647495730134*^9, 3.583647617364272*^9}, 
   3.583647661088532*^9, {3.583647692493802*^9, 3.583647741798853*^9}, {
   3.583647859449625*^9, 3.583647935905892*^9}, {3.583648710026723*^9, 
   3.583648714344797*^9}, {3.583649996716239*^9, 3.583649997941421*^9}, {
   3.583663733675763*^9, 3.583663852154324*^9}, {3.58366389049496*^9, 
   3.5836639575940037`*^9}, {3.5836643931073112`*^9, 3.583664468002783*^9}, {
   3.583664563126719*^9, 3.58366456911593*^9}, {3.583664641244843*^9, 
   3.5836648363527403`*^9}, {3.583665484744028*^9, 3.583665486408791*^9}, {
   3.583665557109825*^9, 3.583665625733178*^9}, {3.5836665687714853`*^9, 
   3.583666638731256*^9}, {3.5836666843104553`*^9, 3.583666734578333*^9}, {
   3.583666787978092*^9, 3.583666803096407*^9}, {3.583666952340432*^9, 
   3.583666980122864*^9}, {3.58366855644106*^9, 3.583668628143606*^9}, {
   3.5836687206584187`*^9, 3.583668729839519*^9}, {3.583668766534688*^9, 
   3.583668855205319*^9}, {3.5836689008511257`*^9, 3.5836689262143908`*^9}, {
   3.583669287503819*^9, 3.5836692920546293`*^9}, {3.583669369347295*^9, 
   3.583669387168468*^9}, {3.5836695121544743`*^9, 3.583669521782387*^9}, {
   3.5836695843756247`*^9, 3.583669590555729*^9}, {3.583674487819498*^9, 
   3.583674514176515*^9}, {3.583674573970443*^9, 3.583674580679831*^9}, {
   3.583674615827458*^9, 3.583674678092593*^9}, {3.583674747562326*^9, 
   3.583674801272292*^9}, 3.583748792451912*^9, {3.5837488735826893`*^9, 
   3.583749010771625*^9}, {3.588396871409881*^9, 3.588396898754623*^9}, 
   3.5891160540396442`*^9, {3.5891161611659107`*^9, 3.5891161981000967`*^9}, {
   3.589116284983321*^9, 3.589116309284924*^9}, 3.589177030745924*^9, {
   3.589177576340475*^9, 3.5891776192004423`*^9}, {3.589178341941971*^9, 
   3.589178355457025*^9}, {3.589179387657013*^9, 3.5891793893383713`*^9}, {
   3.589179420973276*^9, 3.589179465820043*^9}, {3.589179541294775*^9, 
   3.589179583627534*^9}, {3.589179718876409*^9, 3.5891797512750673`*^9}, 
   3.589180632054878*^9, {3.589181033850573*^9, 3.5891810508285103`*^9}, {
   3.589181086452433*^9, 3.589181373987947*^9}, {3.589181433835799*^9, 
   3.5891815039747047`*^9}, {3.5891815458208723`*^9, 3.589181833805357*^9}, {
   3.589181907394968*^9, 3.5891821638669*^9}, {3.589182218796484*^9, 
   3.589182234288919*^9}, {3.589188963947997*^9, 3.589188964643341*^9}, {
   3.5891919747135057`*^9, 3.5891920131593*^9}, 3.589192110980383*^9, {
   3.589192152342889*^9, 3.589192229468554*^9}, {3.5891922628325653`*^9, 
   3.589192344161571*^9}, {3.5891927087770853`*^9, 3.58919273638717*^9}, {
   3.589192798508556*^9, 3.589192801365787*^9}, {3.589193610573793*^9, 
   3.58919363632815*^9}, {3.589193710451591*^9, 3.589193814887638*^9}, {
   3.589193954799975*^9, 3.589194005171481*^9}, {3.5891957842192173`*^9, 
   3.5891958040285378`*^9}, {3.589195904945284*^9, 3.589195907084841*^9}, 
   3.589195961885653*^9, {3.5891959948391027`*^9, 3.589196037827161*^9}, {
   3.589196077672941*^9, 3.58919608765097*^9}, {3.58919623466619*^9, 
   3.5891962558281317`*^9}, {3.589196994577199*^9, 3.5891970024169617`*^9}, {
   3.5891976759260607`*^9, 3.5891976763558903`*^9}, {3.589198588553347*^9, 
   3.5891985886722603`*^9}, {3.5892012496224203`*^9, 3.589201255237817*^9}, {
   3.589201666143866*^9, 3.589201683962533*^9}, {3.589202107703974*^9, 
   3.5892021081970987`*^9}, {3.5892021394242973`*^9, 3.589202221500054*^9}, {
   3.589202299262616*^9, 3.589202377792903*^9}, {3.589262186572659*^9, 
   3.589262292831374*^9}, {3.589262417292968*^9, 3.589262494612005*^9}, {
   3.589262531593492*^9, 3.5892625342383547`*^9}, {3.589262586194976*^9, 
   3.589262859960143*^9}, {3.589262916845417*^9, 3.589263035384704*^9}, {
   3.589263071383358*^9, 3.589263115973824*^9}, {3.589263146172578*^9, 
   3.589263171394473*^9}, {3.589263976731906*^9, 3.589264011357983*^9}, {
   3.5892640720627117`*^9, 3.58926418780145*^9}, {3.58926431755856*^9, 
   3.589264385439622*^9}, {3.589264754660205*^9, 3.589264755182229*^9}, {
   3.5892649530840893`*^9, 3.589264954795051*^9}, {3.589265016921404*^9, 
   3.589265156919181*^9}, {3.589265307950251*^9, 3.58926535443641*^9}, {
   3.589690753780691*^9, 3.5896907635847397`*^9}, {3.589690822701191*^9, 
   3.589690861454793*^9}, {3.589691067648857*^9, 3.589691092394264*^9}, {
   3.589691245633628*^9, 3.58969127393939*^9}, {3.589691366597917*^9, 
   3.589691445977187*^9}, {3.589691487942972*^9, 3.5896915748683243`*^9}, {
   3.5896916364418583`*^9, 3.589691799449688*^9}, {3.5896918457664833`*^9, 
   3.5896919581482573`*^9}, {3.589692018090592*^9, 3.589692048846999*^9}, {
   3.589692131158695*^9, 3.589692248854644*^9}, {3.589692280635524*^9, 
   3.5896922810504417`*^9}, {3.5897108852667017`*^9, 3.589710936810902*^9}, {
   3.589711026710822*^9, 3.5897110456161346`*^9}, {3.589711093666492*^9, 
   3.589711098565659*^9}}],

Cell[BoxData[
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"RestrictRanges111", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "1", ",", "10"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "+", "b"}], "<", 
       RowBox[{"a", "+", "5"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.589176978958716*^9, 3.589176982012632*^9}, {
   3.589177435671517*^9, 3.58917745516884*^9}, {3.589179137368465*^9, 
   3.589179158563136*^9}, 3.589179194949465*^9, {3.589179347986719*^9, 
   3.5891793846922092`*^9}, {3.589182449905507*^9, 3.5891824751031933`*^9}, {
   3.589188924339435*^9, 3.589188939075904*^9}, {3.5892023839876337`*^9, 
   3.589202388501041*^9}, {3.58926444685359*^9, 3.589264492641176*^9}, {
   3.589264781629054*^9, 3.589264782030562*^9}, {3.5917031492489147`*^9, 
   3.591703169075061*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"RangeCondition0", ",", "RangeCondition"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeCondition0", "[", 
   RowBox[{"from_Max", ",", "to_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RangeCondition0", "[", 
     RowBox[{"#", ",", "to"}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{"List", "@@", "from"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeCondition0", "[", 
   RowBox[{"from_", ",", "to_Min"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RangeCondition0", "[", 
     RowBox[{"from", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{"List", "@@", "to"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeCondition0", "[", 
   RowBox[{"from_", ",", "to_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"from", "\[LessEqual]", "to"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeCondition", "[", 
   RowBox[{"{", 
    RowBox[{"_", ",", "from_", ",", "to_"}], "}"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"RangeCondition0", "[", 
    RowBox[{"from", ",", "to"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangesCondition", "[", "ranges_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"RangeCondition", "/@", "ranges"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"RangeCondition", "[", 
    RowBox[{"{", 
     RowBox[{"v", ",", 
      RowBox[{"Max", "[", 
       RowBox[{"a", ",", "b"}], "]"}], ",", 
      RowBox[{"Min", "[", 
       RowBox[{"c", ",", "d"}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[LessEqual]", "c"}], ",", 
     RowBox[{"a", "\[LessEqual]", "d"}], ",", 
     RowBox[{"b", "\[LessEqual]", "c"}], ",", 
     RowBox[{"b", "\[LessEqual]", "d"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.589256436370718*^9, 3.5892564835068398`*^9}, {
  3.589256551428841*^9, 3.589256558731509*^9}, {3.589256633536833*^9, 
  3.589256785250503*^9}, {3.589256820619295*^9, 3.589256827256864*^9}, {
  3.589256875163821*^9, 3.589256875369404*^9}, {3.58925692341006*^9, 
  3.5892569336206493`*^9}, {3.5892572226300898`*^9, 3.5892572621545353`*^9}, {
  3.5892573084982224`*^9, 3.589257308625358*^9}, {3.5892578634252443`*^9, 
  3.589257863780864*^9}, {3.5892592911175747`*^9, 3.5892593629135036`*^9}, {
  3.5892594071126537`*^9, 3.589259411583581*^9}, {3.589260777511623*^9, 
  3.589260804857255*^9}, {3.5892612597347813`*^9, 3.589261266428589*^9}, {
  3.589261382518853*^9, 3.5892614000791397`*^9}, {3.589261453204824*^9, 
  3.589261454763166*^9}, {3.589261506059946*^9, 3.589261525668728*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"RefineRangesStep", ",", "RefineRanges"}], "]"}]], "Input",
 CellChangeTimes->{{3.5897116521613626`*^9, 3.589711661667633*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RefineRangesStep", "[", 
    RowBox[{"{", 
     RowBox[{"otherConditions_", ",", "ranges_"}], "}"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Echo", "[", 
      RowBox[{"\"\<RefineRangesStep:\>\"", ",", "ranges"}], "]"}], ";", 
     RowBox[{"RestrictRanges111", "[", 
      RowBox[{"ranges", ",", 
       RowBox[{"ranges", "//", "RangesCondition"}]}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "should", " ", "reach", " ", "the", " ", "fixed", " ", "point", 
    " ", "in", " ", 
    RowBox[{"Length", "[", "ranges", "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefineRanges", "[", "ranges_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "restrictionSteps", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"restrictionSteps", "=", 
      RowBox[{"FixedPointList", "[", 
       RowBox[{"RefineRangesStep", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "ranges"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "ranges", "]"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Length", "[", "restrictionSteps", "]"}], "\[LessEqual]", 
       RowBox[{"Length", "[", "ranges", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"restrictionSteps", "//", "Transpose"}], "//", "First"}], 
           "//", "Flatten"}], ")"}]}], "//", "Simplify"}], ",", 
       RowBox[{"restrictionSteps", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.589103653801161*^9, 3.589103663716494*^9}, {
   3.58910405242135*^9, 3.589104075794509*^9}, {3.589105127179538*^9, 
   3.5891051312493343`*^9}, {3.5891056991268578`*^9, 
   3.5891057476958323`*^9}, {3.589105794738693*^9, 3.58910580544314*^9}, {
   3.58910624655722*^9, 3.5891062894370337`*^9}, {3.58910646841584*^9, 
   3.589106469479528*^9}, {3.5891066737740192`*^9, 3.589106674895405*^9}, {
   3.589108029385702*^9, 3.589108035425746*^9}, 3.589108115714592*^9, 
   3.589116071423963*^9, {3.589182178043684*^9, 3.589182180277763*^9}, {
   3.589192774123666*^9, 3.5891927750145884`*^9}, {3.58919365952382*^9, 
   3.589193688914743*^9}, {3.589200945381875*^9, 3.5892009807189417`*^9}, 
   3.589202397344895*^9, {3.5892573285871773`*^9, 3.589257389080551*^9}, 
   3.5892593502523003`*^9, {3.589261176070814*^9, 3.5892612365591173`*^9}, {
   3.589261536397307*^9, 3.589261567391513*^9}, {3.5892616110880213`*^9, 
   3.5892616170703487`*^9}, {3.589264801044729*^9, 3.589264801454303*^9}, {
   3.589264850389077*^9, 3.5892648505661497`*^9}, {3.589264990157578*^9, 
   3.589264990565744*^9}, {3.589265487629323*^9, 3.5892655245863934`*^9}, {
   3.589637268320175*^9, 3.589637279953459*^9}, {3.58969226373973*^9, 
   3.589692266174727*^9}, {3.589711154276948*^9, 3.589711272587104*^9}, {
   3.589711456062048*^9, 3.589711517305204*^9}, {3.589711605101739*^9, 
   3.5897116339947653`*^9}, {3.589711688347124*^9, 3.589711690575601*^9}, {
   3.589711721631639*^9, 3.589711756444647*^9}, {3.5897125213297167`*^9, 
   3.589712523191288*^9}, {3.58971404188175*^9, 3.589714086539865*^9}}],

Cell[BoxData[
 RowBox[{"Test", "[", 
  RowBox[{"RefineRanges", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "j", "+", "k"}]}], "}"}]}], "}"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.589711281323999*^9, 3.5897113060967293`*^9}, {
  3.5897114401200123`*^9, 3.589711440810895*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefineCase", "[", 
   RowBox[{"{", 
    RowBox[{"ranges_", ",", "timeList_"}], "}"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"RefineRanges", "[", "ranges", "]"}], ",", 
    RowBox[{"{", "timeList", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.589197070344708*^9, 3.58919708869565*^9}, {
  3.589197247363402*^9, 3.5891972568352118`*^9}, {3.589197296265729*^9, 
  3.589197433659356*^9}, {3.5891976178474197`*^9, 3.589197618483679*^9}, {
  3.589200846180892*^9, 3.589200853250465*^9}, {3.589201749266445*^9, 
  3.589201755179034*^9}, {3.58920181046434*^9, 3.5892018189417*^9}, {
  3.5892657165742292`*^9, 3.589265739698716*^9}, {3.5897118965573587`*^9, 
  3.589711939617133*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Cases to Sums", "Subsection",
 CellChangeTimes->{{3.588402125988614*^9, 3.588402142587452*^9}, {
  3.588402324658967*^9, 3.588402324932763*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"SecretSum", "[", "args__", "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"Sum", "[", "args", "]"}], ",", "StandardForm"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.595053880452547*^9, 3.595053880453699*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"momentList", "=", 
   RowBox[{
    RowBox[{"First", "/@", "moments"}], "/.", "NamesToExponentials"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.587994078680496*^9, 3.587994149497751*^9}, {
  3.588403286096675*^9, 3.588403288365493*^9}, {3.588403368924858*^9, 
  3.5884033740558434`*^9}, {3.58840398042327*^9, 3.58840407719748*^9}, {
  3.5884149310274153`*^9, 3.588414936866168*^9}, {3.591705779598184*^9, 
  3.59170578335035*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"First", "/@", 
          RowBox[{"ComputeCoefficients", "[", "#", "]"}]}], "&"}], ")"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<moments4\>\"", ",", "\"\<moments6\>\"", ",", 
         "\"\<moments8\>\""}], "}"}]}], ")"}], "]"}], "\[Equal]", 
    RowBox[{"Rest", "[", 
     RowBox[{"First", "/@", "moments"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5917054795628033`*^9, 3.591705533807025*^9}, {
  3.591705739083222*^9, 3.5917057571500177`*^9}, {3.591705807875922*^9, 
  3.591705814331579*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "TimeListToMoment", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TimeListToMoment", "[", "times_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"deltas", ",", "moment", ",", "ReplaceWithFirst"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplaceWithFirst", "[", "list_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "list", "]"}], "&"}], "/@", "list"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"moment", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"Length", "/@", "times"}]}], ")"}], "//", "Reverse"}], "//",
          "EGName"}], "//", "Symbol"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"moments", "=", 
         RowBox[{
          RowBox[{"First", "/@", 
           RowBox[{"MySym", "[", 
            RowBox[{"\"\<moments\>\"", ",", 
             RowBox[{"Plus", "@@", "indexes"}]}], "]"}]}], "/.", 
          "NamesToExponentials"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"deltas", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ReplaceWithFirst", "/@", "times"}], "//", "Flatten"}], "//",
          "Differences"}], "//", "Reverse"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"moment", "/.", "momentList"}], "/.", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "i_", "]"}], "\[RuleDelayed]", 
        RowBox[{"deltas", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.582134447121895*^9, 3.5821344515050097`*^9}, {
   3.5821876458012295`*^9, 3.582187681426267*^9}, {3.58218774738704*^9, 
   3.5821877489711304`*^9}, {3.582604980048583*^9, 3.582604982286847*^9}, {
   3.582605971455817*^9, 3.582605987025938*^9}, 3.5828032746961613`*^9, 
   3.5879682508876143`*^9, {3.587968366461233*^9, 3.587968386424947*^9}, 
   3.587969134174011*^9, {3.5879691649713*^9, 3.58796928466957*^9}, {
   3.587969320920623*^9, 3.587969368876891*^9}, {3.587980466862564*^9, 
   3.587980517334723*^9}, {3.587981692404933*^9, 3.58798172814939*^9}, {
   3.58798203702673*^9, 3.587982062202035*^9}, {3.587984572630815*^9, 
   3.587984581661582*^9}, {3.587984747668209*^9, 3.587984776977764*^9}, {
   3.587985306926499*^9, 3.587985464956604*^9}, {3.587985528160898*^9, 
   3.587985542891304*^9}, {3.587987257256968*^9, 3.5879873850780287`*^9}, {
   3.587988851456737*^9, 3.5879888721935596`*^9}, {3.587988928886367*^9, 
   3.587988970426705*^9}, {3.5879941614399853`*^9, 3.5879941713168373`*^9}, {
   3.588047436181273*^9, 3.588047439611719*^9}, 3.588047647189872*^9, {
   3.588048013614547*^9, 3.5880480592813263`*^9}, {3.588048101928813*^9, 
   3.5880481034111032`*^9}, {3.588048253664822*^9, 3.588048370677249*^9}, {
   3.588048461671226*^9, 3.588048522928391*^9}, 3.588402153058794*^9, 
   3.588402370331252*^9, {3.588403042912039*^9, 3.588403078133575*^9}, 
   3.588404087547719*^9, {3.5884147770484953`*^9, 3.5884147967435303`*^9}, {
   3.589525151435944*^9, 3.589525151753661*^9}, {3.590237095495378*^9, 
   3.590237233597516*^9}, {3.590237277711956*^9, 3.590237533288793*^9}, {
   3.590237674929603*^9, 3.590237733208604*^9}, {3.590237771262642*^9, 
   3.590237788143922*^9}, {3.59197028430444*^9, 3.591970343088859*^9}, {
   3.5919705716104307`*^9, 3.5919706107402687`*^9}, {3.5919707412042522`*^9, 
   3.591970747928013*^9}, {3.592022767764059*^9, 3.592022769366724*^9}, {
   3.5920242951630096`*^9, 3.592024314996011*^9}, {3.592025487241754*^9, 
   3.592025489546166*^9}, {3.592025567437727*^9, 3.592025569597042*^9}, 
   3.592042038218878*^9, {3.5920424941808434`*^9, 3.592042497115664*^9}, {
   3.5944488134310713`*^9, 3.594448826715241*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TimeListToMoment", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["t", "0"], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox["t", "1"], "}"}]}], "}"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeListToMoment", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["t", "0"], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox["t", "1"], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox["t", "2"], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox["t", "3"], "}"}]}], "}"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeListToMoment", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["t", "0"], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["t", "1"], ",", 
       SubscriptBox["t", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox["t", "3"], "}"}]}], "}"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeListToMoment", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["t", "0"], ",", 
       SubscriptBox["t", "1"]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox["t", "2"], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox["t", "3"], "}"}]}], "}"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeListToMoment", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "j"}], ",", 
       RowBox[{"r", "-", "k"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", "-", "\[Kappa]"}], "}"}]}], "}"}], "]"}], "//", 
  "Test"}]}], "Input",
 CellChangeTimes->{{3.582134447121895*^9, 3.5821344515050097`*^9}, {
   3.5821876458012295`*^9, 3.582187681426267*^9}, {3.58218774738704*^9, 
   3.5821877489711304`*^9}, {3.582604980048583*^9, 3.582604982286847*^9}, {
   3.582605971455817*^9, 3.582605987025938*^9}, 3.5828032746961613`*^9, 
   3.5879682508876143`*^9, {3.587968366461233*^9, 3.587968386424947*^9}, 
   3.587969134174011*^9, {3.5879691649713*^9, 3.58796928466957*^9}, {
   3.587969320920623*^9, 3.587969368876891*^9}, {3.587980466862564*^9, 
   3.587980517334723*^9}, {3.587981692404933*^9, 3.58798172814939*^9}, {
   3.58798203702673*^9, 3.587982062202035*^9}, {3.587984572630815*^9, 
   3.587984581661582*^9}, {3.587984747668209*^9, 3.587984776977764*^9}, {
   3.587985306926499*^9, 3.587985464956604*^9}, {3.587985528160898*^9, 
   3.587985542891304*^9}, {3.587987257256968*^9, 3.5879873850780287`*^9}, {
   3.587988851456737*^9, 3.5879888721935596`*^9}, {3.587988928886367*^9, 
   3.587988970426705*^9}, {3.5879941614399853`*^9, 3.5879941713168373`*^9}, {
   3.588047436181273*^9, 3.588047439611719*^9}, 3.588047647189872*^9, {
   3.588048013614547*^9, 3.5880480592813263`*^9}, {3.588048101928813*^9, 
   3.5880481034111032`*^9}, {3.588048253664822*^9, 3.588048370677249*^9}, {
   3.588048461671226*^9, 3.588048522928391*^9}, 3.588402153058794*^9, 
   3.588402370331252*^9, {3.588403042912039*^9, 3.588403078133575*^9}, 
   3.588404087547719*^9, {3.5884147770484953`*^9, 3.5884147967435303`*^9}, {
   3.589525151435944*^9, 3.589525151753661*^9}, {3.590237095495378*^9, 
   3.590237233597516*^9}, {3.590237277711956*^9, 3.590237550292611*^9}, {
   3.590237795731127*^9, 3.590237798297503*^9}, {3.591969804919621*^9, 
   3.591969847080473*^9}, {3.591969895075699*^9, 3.591969915931773*^9}, {
   3.5919704397036867`*^9, 3.591970447690434*^9}, {3.592042074882987*^9, 
   3.5920420868182592`*^9}, {3.592042660283092*^9, 3.592042708298696*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CasesToSums", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CasesToSums", "[", 
   RowBox[{
   "cases_", ",", "expr_", ",", "indexVariables_", ",", "sumVariables_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"SelectRanges", ",", "CaseToSum", ",", "CeilRange"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SelectRanges", "[", 
       RowBox[{"ranges_", ",", "variables_"}], "]"}], ":=", 
      RowBox[{"Select", "[", 
       RowBox[{"ranges", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"variables", ",", 
           RowBox[{"First", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CeilRange", "[", 
       RowBox[{"{", 
        RowBox[{"var_", ",", "from_", ",", "to_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"var", ",", 
         RowBox[{"Ceiling", "[", "from", "]"}], ",", 
         RowBox[{"Floor", "[", "to", "]"}]}], "}"}], "//", "Simplify"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CaseToSum", "[", 
       RowBox[{"{", 
        RowBox[{"caseCond_", ",", "ranges_", ",", "timeList_"}], "}"}], "]"}],
       ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "innerExpr", ",", "sumRanges", ",", "innerSum", ",", "indexRanges"}],
          "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"innerExpr", "=", 
          RowBox[{"Times", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"TimeListToMoment", "[", "timeList", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"sumRanges", "=", 
          RowBox[{"CeilRange", "/@", 
           RowBox[{"SelectRanges", "[", 
            RowBox[{"ranges", ",", 
             RowBox[{"Reverse", "[", "sumVariables", "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"innerSum", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sumRanges", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "innerExpr", ",", 
            RowBox[{"SecretSum", "@@", 
             RowBox[{"Prepend", "[", 
              RowBox[{"sumRanges", ",", "innerExpr"}], "]"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"indexRanges", "=", 
          RowBox[{"CeilRange", "/@", 
           RowBox[{"SelectRanges", "[", 
            RowBox[{"ranges", ",", "indexVariables"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"indexRanges", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "innerSum", ",", 
           RowBox[{"SecretTable", "@@", 
            RowBox[{"Prepend", "[", 
             RowBox[{"indexRanges", ",", "innerSum"}], "]"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CaseToSum", "/@", "cases"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.582623772956596*^9, 3.582623783032342*^9}, 
   3.582624627329721*^9, {3.582802515235611*^9, 3.58280265089847*^9}, {
   3.582803085049233*^9, 3.582803111954628*^9}, {3.582803170837298*^9, 
   3.58280321769867*^9}, {3.582803342941299*^9, 3.582803357378385*^9}, {
   3.5828040482444477`*^9, 3.582804070364258*^9}, {3.582804106556501*^9, 
   3.582804135624816*^9}, {3.582872907470475*^9, 3.5828729247224503`*^9}, {
   3.582873274344037*^9, 3.582873334877242*^9}, {3.582873378014287*^9, 
   3.582873486236998*^9}, {3.58287356848752*^9, 3.58287359600034*^9}, {
   3.582873711492387*^9, 3.582873769918606*^9}, 3.582873838599453*^9, {
   3.5828738700605516`*^9, 3.58287388610843*^9}, {3.5828740107358847`*^9, 
   3.582874095749549*^9}, {3.582884824785275*^9, 3.5828848489767933`*^9}, {
   3.582884894924563*^9, 3.5828849036549*^9}, {3.582884954831826*^9, 
   3.582885041284506*^9}, {3.582885350162325*^9, 3.582885410151742*^9}, {
   3.582886121578333*^9, 3.582886142798709*^9}, {3.582886186652052*^9, 
   3.582886205271298*^9}, {3.5828863848162937`*^9, 3.582886419390082*^9}, 
   3.582886634877881*^9, {3.582971930710496*^9, 3.582971938045663*^9}, {
   3.583036721635021*^9, 3.5830367354411917`*^9}, 3.5830368600762463`*^9, {
   3.5830387321028433`*^9, 3.583038757328682*^9}, {3.5830409954817867`*^9, 
   3.583040998357401*^9}, {3.5842481708604794`*^9, 3.5842482076387777`*^9}, {
   3.584248253452035*^9, 3.58424828458672*^9}, {3.584249299042325*^9, 
   3.58424942079854*^9}, {3.584769084980221*^9, 3.584769104326048*^9}, {
   3.5847710983025913`*^9, 3.5847711060982428`*^9}, {3.5879939185902348`*^9, 
   3.587993924257544*^9}, {3.588313914508539*^9, 3.588313935696949*^9}, 
   3.588407852121627*^9, {3.588407923712311*^9, 3.588407926494733*^9}, {
   3.588414847278974*^9, 3.588414850791975*^9}, {3.589090025969689*^9, 
   3.589090059595886*^9}, {3.589714932067155*^9, 3.589715003669807*^9}, {
   3.589715036214426*^9, 3.589715089314268*^9}, {3.589715304736575*^9, 
   3.5897153425534267`*^9}, {3.589715603322337*^9, 3.5897156047082376`*^9}, {
   3.589867758651503*^9, 3.589867769884159*^9}, {3.589867814593361*^9, 
   3.589867901512713*^9}, {3.589867940605822*^9, 3.589868162766926*^9}, {
   3.589868205254731*^9, 3.589868233320513*^9}, {3.591970671356063*^9, 
   3.591970673684271*^9}}],

Cell[BoxData[
 RowBox[{"Test", "[", 
  RowBox[{"rawSums", "[", 
   RowBox[{"[", "77", "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{"Test", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{"rawSums", ",", "_Ceiling", ",", "\[Infinity]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{"rawSums", ",", "_Floor", ",", "\[Infinity]"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.58971548518926*^9, 3.58971549529874*^9}, {
  3.5897159387477016`*^9, 3.589716069653165*^9}, {3.589716204091601*^9, 
  3.589716326422991*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplify Sums", "Subsection",
 CellChangeTimes->{{3.582624300801486*^9, 3.582624304641271*^9}, {
  3.58971544382777*^9, 3.589715445816883*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "SmartFreeVars", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SmartFreeVars", "[", 
   RowBox[{"expr_", "/;", 
    RowBox[{"AtomQ", "[", "expr", "]"}]}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{"expr", ",", "_Symbol", ",", 
    RowBox[{"{", "expr", "}"}], ",", "_", ",", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SmartFreeVars", "[", 
   RowBox[{"expr_", "/;", 
    RowBox[{"Not", "[", 
     RowBox[{"AtomQ", "[", "expr", "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{"expr", ",", "\[IndentingNewLine]", "_SecretSum", ",", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"SmartFreeVars", "[", 
        RowBox[{"First", "[", "expr", "]"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"Rest", "[", 
         RowBox[{"List", "@@", "expr"}], "]"}]}]}], "]"}], "\[Union]", 
     RowBox[{"SmartFreeVars", "[", 
      RowBox[{"Rest", "/@", 
       RowBox[{"Rest", "[", 
        RowBox[{"List", "@@", "expr"}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "_SecretTable", ",", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"SmartFreeVars", "[", 
        RowBox[{"First", "[", "expr", "]"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"Rest", "[", 
         RowBox[{"Rest", "[", 
          RowBox[{"List", "@@", "expr"}], "]"}], "]"}]}]}], "]"}], "\[Union]", 
     RowBox[{"SmartFreeVars", "[", 
      RowBox[{"Rest", "/@", 
       RowBox[{"Rest", "[", 
        RowBox[{"List", "@@", "expr"}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "_", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"SmartFreeVars", "/@", 
       RowBox[{"List", "@@", "expr"}]}], "//", "Flatten"}], "//", "Union"}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"SmartFreeVars", "[", 
    RowBox[{"SecretSum", "[", 
     RowBox[{
      RowBox[{"j", " ", 
       RowBox[{"f", "[", "i", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"SmartFreeVars", "[", 
    RowBox[{
     RowBox[{"j", " ", "x"}], "+", 
     RowBox[{"SecretSum", "[", 
      RowBox[{
       RowBox[{"j", " ", 
        RowBox[{"f", "[", "i", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "m", ",", "n", ",", "x"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.588317683708694*^9, 3.588317765430303*^9}, {
   3.588317865130908*^9, 3.588317975492874*^9}, {3.5883180225638227`*^9, 
   3.588318039719933*^9}, {3.588318076559523*^9, 3.5883181263091908`*^9}, {
   3.5883246453056183`*^9, 3.5883246495612803`*^9}, {3.5883249847116013`*^9, 
   3.588324991762699*^9}, {3.588325040564178*^9, 3.5883250689485493`*^9}, {
   3.588325149681725*^9, 3.5883252591260643`*^9}, {3.5883253392010193`*^9, 
   3.58832534290898*^9}, {3.588325512868382*^9, 3.588325516143476*^9}, {
   3.58832555211205*^9, 3.588325577673753*^9}, {3.588325645915534*^9, 
   3.588325696887595*^9}, {3.588325776373852*^9, 3.588325783215086*^9}, 
   3.5883259741432247`*^9, {3.5884246396658497`*^9, 3.5884246603799057`*^9}, {
   3.588424867491662*^9, 3.588424869109357*^9}, 3.588425271136681*^9, {
   3.58842609369347*^9, 3.588426289275099*^9}, {3.588426351790431*^9, 
   3.588426387731676*^9}, {3.588506078261942*^9, 3.588506142051733*^9}, {
   3.588651587678588*^9, 3.588651678628112*^9}, {3.588651888913175*^9, 
   3.5886519724573307`*^9}, {3.588669318354362*^9, 3.588669333113765*^9}, {
   3.58867242931277*^9, 3.5886724362230883`*^9}, 3.5886724843966722`*^9, {
   3.588999168012124*^9, 3.588999172299399*^9}, {3.5889994670039587`*^9, 
   3.588999500628262*^9}, {3.588999534819544*^9, 3.588999548459909*^9}, {
   3.58899969552324*^9, 3.588999728350574*^9}, 3.588999774642439*^9, {
   3.588999816520095*^9, 3.588999823817913*^9}, {3.589525263745028*^9, 
   3.5895252683731823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"for", " ", "testing"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SFV", "[", "expr_", "]"}], ":=", 
    RowBox[{
     RowBox[{"SmartFreeVars", "[", "expr", "]"}], "\[Intersection]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "k", ",", "i", ",", "\[Kappa]", ",", "\[Nu]"}], 
      "}"}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.588506317297718*^9, 3.5885063570719843`*^9}, {
  3.588577592534828*^9, 3.588577599754116*^9}, {3.58987103770714*^9, 
  3.589871039991735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmartHasVar", "[", 
   RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"MemberQ", "[", 
   RowBox[{
    RowBox[{"SmartFreeVars", "[", "expr", "]"}], ",", "var"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.588572482574757*^9, 3.588572563672173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BreakSecretExp", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"expr", "/.", 
     RowBox[{
      RowBox[{"SecretExp", "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{"SecretExp", "[", 
       RowBox[{"Expand", "[", "e", "]"}], "]"}]}]}], "]"}], "//.", 
   RowBox[{
    RowBox[{"SecretExp", "[", 
     RowBox[{"a_", "+", "b_"}], "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"SecretExp", "[", "a", "]"}], 
     RowBox[{"SecretExp", "[", "b", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.588583052637773*^9, 3.588583083142397*^9}, {
  3.588583182677309*^9, 3.588583192459605*^9}, {3.588583231351254*^9, 
  3.588583275401188*^9}, {3.588583322285405*^9, 3.5885833332901373`*^9}, {
  3.592193707480954*^9, 3.592193770459305*^9}, {3.592193840484404*^9, 
  3.592193850508988*^9}, {3.592194695370613*^9, 3.5921947060630503`*^9}, {
  3.592194847134078*^9, 3.59219485933918*^9}, {3.59219489785669*^9, 
  3.592194900472681*^9}, {3.592194936091411*^9, 3.5921949730856133`*^9}, {
  3.592195029328497*^9, 3.592195036025135*^9}, {3.592195254754141*^9, 
  3.5921952696862392`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sspSplitByIndex", "=", 
   RowBox[{
    RowBox[{"SecretSum", "[", 
     RowBox[{"body_", ",", " ", "ranges__", ",", " ", "range_"}], "]"}], " ", 
    "\[RuleDelayed]", 
    RowBox[{"SecretSum", "[", 
     RowBox[{
      RowBox[{"SecretSum", "[", 
       RowBox[{"body", ",", " ", "range"}], "]"}], ",", " ", "ranges"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sspSingleTermSum", "=", 
   RowBox[{
    RowBox[{"SecretSum", "[", 
     RowBox[{"body_", ",", 
      RowBox[{"{", 
       RowBox[{"var_", ",", "from_", ",", "to_"}], "}"}]}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"body", "/.", 
       RowBox[{"var", "\[Rule]", "from"}]}], ")"}], "/;", 
     RowBox[{"from", "===", "to"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sspCollectConstantFactor", "=", 
   RowBox[{
    RowBox[{"SecretSum", "[", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ",", 
      RowBox[{"{", 
       RowBox[{"var_", ",", "from_", ",", "to_"}], "}"}]}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"a", " ", 
      RowBox[{"SecretSum", "[", 
       RowBox[{"b", ",", 
        RowBox[{"{", 
         RowBox[{"var", ",", "from", ",", "to"}], "}"}]}], "]"}]}], "/;", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"a", ",", "var"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sspSplitAddition", "=", 
   RowBox[{
    RowBox[{"SecretSum", "[", 
     RowBox[{
      RowBox[{"a_", "+", "b_"}], ",", "range_"}], "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"SecretSum", "[", 
      RowBox[{"a", ",", "range"}], "]"}], "+", 
     RowBox[{"SecretSum", "[", 
      RowBox[{"b", ",", "range"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SecretSumBodyExpand", "[", "expr_", "]"}], ":=", 
  "expr"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SecretSumBodyExpand", "[", 
   RowBox[{"SecretSum", "[", 
    RowBox[{"body_", ",", "range_"}], "]"}], "]"}], ":=", 
  RowBox[{"SecretSum", "[", 
   RowBox[{
    RowBox[{"Expand", "[", "body", "]"}], ",", "range"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.592197510937057*^9, 3.59219773947659*^9}, {
   3.592197898019985*^9, 3.592197900270494*^9}, {3.592197969960916*^9, 
   3.592197973091372*^9}, 3.592198042639797*^9, {3.592198284135542*^9, 
   3.592198306752652*^9}, {3.592198412498547*^9, 3.5921984645750513`*^9}, 
   3.592198639543337*^9, {3.592455755335923*^9, 3.592455769816985*^9}, 
   3.593950566412766*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "SecretSumPreprocess", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SecretSumPreprocess", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"skipVars_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"firstPass", ",", "maskedFirstPass", ",", "secondPass"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"firstPass", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BreakSecretExp", "[", 
          RowBox[{"expr", "//.", 
           RowBox[{
            RowBox[{"Exp", "[", "e_", "]"}], "\[RuleDelayed]", 
            RowBox[{"SecretExp", "[", "e", "]"}]}]}], "]"}], "//.", 
         "sspSplitByIndex"}], "//.", "sspSingleTermSum"}], "//.", 
       "sspCollectConstantFactor"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"maskedFirstPass", "=", 
      RowBox[{"firstPass", "//.", 
       RowBox[{
        RowBox[{"SecretSum", "[", 
         RowBox[{"body_", ",", 
          RowBox[{"range", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Alternatives", "@@", "skipVars"}], ",", "_", ",", "_"}],
             "}"}]}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{"HiddenSecretSum", "[", 
         RowBox[{"body", ",", "range"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"secondPass", "=", 
      RowBox[{
       RowBox[{"MapAll", "[", 
        RowBox[{"SecretSumBodyExpand", ",", "maskedFirstPass"}], "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{"sspCollectConstantFactor", ",", "sspSplitAddition"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"secondPass", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SecretExp", "\[Rule]", "Exp"}], ",", 
        RowBox[{"HiddenSecretSum", "\[Rule]", "SecretSum"}]}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{"SecretSumPreprocess", "[", 
   RowBox[{
    RowBox[{"SecretSum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "a", "]"}], "+", 
       RowBox[{"f", "[", "b", "]"}], "+", 
       RowBox[{"f", "[", "c", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "na"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "nb"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nc"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5921967354069223`*^9, 3.592196782372096*^9}, {
   3.5921987819836473`*^9, 3.592198834391181*^9}, {3.592198869401477*^9, 
   3.59219896652896*^9}, {3.592199038244713*^9, 3.5921990392226753`*^9}, {
   3.592377331567109*^9, 3.5923773381678057`*^9}, {3.592827513125885*^9, 
   3.592827553957038*^9}, {3.5928276055858927`*^9, 3.592827773670669*^9}, 
   3.5928280932065897`*^9, {3.593324369058975*^9, 3.593324374325385*^9}, {
   3.593944832069908*^9, 3.593944870936244*^9}, {3.593944973796483*^9, 
   3.5939449757874203`*^9}, 3.593945129477622*^9, {3.593945843386878*^9, 
   3.593945848823358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmartSimplify", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"assumptions_:", "True"}], ",", 
    RowBox[{"sfunction_:", "Simplify"}]}], "]"}], ":=", 
  RowBox[{"Collect", "[", 
   RowBox[{"expr", ",", "_coeff", ",", 
    RowBox[{
     RowBox[{"sfunction", "[", 
      RowBox[{"#", ",", "assumptions"}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5939482787046957`*^9, 3.593948316254621*^9}, {
   3.5939513123387814`*^9, 3.5939513156454887`*^9}, {3.5939513912833977`*^9, 
   3.59395140048269*^9}, 3.593951471420307*^9, {3.593951728831118*^9, 
   3.593951758470796*^9}, {3.5943655518783903`*^9, 3.594365556810923*^9}, {
   3.594365608476467*^9, 3.5943656161062107`*^9}, {3.594365799285306*^9, 
   3.594365801922936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InnerSumElimination", "[", "sumExpr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"sumExpr", "/.", 
    RowBox[{
     RowBox[{"SecretSum", "[", 
      RowBox[{
       RowBox[{"body_", "/;", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"body", ",", "SecretSum"}], "]"}]}], ",", "range_"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"body", ",", "range"}], "]"}], ",", "_coeff", ",", "Factor"}],
       "]"}]}]}], "//.", 
   RowBox[{"Sum", "\[Rule]", "SecretSum"}]}]}]], "Input",
 CellChangeTimes->{{3.590478183722967*^9, 3.5904782175572863`*^9}, {
   3.5904782778565474`*^9, 3.590478342572274*^9}, {3.590478404873382*^9, 
   3.590478452273397*^9}, {3.590478484552125*^9, 3.590478502434218*^9}, {
   3.5904788596397743`*^9, 3.59047887416931*^9}, {3.590755800180409*^9, 
   3.590755834043743*^9}, 3.590756106739772*^9, {3.590822317395357*^9, 
   3.590822327262958*^9}, {3.590822417351614*^9, 3.590822461311454*^9}, {
   3.590823708942101*^9, 3.590823710391349*^9}, {3.590898117942184*^9, 
   3.590898171645419*^9}, {3.59135136676116*^9, 3.591351371360963*^9}, {
   3.592191711376891*^9, 3.5921917172894907`*^9}, {3.59395176688408*^9, 
   3.593951769440681*^9}, 3.593953574988637*^9, {3.593954646741468*^9, 
   3.593954647001302*^9}, {3.593955244020069*^9, 3.59395530608031*^9}, {
   3.593955344006885*^9, 3.593955368522496*^9}, {3.593955400466016*^9, 
   3.593955463837627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FastSimplify", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"assumptions_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"expr", ",", "assumptions", ",", 
      RowBox[{"TimeConstraint", "\[Rule]", "2"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Simplify", "::", "time"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5908211004099617`*^9, 3.590821124556831*^9}, {
   3.5908211891814327`*^9, 3.590821198790003*^9}, {3.592120639778483*^9, 
   3.592120656342361*^9}, {3.592120820600313*^9, 3.592120820776861*^9}, {
   3.592120870727477*^9, 3.592120877338121*^9}, {3.592128072938739*^9, 
   3.592128090939815*^9}, {3.592128143457312*^9, 3.592128144313401*^9}, {
   3.5939439751841097`*^9, 3.593944000022417*^9}, 3.593950342397543*^9, 
   3.593950413345277*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"ReplaceSubexpr", ",", "ReplaceSubexprStep"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReplaceSubexprStep", "[", 
   RowBox[{
    RowBox[{"exprWithSubs", ":", 
     RowBox[{"{", 
      RowBox[{"subs_List", ",", "expr_"}], "}"}]}], ",", 
    RowBox[{"except_:", "Null"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "subexprs", ",", "subexpr", ",", "subexprName", ",", "newExprWithSubs"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"subexprs", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Level", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Except", "[", "except", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"subexprs", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"subs", ",", "expr"}], "}"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subexpr", "=", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Tally", "[", "subexprs", "]"}], ",", "WeightFunction"}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subexprName", "=", 
      RowBox[{"MySym", "[", 
       RowBox[{"\"\<subexpr\>\"", ",", 
        RowBox[{
         RowBox[{"Length", "[", "subs", "]"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newExprWithSubs", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"subs", ",", 
          RowBox[{"subexprName", "\[Rule]", "subexpr"}]}], "]"}], ",", 
        RowBox[{"expr", "/.", 
         RowBox[{"subexpr", "\[Rule]", "subexprName"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Replacement: \>\"", ",", 
         RowBox[{"subexprName", "\[Rule]", "subexpr"}], ",", "\"\< (\>\"", 
         ",", 
         RowBox[{
          RowBox[{"LeafCount", "[", "exprWithSubs", "]"}], "\[Rule]", 
          RowBox[{"LeafCount", "[", "newExprWithSubs", "]"}]}], ",", 
         "\"\<)\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"LeafCount", "[", "newExprWithSubs", "]"}], 
         RowBox[{"LeafCount", "[", "exprWithSubs", "]"}]], "<", "0.9"}], ",", 
       "newExprWithSubs", ",", "exprWithSubs"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReplaceSubexpr", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"except_:", "Null"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "Case", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Case", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "newExpr_"}], "}"}], "]"}], ":=", 
      RowBox[{"newExpr", "/;", 
       RowBox[{"SameQ", "[", 
        RowBox[{"newExpr", ",", "expr"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Case", "[", "newExpr_", "]"}], ":=", 
      RowBox[{"SecretWith", "@@", "newExpr"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Case", "[", 
      RowBox[{"FixedPoint", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceSubexprStep", "[", 
          RowBox[{"#", ",", "except"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "expr"}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.5943785378462687`*^9, 3.5943785710122213`*^9}, {
   3.5943786030360603`*^9, 3.594378745759613*^9}, {3.59438144020757*^9, 
   3.594381486113394*^9}, {3.594381521333989*^9, 3.594381624350679*^9}, {
   3.594381660140462*^9, 3.594381669029087*^9}, {3.594382866564995*^9, 
   3.594382971565523*^9}, {3.5943831030614233`*^9, 3.594383127729127*^9}, {
   3.5943831861120253`*^9, 3.59438319373636*^9}, {3.594383232155562*^9, 
   3.594383363007071*^9}, {3.5943833938423557`*^9, 3.5943834638418303`*^9}, {
   3.594383561777915*^9, 3.5943836067511663`*^9}, {3.594383709959876*^9, 
   3.594383714304105*^9}, {3.594383967182276*^9, 3.594383989120584*^9}, {
   3.5943840503949337`*^9, 3.594384158630765*^9}, {3.594384260470294*^9, 
   3.59438427117719*^9}, {3.594384307720014*^9, 3.594384558449936*^9}, 
   3.5943846574202127`*^9, {3.5943847290182953`*^9, 3.594384742143951*^9}, {
   3.594384839614271*^9, 3.594384843444989*^9}, {3.5943848763131332`*^9, 
   3.594384880612052*^9}, {3.594384955188933*^9, 3.594384975786057*^9}, {
   3.5943852619110947`*^9, 3.594385328561337*^9}, {3.594385362620617*^9, 
   3.594385440083089*^9}, 3.594386134723915*^9, {3.5943863748485737`*^9, 
   3.5943865428755083`*^9}, {3.594386622743026*^9, 3.594386745306604*^9}, {
   3.594475435594626*^9, 3.594475456146409*^9}, {3.594555590878064*^9, 
   3.594555607629428*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "SubexprSimplify", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SubexprSimplify", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"assumptions_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"#", ",", "assumptions"}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ReplaceSubexpr", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"_\[CapitalPsi]", "|", "_b", "|", 
         RowBox[{"Exp", "[", "_", "]"}]}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"SecretWith", "[", 
        RowBox[{"subs_", ",", "body_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"SecretWith", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MapAt", "[", 
            RowBox[{"f", ",", "#", ",", "2"}], "]"}], "&"}], "/@", "subs"}], 
         ",", 
         RowBox[{"f", "[", "body", "]"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.594385112648199*^9, 3.594385133310957*^9}, {
  3.594385208989955*^9, 3.5943852193564177`*^9}, {3.594385520454331*^9, 
  3.594385522307043*^9}, {3.59438616068102*^9, 3.594386162950344*^9}, {
  3.594386215438077*^9, 3.5943862207348022`*^9}, {3.594386286593637*^9, 
  3.5943863549004793`*^9}, {3.594386633059846*^9, 3.5943866356491127`*^9}, {
  3.594386762562962*^9, 3.5943868025540123`*^9}, {3.594387890957076*^9, 
  3.594387897231303*^9}, {3.594446762655101*^9, 3.594446771960655*^9}, {
  3.594447576737135*^9, 3.594447649897771*^9}, {3.594475492841724*^9, 
  3.594475546400716*^9}, {3.594558655623019*^9, 3.594558729443404*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceSubexpr", "[", 
   RowBox[{"expr", ",", 
    RowBox[{"_\[CapitalPsi]", "|", "_b", "|", 
     RowBox[{"Exp", "[", "_", "]"}]}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"SecretWith", "[", 
    RowBox[{"subs_", ",", "body_"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"SecretWith", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MapAt", "[", 
       RowBox[{"Simplify", ",", "#", ",", "2"}], "]"}], "&"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{",", "assumptions"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.594558548580551*^9, 3.59455864878837*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"RangeToCondition", "[", 
   RowBox[{"range_", ",", "ranges__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RangeToCondition", "[", "range", "]"}], "\[And]", 
   RowBox[{"RangeToCondition", "[", "ranges", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.59047572068954*^9, 3.590475803919813*^9}, {
  3.5904764408594646`*^9, 3.5904764418901253`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"RangeToAssumptions", ",", "RangesToAssumptions"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeToAssumptions", "[", 
   RowBox[{"var_", ",", "from_", ",", "to_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"var", "\[Equal]", "from"}], "/;", 
   RowBox[{"from", "\[Equal]", "to"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeToAssumptions", "[", 
   RowBox[{"var_", ",", "from_Max", ",", "to_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RangeToAssumptions", "[", 
     RowBox[{"var", ",", "#", ",", "to"}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{"And", "@@", "from"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeToAssumptions", "[", 
   RowBox[{"var_", ",", "from_", ",", "to_Min"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RangeToAssumptions", "[", 
     RowBox[{"var", ",", "from", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{"And", "@@", "to"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangeToAssumptions", "[", 
   RowBox[{"var_", ",", "from_", ",", "to_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"from", "\[LessEqual]", "var"}], "\[And]", 
   RowBox[{"var", "\[LessEqual]", "to"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangesToAssumptions", "[", 
   RowBox[{"ranges", ":", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}]}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"And", "@@", 
    RowBox[{"RangeToAssumptions", "@@@", 
     RowBox[{"{", "ranges", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangesToAssumptions", "[", 
   RowBox[{"{", 
    RowBox[{"v", ",", "min", ",", "max"}], "}"}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangesToAssumptions", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v1", ",", "min1", ",", "max1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"v2", ",", "min2", ",", "max2"}], "}"}]}], "]"}], "//", 
  "Test"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RangesToAssumptions", "[", 
   RowBox[{"{", 
    RowBox[{"v", ",", 
     RowBox[{"Max", "[", 
      RowBox[{"1", ",", "min"}], "]"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{"1", ",", "max"}], "]"}]}], "}"}], "]"}], "//", 
  "Test"}]}], "Input",
 CellChangeTimes->{{3.5941068096260347`*^9, 3.594106835999338*^9}, {
   3.5941078908111343`*^9, 3.594108232749001*^9}, {3.5941082781528263`*^9, 
   3.594108303744133*^9}, {3.594108476838629*^9, 3.594108697481865*^9}, {
   3.594108746173253*^9, 3.594108857569519*^9}, {3.594108890975295*^9, 
   3.594108924779619*^9}, {3.594108977396914*^9, 3.594109024051914*^9}, {
   3.594109057348178*^9, 3.594109180819387*^9}, {3.594109227586738*^9, 
   3.594109233398982*^9}, 3.594369316352271*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SimplifyMaxAndMin", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"assumptions_:", "True"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"expr", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", ":", 
        RowBox[{"_Max", "|", "_Min"}]}], ")"}], "\[RuleDelayed]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"m", ",", "assumptions"}], "]"}]}]}], ")"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"head", ":", 
         RowBox[{"Max", "|", "Min"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"a_", "+", "b_"}], ",", 
        RowBox[{"a_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"a", "+", 
       RowBox[{"head", "[", 
        RowBox[{"b", ",", "c"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"head", ":", 
         RowBox[{"Max", "|", "Min"}]}], ")"}], "[", 
       RowBox[{"a_", ",", 
        RowBox[{"a_", "+", "b_"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"a", "+", 
       RowBox[{"head", "[", 
        RowBox[{"0", ",", "b"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"head", ":", 
         RowBox[{"Max", "|", "Min"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"i_Integer", "+", "b_"}], ",", 
        RowBox[{"j_Integer", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "<", "j"}], ",", 
        RowBox[{"i", "+", 
         RowBox[{"head", "[", 
          RowBox[{"b", ",", 
           RowBox[{"j", "-", "i", "+", "c"}]}], "]"}]}], ",", 
        RowBox[{"j", "+", 
         RowBox[{"head", "[", 
          RowBox[{
           RowBox[{"i", "-", "j", "+", "b"}], ",", "c"}], "]"}]}]}], 
       "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"SimplifyMaxAndMin", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"3", ",", 
       RowBox[{"2", "-", "j", "+", "k", "+", "\[Nu]"}], ",", 
       RowBox[{"2", "+", "\[Nu]"}]}], "]"}], ",", 
     RowBox[{"\[Nu]", ">", "0"}]}], "]"}], ",", 
   RowBox[{"2", "+", "\[Nu]", "+", 
    RowBox[{"Max", "[", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", "j"}], "+", "k"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.594465956422825*^9, 3.594465969246228*^9}, {
   3.5944660846843233`*^9, 3.594466161245472*^9}, {3.594466202888051*^9, 
   3.5944665156715183`*^9}, {3.594466570715044*^9, 3.5944666145570297`*^9}, {
   3.59446669364963*^9, 3.5944667387866983`*^9}, {3.594466790548472*^9, 
   3.594466802383561*^9}, {3.594466986079803*^9, 3.594466996204558*^9}, {
   3.594467120491737*^9, 3.594467178123273*^9}, {3.5944672129642344`*^9, 
   3.594467271584858*^9}, {3.59446733247123*^9, 3.594467429326573*^9}, 
   3.5944675562831373`*^9, 3.594467892143063*^9, {3.5944686877541924`*^9, 
   3.5944687167948217`*^9}, {3.594468946150282*^9, 3.594469047219282*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SimplifyMaxAndMin", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"assumptions_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"maxAndMins", ",", "simplifiedMaxAndMins"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxAndMins", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"_Max", "|", "_Min"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
       "Union"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"simplifiedMaxAndMins", "=", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"maxAndMins", ",", "assumptions"}], "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"head", ":", 
             RowBox[{"Max", "|", "Min"}]}], ")"}], "[", 
           RowBox[{
            RowBox[{"a_", "+", "b_"}], ",", 
            RowBox[{"a_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"a", "+", 
           RowBox[{"head", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"head", ":", 
             RowBox[{"Max", "|", "Min"}]}], ")"}], "[", 
           RowBox[{"a_", ",", 
            RowBox[{"a_", "+", "b_"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"a", "+", 
           RowBox[{"head", "[", 
            RowBox[{"0", ",", "b"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"head", ":", 
             RowBox[{"Max", "|", "Min"}]}], ")"}], "[", 
           RowBox[{
            RowBox[{"i_Integer", "+", "b_"}], ",", 
            RowBox[{"j_Integer", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "<", "j"}], ",", 
            RowBox[{"i", "+", 
             RowBox[{"head", "[", 
              RowBox[{"b", ",", 
               RowBox[{"j", "-", "i", "+", "c"}]}], "]"}]}], ",", 
            RowBox[{"j", "+", 
             RowBox[{"head", "[", 
              RowBox[{
               RowBox[{"i", "-", "j", "+", "b"}], ",", "c"}], "]"}]}]}], 
           "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expr", "/.", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"maxAndMins", ",", "simplifiedMaxAndMins"}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"SimplifyMaxAndMin", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"3", ",", 
       RowBox[{"2", "-", "j", "+", "k", "+", "\[Nu]"}], ",", 
       RowBox[{"2", "+", "\[Nu]"}]}], "]"}], ",", 
     RowBox[{"\[Nu]", ">", "0"}]}], "]"}], ",", 
   RowBox[{"2", "+", "\[Nu]", "+", 
    RowBox[{"Max", "[", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", "j"}], "+", "k"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.594465956422825*^9, 3.594465969246228*^9}, {
   3.5944660846843233`*^9, 3.594466161245472*^9}, {3.594466202888051*^9, 
   3.5944665156715183`*^9}, {3.594466570715044*^9, 3.5944666145570297`*^9}, {
   3.59446669364963*^9, 3.5944667387866983`*^9}, {3.594466790548472*^9, 
   3.594466802383561*^9}, {3.594466986079803*^9, 3.594466996204558*^9}, {
   3.594467120491737*^9, 3.594467178123273*^9}, {3.5944672129642344`*^9, 
   3.594467271584858*^9}, {3.59446733247123*^9, 3.594467429326573*^9}, 
   3.5944675562831373`*^9, 3.594467892143063*^9, {3.5944686877541924`*^9, 
   3.5944687167948217`*^9}, {3.594468946150282*^9, 3.594469047219282*^9}, {
   3.594469584083948*^9, 3.594469682449574*^9}, {3.5944702322566633`*^9, 
   3.594470346968823*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"AssumingSimplify", ",", "AssumingSimplifyRec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumingSimplifyRec", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"SecretTable", "|", "SecretSum"}]}], ")"}], "[", 
     RowBox[{"body_", ",", "ranges__"}], "]"}], ",", "assumptions_", ",", 
    "sfunction_", ",", "multiPass_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newAssumptions", ",", "sbody"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newAssumptions", "=", 
      RowBox[{"assumptions", "\[And]", 
       RowBox[{"RangesToAssumptions", "[", "ranges", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sbody", "=", 
      RowBox[{"AssumingSimplifyRec", "[", 
       RowBox[{
       "body", ",", "newAssumptions", ",", "sfunction", ",", "multiPass"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{"multiPass", ",", "\[IndentingNewLine]", 
       RowBox[{"head", "[", 
        RowBox[{
         RowBox[{"sfunction", "[", 
          RowBox[{"sbody", ",", "newAssumptions"}], "]"}], ",", "ranges"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"head", "[", 
        RowBox[{"sbody", ",", "ranges"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumingSimplifyRec", "[", 
   RowBox[{
    RowBox[{"SecretWith", "[", 
     RowBox[{"subs_List", ",", "expr_"}], "]"}], ",", "assumptions_", ",", 
    "sfunction_", ",", "multiPass_"}], "]"}], ":=", 
  RowBox[{"SecretWith", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AssumingSimplifyRec", "[", 
          RowBox[{
          "#", ",", "assumptions", ",", "sfunction", ",", "multiPass"}], "]"}]
          , "&"}], ",", "#", ",", "2"}], "]"}], "&"}], "/@", "subs"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AssumingSimplifyRec", "[", 
     RowBox[{"expr", ",", "assumptions", ",", "sfunction", ",", "multiPass"}],
      "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumingSimplifyRec", "[", 
   RowBox[{
   "expr_", ",", "assumptions_", ",", "sfunction_", ",", "multiPass_"}], 
   "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FreeQ", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"SecretTable", "|", "SecretSum"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"sfunction", "[", 
     RowBox[{"expr", ",", "assumptions"}], "]"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      RowBox[{"AssumingSimplifyRec", "[", 
       RowBox[{"#", ",", "assumptions", ",", "sfunction", ",", "multiPass"}], 
       "]"}], "&"}], "/@", "expr"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumingSimplify", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"sfunction_:", "Simplify"}], ",", 
    RowBox[{"multiPass", ":", 
     RowBox[{"False", "|", "True"}], ":", "False"}]}], "]"}], ":=", 
  RowBox[{"AssumingSimplifyRec", "[", 
   RowBox[{"expr", ",", "True", ",", "sfunction", ",", "multiPass"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{"AssumingSimplify", "[", 
   RowBox[{
    RowBox[{"SecretSum", "[", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{"SecretSum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "a", "]"}], "+", 
          RowBox[{"f", "[", "b", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Called on \>\"", ",", 
         RowBox[{"Head", "[", "#1", "]"}], ",", "\"\< assuming \>\"", ",", 
         "#2"}], "]"}], ";", "#1"}], ")"}], "&"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.590736119779319*^9, 3.5907363755097637`*^9}, 
   3.590736472001792*^9, {3.5907369554583483`*^9, 3.590736978525839*^9}, {
   3.5907518639031057`*^9, 3.590751873650401*^9}, {3.590751908826363*^9, 
   3.5907519322683783`*^9}, {3.590751998109706*^9, 3.590752143803009*^9}, {
   3.590752227175931*^9, 3.5907522998517036`*^9}, {3.590820943466606*^9, 
   3.590821000380445*^9}, {3.590821090152129*^9, 3.59082113403293*^9}, {
   3.590821215998254*^9, 3.590821223553789*^9}, {3.590821313267888*^9, 
   3.590821322450944*^9}, {3.590898344537081*^9, 3.590898346033683*^9}, {
   3.5909003887160273`*^9, 3.590900517844542*^9}, {3.5909005673316*^9, 
   3.5909006308642187`*^9}, {3.590907614365629*^9, 3.590907627813912*^9}, {
   3.590908203917694*^9, 3.590908239766077*^9}, {3.590908273844449*^9, 
   3.590908330773217*^9}, {3.590908399137451*^9, 3.590908484818927*^9}, {
   3.590908560536862*^9, 3.5909085679988213`*^9}, {3.5923913684168873`*^9, 
   3.592391377110155*^9}, {3.592391441954693*^9, 3.592391459395878*^9}, {
   3.592391493784792*^9, 3.592391494809071*^9}, {3.592391532394936*^9, 
   3.592391598838951*^9}, {3.592391650095729*^9, 3.592391679865356*^9}, {
   3.592393041114677*^9, 3.592393091983424*^9}, 3.592393240343985*^9, {
   3.592393275845546*^9, 3.592393372536725*^9}, {3.593936197586379*^9, 
   3.5939361991879177`*^9}, {3.59393623086052*^9, 3.593936351561146*^9}, {
   3.593936460876197*^9, 3.593936484684683*^9}, {3.593946551935565*^9, 
   3.5939465597036943`*^9}, {3.594109279181797*^9, 3.594109295356964*^9}, {
   3.594362952799705*^9, 3.594362980112781*^9}, 3.59436567445019*^9, {
   3.5943687875300503`*^9, 3.594368799417328*^9}, 3.594369487158012*^9, 
   3.594373376838079*^9, {3.594374706763825*^9, 3.594374709927981*^9}, {
   3.594374770940465*^9, 3.5943747968826113`*^9}, {3.594376675878819*^9, 
   3.594376682080113*^9}, {3.594376728713696*^9, 3.5943767889704*^9}, 
   3.594376832710153*^9, 3.594382811574074*^9, {3.594385779814136*^9, 
   3.594385806298807*^9}, {3.5943858821840467`*^9, 3.5943859679160643`*^9}, {
   3.594447722748171*^9, 3.594447809054257*^9}, {3.5944478678527813`*^9, 
   3.5944478692445717`*^9}, {3.594447922905294*^9, 3.5944480059863234`*^9}, 
   3.594448064608018*^9, {3.594448313451232*^9, 3.5944483449031963`*^9}, {
   3.59444840648403*^9, 3.5944484298760433`*^9}, {3.594448499402124*^9, 
   3.594448514244524*^9}, {3.594448697713064*^9, 3.594448726314166*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion to C", "Subsection",
 CellChangeTimes->{{3.587962651829897*^9, 3.58796265526997*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteCFor", "[", 
   RowBox[{
    RowBox[{"innerLines", ":", 
     RowBox[{"{", 
      RowBox[{"_String", ".."}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"var_", ",", "from_", ",", "to_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"varName", ",", "forLine"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"varName", "=", 
      RowBox[{"SimpleExprToC", "[", "var", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"forLine", "=", 
      RowBox[{"\"\<for (int \>\"", "<>", "varName", "<>", "\"\< = \>\"", "<>", 
       RowBox[{"SimpleExprToC", "[", "from", "]"}], "<>", "\"\<; \>\"", "<>", 
       "varName", "<>", "\"\< <= \>\"", "<>", 
       RowBox[{"SimpleExprToC", "[", "to", "]"}], "<>", "\"\<; \>\"", "<>", 
       "varName", "<>", "\"\<++)\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"WriteCBlock", "[", "innerLines", "]"}], ",", "forLine"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteCFor", "[", 
   RowBox[{
    RowBox[{"innerLines", ":", 
     RowBox[{"{", 
      RowBox[{"_String", ".."}], "}"}]}], ",", "ranges__"}], "]"}], ":=", 
  RowBox[{"WriteCFor", "@@", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Most", "[", 
      RowBox[{"{", "ranges", "}"}], "]"}], ",", 
     RowBox[{"WriteCFor", "[", 
      RowBox[{"innerLines", ",", 
       RowBox[{"Last", "[", 
        RowBox[{"{", "ranges", "}"}], "]"}]}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"WriteCFor", "[", 
    RowBox[{
     RowBox[{"{", "\"\<aa\>\"", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "//", "PrintCCode"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"WriteCFor", "[", 
    RowBox[{
     RowBox[{"{", "\"\<aa\>\"", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}], "//", "PrintCCode"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.587960031941004*^9, 3.587960037208255*^9}, 
   3.5880764782536287`*^9, 3.58841196872386*^9, {3.58952655859529*^9, 
   3.589526558860338*^9}, {3.594040477890573*^9, 3.594040477917748*^9}}],

Cell["\<\
When the expression can be converted to a C expression directly:\
\>", "Text",
 CellChangeTimes->{{3.584080106485664*^9, 3.584080136011713*^9}, {
   3.5890009857878647`*^9, 3.589000986970262*^9}, 3.5890897299142237`*^9, 
   3.5938691639081907`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "ConvertToC", "]"}], "\n", 
 RowBox[{
  RowBox[{"ConvertToC", "[", 
   RowBox[{"expr_", ",", "name_String", ",", "mode_Symbol"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "names", ",", "simpleSubexprs", ",", "compositeSubexprs", ",", 
      "innerLines", ",", "finalAssignment"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"simpleSubexprs", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"List", "@@", "expr"}], ",", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"SecretSum", "|", "SecretTable", "|", "Piecewise"}]}], 
          "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"compositeSubexprs", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"List", "@@", "expr"}], ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"SecretSum", "|", "SecretTable", "|", "Piecewise"}]}], 
           "]"}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"names", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"name", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\"\<(\>\"", "|", "\"\<,\>\"", "|", "\"\< \>\"", "|", 
              "\"\<)\>\""}], "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}], "<>", 
         "\"\<P\>\"", "<>", 
         RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "compositeSubexprs", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"innerLines", "=", 
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ConvertToC", "[", 
           RowBox[{"#1", ",", "#2", ",", "Declaration"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"compositeSubexprs", ",", "names"}], "}"}]}], "]"}], "//", 
       "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalAssignment", "=", 
      RowBox[{
       RowBox[{"ConvertToC", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "expr", "]"}], "@@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Symbol", "/@", "names"}], ",", "simpleSubexprs"}], 
           "]"}]}], ",", "name", ",", "#"}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"mode", ",", "\[IndentingNewLine]", "Declaration", ",", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"AssignVarC", "[", 
           RowBox[{"name", ",", "Null", ",", "Declaration"}], "]"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"WriteCBlock", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"innerLines", ",", 
            RowBox[{"finalAssignment", "[", "Assignment", "]"}]}], "]"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"innerLines", ",", 
         RowBox[{"finalAssignment", "[", "mode", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{
     RowBox[{"Piecewise", "[", 
      RowBox[{"valCondList_", ",", 
       RowBox[{"lastVal_:", "0"}]}], "]"}], ",", "name_String", ",", 
     "mode_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "BranchToC", ",", "branches", ",", "conditions", ",", "commands", ",", 
       "main"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"conditions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"SimpleExprToC", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], "/@", 
        "valCondList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"commands", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<if (\>\"", "<>", 
           RowBox[{"conditions", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<)\>\""}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<else if (\>\"", "<>", "#", "<>", "\"\<)\>\""}], "&"}],
           "/@", 
          RowBox[{"Rest", "[", "conditions", "]"}]}], ",", 
         RowBox[{"{", "\"\<else\>\"", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BranchToC", "[", "expr_", "]"}], ":=", 
       RowBox[{"WriteCBlock", "[", 
        RowBox[{"ConvertToC", "[", 
         RowBox[{"expr", ",", "name", ",", 
          RowBox[{"mode", "/.", 
           RowBox[{"Declaration", "\[Rule]", "Assignment"}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"branches", "=", 
       RowBox[{"BranchToC", "/@", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "valCondList"}], 
          ",", "lastVal"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"main", "=", 
       RowBox[{
        RowBox[{"Riffle", "[", 
         RowBox[{"commands", ",", "branches"}], "]"}], "//", "Flatten"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"mode", ",", "\[IndentingNewLine]", "Declaration", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"ConvertToC", "[", 
           RowBox[{"Null", ",", "name", ",", "Declaration"}], "]"}], ",", 
          "main"}], "]"}], ",", "\[IndentingNewLine]", "_", ",", "main"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ConvertToC", "[", 
     RowBox[{
      RowBox[{"SecretIf", "[", 
       RowBox[{"cond_", ",", "trueExpr_", ",", "falseExpr_"}], "]"}], ",", 
      "name_String", ",", "mode_Symbol"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "BranchToC", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BranchToC", "[", 
         RowBox[{"branchSuffix_String", ",", "expr_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "branchName", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"branchName", "=", 
            RowBox[{"name", "<>", "branchSuffix"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"WriteCBlock", "[", 
            RowBox[{"Append", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ConvertToC", "[", 
               RowBox[{"expr", ",", "branchName", ",", "Declaration"}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"AssignVarC", "[", 
               RowBox[{"name", ",", 
                RowBox[{"Symbol", "[", "branchName", "]"}], ",", 
                RowBox[{"mode", "/.", 
                 RowBox[{"Declaration", "\[Rule]", "Assignment"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{"mode", ",", "Declaration", ",", 
           RowBox[{"{", 
            RowBox[{"AssignVarC", "[", 
             RowBox[{"name", ",", "Null", ",", "Declaration"}], "]"}], "}"}], 
           ",", "_", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<if (\>\"", "<>", 
           RowBox[{"SimpleExprToC", "[", "cond", "]"}], "<>", "\"\<)\>\""}], 
          "}"}], ",", 
         RowBox[{"BranchToC", "[", 
          RowBox[{"\"\<True\>\"", ",", "trueExpr"}], "]"}], ",", 
         RowBox[{"BranchToC", "[", 
          RowBox[{"\"\<False\>\"", ",", "falseExpr"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConvertToC", "[", 
   RowBox[{
    RowBox[{"SecretWith", "[", 
     RowBox[{"subs_", ",", "expr_"}], "]"}], ",", "name_String", ",", 
    "mode_Symbol"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Switch", "[", 
     RowBox[{"mode", ",", "Declaration", ",", 
      RowBox[{"AssignVarC", "[", 
       RowBox[{
        RowBox[{"name", "\[Rule]", "Null"}], ",", "Declaration"}], "]"}], ",",
       "_", ",", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"WriteCBlock", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"AssignVarC", "[", 
         RowBox[{"#", ",", "Declaration"}], "]"}], "&"}], "/@", "subs"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"AssignVarC", "[", 
       RowBox[{
        RowBox[{"name", "\[Rule]", "expr"}], ",", "mode", ",", 
        RowBox[{"Declaration", "\[Rule]", "Assignment"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"ConvertToC", "[", 
   RowBox[{
    RowBox[{"SecretSum", "[", 
     RowBox[{"expr_", ",", "ranges__"}], "]"}], ",", "name_String", ",", 
    "mode_Symbol"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sumName", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sumName", "=", 
      RowBox[{"\"\<sumI\>\"", "<>", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SimpleExprToC", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"{", "ranges", "}"}]}], ",", "\"\<I\>\""}], "]"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"mode", ",", "Declaration", ",", 
         RowBox[{"{", 
          RowBox[{"AssignVarC", "[", 
           RowBox[{"name", ",", "Null", ",", "Declaration"}], "]"}], "}"}], 
         ",", "_", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"WriteCBlock", "[", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"AssignVarC", "[", 
            RowBox[{"sumName", ",", "0", ",", "Declaration"}], "]"}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"WriteCFor", "[", 
           RowBox[{
            RowBox[{"ConvertToC", "[", 
             RowBox[{"expr", ",", "sumName", ",", "AdditionAssignment"}], 
             "]"}], ",", "ranges"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"AssignVarC", "[", 
            RowBox[{"name", ",", 
             RowBox[{"Symbol", "[", "sumName", "]"}], ",", 
             RowBox[{"mode", "/.", 
              RowBox[{"Declaration", "\[Rule]", "Assignment"}]}]}], "]"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ConvertToC", "[", 
   RowBox[{
    RowBox[{"expr_", "/;", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"SecretSum", "|", "SecretTable"}]}], "]"}]}], ",", 
    "name_String", ",", "mode_Symbol"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"AssignVarC", "[", 
    RowBox[{"name", ",", "expr", ",", "mode"}], "]"}], "}"}]}]}], "Input",
 CellChangeTimes->{
  3.589528227939643*^9, {3.589895246795148*^9, 3.5898952477184973`*^9}, {
   3.58989537229889*^9, 3.589895393735628*^9}, {3.5898954814358*^9, 
   3.589895490538156*^9}, {3.590759612189639*^9, 3.590759657036961*^9}, {
   3.590759777122121*^9, 3.590759797064686*^9}, {3.590759884641924*^9, 
   3.59075991632283*^9}, {3.590759968077661*^9, 3.590760201157525*^9}, {
   3.590760232667158*^9, 3.5907603269632273`*^9}, {3.590760382820654*^9, 
   3.590760557149949*^9}, {3.5907605895719137`*^9, 3.590760590666634*^9}, {
   3.59076062121649*^9, 3.590760675632707*^9}, {3.590760795274086*^9, 
   3.590760802562031*^9}, {3.590760869979516*^9, 3.59076087303198*^9}, {
   3.59081665014009*^9, 3.5908168357825727`*^9}, {3.590816885689145*^9, 
   3.5908170837272377`*^9}, {3.590817127714882*^9, 3.590817136193737*^9}, {
   3.5908172284597387`*^9, 3.590817236329709*^9}, {3.593869220402231*^9, 
   3.593869228518941*^9}, {3.594015761001009*^9, 3.594015770020303*^9}, {
   3.594015854076292*^9, 3.594015856214966*^9}, {3.59412649918598*^9, 
   3.594126521490419*^9}, {3.594465242065935*^9, 3.5944652703030863`*^9}, {
   3.594465307562381*^9, 3.594465510541061*^9}, {3.5944656094504747`*^9, 
   3.594465689116952*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Piecewise", "::", "pairs"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The first argument \[NoBreak]\\!\\(valCondList_\\)\
\[NoBreak] of Piecewise is not a list of pairs. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Piecewise\\\", ButtonNote -> \
\\\"Piecewise::pairs\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.596439714094819*^9, 3.596441009181972*^9, 
  3.596441151059119*^9, 3.596441183803664*^9, 3.59644296352958*^9, 
  3.596448846304368*^9, 3.596546891590798*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{"0", ",", "\"\<varA\>\"", ",", "Declaration"}], "]"}], "//", 
   "PrintCCode"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{
     RowBox[{"a", "+", "33"}], ",", "\"\<varA\>\"", ",", 
     "AdditionAssignment"}], "]"}], "//", "PrintCCode"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5830443625948277`*^9, 3.583044405730171*^9}, {
   3.58304472971165*^9, 3.5830447712151213`*^9}, {3.583045278039877*^9, 
   3.583045282679937*^9}, {3.583046319677031*^9, 3.583046432558613*^9}, 
   3.584072548060932*^9, {3.584075048286824*^9, 3.5840750770390997`*^9}, {
   3.58407517401201*^9, 3.58407517790698*^9}, {3.584076184520083*^9, 
   3.584076193036686*^9}, {3.584076575921245*^9, 3.584076578104165*^9}, {
   3.584078432538692*^9, 3.58407846311978*^9}, {3.584078494057775*^9, 
   3.584078495061015*^9}, {3.5840786993518057`*^9, 3.5840787244950323`*^9}, {
   3.584078776241949*^9, 3.5840787763657513`*^9}, {3.584079120741385*^9, 
   3.5840791427764883`*^9}, {3.584080031901312*^9, 3.584080062561215*^9}, {
   3.5840802283826103`*^9, 3.584080235857778*^9}, {3.584080964306122*^9, 
   3.584080995689498*^9}, {3.584081525777751*^9, 3.584081528403716*^9}, {
   3.584090325175468*^9, 3.5840903337795267`*^9}, {3.588074841573881*^9, 
   3.588074842468726*^9}, 3.588415671270502*^9, 3.588479970724142*^9, {
   3.589094444519352*^9, 3.589094450860402*^9}, {3.589094482260919*^9, 
   3.589094482433762*^9}, {3.58909458315023*^9, 3.589094591974029*^9}, {
   3.589526863670904*^9, 3.589526882252151*^9}, 3.589528060897928*^9, {
   3.5940404779492064`*^9, 3.594040477958982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "b"}], "}"}]}], "}"}], ",", "3"}], "]"}], ",", 
     "\"\<var\>\"", ",", "Declaration"}], "]"}], "//", "PrintCCode"}], "//", 
  "Test"}]], "Input",
 CellChangeTimes->{{3.5907606992542343`*^9, 3.59076075619235*^9}, {
   3.590760827260727*^9, 3.590760833096364*^9}, {3.590817177204104*^9, 
   3.5908171857615623`*^9}, {3.590817248842692*^9, 3.5908172507817507`*^9}, 
   3.594040477971202*^9}],

Cell[BoxData[
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{
     RowBox[{"SecretIf", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "\"\<vvv\>\"", ",", 
     "Declaration"}], "]"}], "//", "PrintCCode"}], "]"}]], "Input",
 CellChangeTimes->{{3.58407258957038*^9, 3.584072621555118*^9}, {
   3.58407266469079*^9, 3.584072772502136*^9}, {3.5840728087084513`*^9, 
   3.584073104130486*^9}, {3.584073214690155*^9, 3.584073245875849*^9}, {
   3.5840733421996393`*^9, 3.5840733478335123`*^9}, {3.5840733862858257`*^9, 
   3.584073397943241*^9}, {3.584074827321814*^9, 3.58407498571532*^9}, {
   3.584075942089579*^9, 3.58407604465208*^9}, {3.584076146659937*^9, 
   3.584076175221279*^9}, {3.584076731759426*^9, 3.584076756665053*^9}, 
   3.584076863305936*^9, {3.584076893558857*^9, 3.5840769876857023`*^9}, {
   3.584077246843691*^9, 3.584077292984104*^9}, {3.5840773236489267`*^9, 
   3.584077417500865*^9}, 3.584080060560568*^9, {3.584080340873712*^9, 
   3.584080356144133*^9}, {3.5840804321990213`*^9, 3.584080543841411*^9}, {
   3.584080710010397*^9, 3.584080713666039*^9}, {3.5840807827444153`*^9, 
   3.5840808107496223`*^9}, {3.5840813347127733`*^9, 3.58408135414566*^9}, {
   3.584081385507966*^9, 3.584081442643674*^9}, {3.5840814959871798`*^9, 
   3.584081499243846*^9}, {3.5840815417857227`*^9, 3.584081544585402*^9}, {
   3.584090251374855*^9, 3.584090315683711*^9}, {3.5840903513168707`*^9, 
   3.584090355996442*^9}, {3.584091091929117*^9, 3.584091092281082*^9}, {
   3.584091225904676*^9, 3.584091226256207*^9}, {3.584091308618079*^9, 
   3.584091390467678*^9}, {3.584245619856534*^9, 3.5842456873380957`*^9}, {
   3.5842458373374147`*^9, 3.584245842665494*^9}, {3.5842458944127274`*^9, 
   3.584246043036662*^9}, {3.584246299825491*^9, 3.584246402041232*^9}, {
   3.584246580776601*^9, 3.584246624778264*^9}, {3.584246730870989*^9, 
   3.584246788956629*^9}, 3.584246911036213*^9, {3.584246947450967*^9, 
   3.584246988600122*^9}, {3.584247082293784*^9, 3.584247082678381*^9}, {
   3.5880743868850594`*^9, 3.5880744064258833`*^9}, {3.588076587391445*^9, 
   3.588076588545652*^9}, 3.588415632914447*^9, {3.589526766832807*^9, 
   3.58952676717238*^9}, {3.5895268877813463`*^9, 3.589526901959049*^9}, {
   3.589528048462655*^9, 3.589528053762349*^9}, 3.59404047798492*^9}],

Cell[BoxData[{
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{
     RowBox[{"SecretSum", "[", 
      RowBox[{
       RowBox[{"ff", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     "\"\<varA\>\"", ",", "Declaration"}], "]"}], "//", "PrintCCode"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{
     RowBox[{"SecretSum", "[", 
      RowBox[{
       RowBox[{"ff", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     "\"\<varA\>\"", ",", "Assignment"}], "]"}], "//", "PrintCCode"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"ConvertToC", "[", 
    RowBox[{
     RowBox[{"SecretSum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ff", "[", "i", "]"}], "j"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
     "\"\<varB\>\"", ",", "AdditionAssignment"}], "]"}], "//", "PrintCCode"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.58407258957038*^9, 3.584072621555118*^9}, {
   3.58407266469079*^9, 3.584072772502136*^9}, {3.5840728087084513`*^9, 
   3.584073104130486*^9}, {3.584073214690155*^9, 3.584073245875849*^9}, {
   3.5840733421996393`*^9, 3.5840733478335123`*^9}, {3.5840733862858257`*^9, 
   3.584073397943241*^9}, {3.584074827321814*^9, 3.58407498571532*^9}, {
   3.584075942089579*^9, 3.58407604465208*^9}, {3.584076146659937*^9, 
   3.584076175221279*^9}, {3.584076731759426*^9, 3.584076756665053*^9}, 
   3.584076863305936*^9, {3.584076893558857*^9, 3.5840769876857023`*^9}, {
   3.584077246843691*^9, 3.584077292984104*^9}, {3.5840773236489267`*^9, 
   3.584077417500865*^9}, 3.584080060560568*^9, {3.584080340873712*^9, 
   3.584080356144133*^9}, {3.5840804321990213`*^9, 3.584080543841411*^9}, {
   3.584080710010397*^9, 3.584080713666039*^9}, {3.5840807827444153`*^9, 
   3.5840808107496223`*^9}, {3.5840813347127733`*^9, 3.58408135414566*^9}, {
   3.584081385507966*^9, 3.584081442643674*^9}, {3.5840814959871798`*^9, 
   3.584081499243846*^9}, {3.5840815417857227`*^9, 3.584081544585402*^9}, {
   3.584090251374855*^9, 3.584090315683711*^9}, {3.5840903513168707`*^9, 
   3.584090355996442*^9}, {3.584091091929117*^9, 3.584091092281082*^9}, {
   3.584091225904676*^9, 3.584091226256207*^9}, {3.584091308618079*^9, 
   3.584091390467678*^9}, {3.584245619856534*^9, 3.5842456873380957`*^9}, {
   3.5842458373374147`*^9, 3.584245842665494*^9}, {3.5842458944127274`*^9, 
   3.584246043036662*^9}, {3.584246299825491*^9, 3.584246402041232*^9}, {
   3.584246580776601*^9, 3.584246624778264*^9}, {3.584246730870989*^9, 
   3.584246788956629*^9}, 3.584246911036213*^9, {3.584246947450967*^9, 
   3.584246988600122*^9}, {3.584247082293784*^9, 3.584247082678381*^9}, {
   3.5880743868850594`*^9, 3.5880744064258833`*^9}, {3.588076587391445*^9, 
   3.588076588545652*^9}, 3.588415632914447*^9, {3.589526766832807*^9, 
   3.58952676717238*^9}, {3.5895268877813463`*^9, 3.589526901959049*^9}, {
   3.589528048462655*^9, 3.589528052321806*^9}, {3.594040477999331*^9, 
   3.5940404780170107`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SecretTableToC", "[", 
   RowBox[{"name_", ",", 
    RowBox[{"SecretTable", "[", 
     RowBox[{"expr_", ",", "ranges__"}], "]"}], ",", "mode_Symbol"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "indexes", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indexes", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"SimpleExprToC", "/@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", 
           RowBox[{"{", "ranges", "}"}]}], ")"}]}], ",", "\"\<, \>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteCFor", "[", 
      RowBox[{
       RowBox[{"ConvertToC", "[", 
        RowBox[{"expr", ",", 
         RowBox[{
         "name", "<>", "\"\<(\>\"", "<>", "indexes", "<>", "\"\<)\>\""}], ",",
          "mode"}], "]"}], ",", "ranges"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"SecretTableToC", "[", 
    RowBox[{"\"\<Matrix\>\"", ",", 
     RowBox[{"SecretTable", "[", 
      RowBox[{
       SuperscriptBox["a", "2"], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     "Assignment"}], "]"}], "//", "PrintCCode"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Test", "[", 
  RowBox[{
   RowBox[{"SecretTableToC", "[", 
    RowBox[{"\"\<Matrix\>\"", ",", 
     RowBox[{"SecretTable", "[", 
      RowBox[{
       RowBox[{"a", "+", "b"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "1", ",", "l"}], "}"}]}], "]"}], ",", 
     "AdditionAssignment"}], "]"}], "//", "PrintCCode"}], "]"}]}], "Input",
 CellChangeTimes->{{3.588075323431567*^9, 3.58807533379408*^9}, {
   3.588075399611993*^9, 3.588075402621689*^9}, {3.5880762408815813`*^9, 
   3.5880762846188917`*^9}, {3.588415083580443*^9, 3.588415087492592*^9}, 
   3.589030662139975*^9, {3.5890899522786207`*^9, 3.5890899530833683`*^9}, {
   3.589526840981163*^9, 3.589526841263796*^9}, {3.593861340682344*^9, 
   3.5938613620403843`*^9}, {3.5938615866515827`*^9, 3.593861607529237*^9}, {
   3.593861645545485*^9, 3.593861655648834*^9}, {3.594040478031105*^9, 
   3.594040478044059*^9}}],

Cell[CellGroupData[{

Cell["\<\
Optimization: precalculate exponentials\
\>", "Subsubsection",
 CellChangeTimes->{{3.593245632126966*^9, 3.593245648553714*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PsiExpSubstitution", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"expr", "//.", 
      RowBox[{
       RowBox[{"Exp", "[", "e_", "]"}], "\[RuleDelayed]", 
       RowBox[{"Exp", "[", 
        RowBox[{"Fold", "[", 
         RowBox[{"Collect", ",", "e", ",", 
          RowBox[{"Array", "[", 
           RowBox[{"\[CapitalPsi]", ",", "4"}], "]"}]}], "]"}], "]"}]}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"i_", " ", 
           RowBox[{"\[CapitalPsi]", "[", 
            RowBox[{"j_Integer", "/;", 
             RowBox[{"0", "<", "j", "<", "4"}]}], "]"}]}], "+", "a_"}], "]"}],
         "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"psiexp", "[", 
          RowBox[{"i", ",", "j"}], "]"}], " ", 
         RowBox[{"Exp", "[", "a", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", 
           RowBox[{"j_Integer", "/;", 
            RowBox[{"0", "<", "j", "<", "4"}]}], "]"}], "+", "a_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"psiexp", "[", 
          RowBox[{"1", ",", "j"}], "]"}], 
         RowBox[{"Exp", "[", "a", "]"}]}]}]}], "}"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"i_", " ", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"j_Integer", "/;", 
           RowBox[{"0", "<", "j", "<", "4"}]}], "]"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"psiexp", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"j_Integer", "/;", 
          RowBox[{"0", "<", "j", "<", "4"}]}], "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"psiexp", "[", 
        RowBox[{"1", ",", "j"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.592113473351272*^9, 3.592113490994035*^9}, {
   3.592113544417748*^9, 3.592113566115612*^9}, {3.592115245418583*^9, 
   3.592115262885494*^9}, 3.592477658225239*^9, {3.5927168184985332`*^9, 
   3.5927169197158947`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PsiExpBounds", "[", 
   RowBox[{"expr_", ",", "ranges_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"indexes", ",", "subs", ",", "values"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"indexes", "=", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"expr", ",", "_psiexp", ",", "\[Infinity]"}], "]"}], "]"}], 
        "/.", 
        RowBox[{
         RowBox[{"psiexp", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", "i"}]}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indexes", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"expr", ",", 
         RowBox[{
          RowBox[{"psiexp", "[", 
           RowBox[{"i_", ",", "_"}], "]"}], "\[RuleDelayed]", "i"}], ",", 
         "\[Infinity]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"List", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
             "ranges"}], ")"}]}]}], "]"}], ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"values", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"indexes", "/.", "#"}], "&"}], "/@", "subs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "values", "]"}], ",", 
        RowBox[{"Max", "[", "values", "]"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.592113607095277*^9, 3.592477658226152*^9, {3.59324589236578*^9, 
   3.593245902414661*^9}, {3.5932459429692183`*^9, 3.593245950489839*^9}, {
   3.596267907847764*^9, 3.596267911437911*^9}, {3.596267959026887*^9, 
   3.5962679634434767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PsiExpPrecalculation", "[", 
   RowBox[{"{", 
    RowBox[{"from_", ",", "to_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<#define psiexp(i, j) psiexp_array[3*(i - \>\"", "<>", 
     RowBox[{"SimpleExprToC", "[", "from", "]"}], "<>", 
     "\"\<) + j - 1]\>\""}], ",", "\[IndentingNewLine]", 
    "\"\<#define Psi(j) psiParam[j - 1]\>\"", ",", "\[IndentingNewLine]", 
    "\"\<const scalar h = *hParam;\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<scalar *psiexp_array = malloc(sizeof(scalar)*3*(\>\"", "<>", 
     RowBox[{"SimpleExprToC", "[", 
      RowBox[{"to", "-", "from", "+", "1"}], "]"}], "<>", "\"\<));\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"SecretTableToC", "[", 
     RowBox[{"\"\<psiexp\>\"", ",", 
      RowBox[{"SecretTable", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"h", " ", "i", " ", 
          RowBox[{"Psi", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "from", ",", "to"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
      "Assignment"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.593844472728074*^9, 3.5938444750155573`*^9}, {
  3.593846599545908*^9, 3.593846628567079*^9}, {3.593846772841917*^9, 
  3.593846782320586*^9}, {3.5962673302627687`*^9, 3.5962673443883963`*^9}, {
  3.596267389875877*^9, 3.596267402119691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PsiExpOptim", "[", 
   RowBox[{"cases_", ",", "ranges_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"psiexpExpr", ",", "bounds"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"psiexpExpr", "=", 
      RowBox[{"PsiExpSubstitution", "[", "cases", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"psiexpExpr", ",", "_Exp", ",", "\[Infinity]"}], "]"}], 
       "\[Equal]", 
       RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bounds", "=", 
      RowBox[{
       RowBox[{"PsiExpBounds", "[", 
        RowBox[{
         RowBox[{"psiexpExpr", "//.", 
          RowBox[{
           RowBox[{"SecretWith", "[", 
            RowBox[{"subs_", ",", "expr_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"expr", "//.", "subs"}], ")"}]}]}], ",", "ranges"}], 
        "]"}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<The exponents range in: \>\"", ",", "bounds"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PsiExpPrecalculation", "[", "bounds", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SecretTableToC", "[", 
          RowBox[{"\"\<MM\>\"", ",", "#", ",", "AdditionAssignment"}], "]"}], 
         "&"}], "/@", "psiexpExpr"}], ",", "\[IndentingNewLine]", 
       "\"\<free(psiexp_array);\>\"", ",", "\[IndentingNewLine]", 
       "\"\<#undef Psi\>\"", ",", "\[IndentingNewLine]", 
       "\"\<#undef psiexp\>\""}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.592113262688429*^9, 3.592113442826736*^9}, 
   3.592113489214347*^9, {3.592113584970375*^9, 3.5921136153538723`*^9}, {
   3.592113719808045*^9, 3.592113728132421*^9}, {3.59211384515913*^9, 
   3.592113860736576*^9}, {3.592117724432961*^9, 3.592117823887766*^9}, {
   3.592117856262566*^9, 3.5921179681718388`*^9}, {3.592118020703219*^9, 
   3.592118041571781*^9}, {3.5921182255082493`*^9, 3.5921182343129873`*^9}, {
   3.592118330866212*^9, 3.5921183438673677`*^9}, {3.5921184065692263`*^9, 
   3.592118448583144*^9}, {3.592118485622418*^9, 3.5921184887508793`*^9}, {
   3.592118914283729*^9, 3.59211891496808*^9}, {3.592130971969338*^9, 
   3.592130972631146*^9}, 3.5924596519360313`*^9, 3.592460091951784*^9, {
   3.592460159498185*^9, 3.592460198134227*^9}, 3.5924602398805313`*^9, {
   3.5924603364789543`*^9, 3.5924604117158327`*^9}, {3.592461011569317*^9, 
   3.59246103872958*^9}, 3.592461076877573*^9, 3.592461125257596*^9, 
   3.592477658227866*^9, {3.5924793493825607`*^9, 3.592479349712426*^9}, {
   3.592479398794931*^9, 3.5924793997385473`*^9}, {3.59248072153885*^9, 
   3.5924807758510313`*^9}, 3.5932461191135817`*^9, {3.593246248873275*^9, 
   3.593246264378871*^9}, {3.593252795940598*^9, 3.593252798897641*^9}, {
   3.593868639399702*^9, 3.593868683182226*^9}, {3.594475318608774*^9, 
   3.59447532227595*^9}, 3.594555722637292*^9, {3.596267349555101*^9, 
   3.596267360101742*^9}, {3.5962674140049677`*^9, 3.5962674227821074`*^9}, {
   3.596267766805995*^9, 3.5962677686560307`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute cases M0", "Subsection",
 CellChangeTimes->{{3.589267885933745*^9, 3.589267890372135*^9}, {
  3.5898661631222887`*^9, 3.589866182885221*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"6", "\[LessEqual]", "q", "\[LessEqual]", 
     RowBox[{"n", "-", "2"}]}], "\[And]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "n", "|", "q", "|", "j", "|", "k", "|", "\[Nu]", "|", "\[Kappa]", "|", 
       "i"}], ")"}], "\[Element]", "Integers"}], "\[And]", 
    RowBox[{"(", 
     RowBox[{"And", "@@", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", "#", "]"}], "<", "0"}], "&"}], ",", 
        "4"}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5962891096524563`*^9, 3.596289128535247*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m0CornerMom4", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "-", "\[Nu]"}], ",", 
        RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0CornerMom4R", "=", 
   RowBox[{"RefineCase", "/@", "m0CornerMom4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0CornerRawSums", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0CornerMom4R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SecretTable", "[", 
        RowBox[{
         RowBox[{"SecretSum", "[", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["a", "0"], 
            RowBox[{"b", "[", "\[Kappa]", "]"}], " ", 
            RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"SecretTable", "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["a", "0"], "2"], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "nel", " ", "sorensen", " ", "non", " ", "ci", " ", "sono", " ", "i", 
      " ", "termini", " ", "costanti"}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.58971237949895*^9, 3.589712449016384*^9}, {
  3.589866953008628*^9, 3.589866975385639*^9}, {3.592485004940815*^9, 
  3.592485044319708*^9}, {3.592485133567277*^9, 3.592485145771131*^9}, {
  3.592485375880477*^9, 3.592485414243001*^9}, {3.592485445733975*^9, 
  3.5924855871862783`*^9}, {3.592485651927944*^9, 3.59248570242412*^9}, {
  3.592486906446311*^9, 3.592486907506012*^9}, {3.592487141110491*^9, 
  3.59248714461236*^9}, {3.592650291866372*^9, 3.592650299298856*^9}, {
  3.5934273719290543`*^9, 3.593427379922143*^9}, {3.593429713546239*^9, 
  3.593429737345127*^9}, {3.59343181381649*^9, 3.593431819134101*^9}, {
  3.5934320485436687`*^9, 3.5934320507360153`*^9}}],

Cell["righe e colonne sembrano scambiate", "Text",
 CellChangeTimes->{{3.592650291372273*^9, 3.592650322841311*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m0ColumnMom6", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "-", "\[Nu]"}], ",", 
        RowBox[{"r", "+", "i", "-", "\[Kappa]"}], ",", 
        RowBox[{"r", "-", "j"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0ColumnMom4A", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "-", "j"}], ",", 
        RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0ColumnMom4B", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "-", "j"}], ",", 
        RowBox[{"r", "-", "\[Kappa]"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0ColumnMom6R", "=", 
   RowBox[{"RefineCase", "/@", "m0ColumnMom6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0ColumnMom4AR", "=", 
   RowBox[{"RefineCase", "/@", "m0ColumnMom4A"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0ColumnMom4BR", "=", 
   RowBox[{"RefineCase", "/@", "m0ColumnMom4B"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0ColumnRawSums", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0ColumnMom6R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0ColumnMom4AR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "\[Kappa]", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0ColumnMom4BR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "\[Kappa]", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"SecretTable", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["a", "0"], "2"], 
         RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}], "}"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{"nel", " ", "sorensen", " ", 
      RowBox[{"c", "'"}], 
      RowBox[{"e", "'"}], " ", "un", " ", "meno", " ", "qui"}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592486843319037*^9, 3.59248685123497*^9}, {
   3.592486888780046*^9, 3.5924869900743933`*^9}, {3.592487029440874*^9, 
   3.5924871730976973`*^9}, {3.592487206457032*^9, 3.592487308939755*^9}, {
   3.592487368288991*^9, 3.59248738193534*^9}, 3.592487416396639*^9, {
   3.592489336219454*^9, 3.592489338847542*^9}, {3.592491080884576*^9, 
   3.592491085472124*^9}, {3.593427429421413*^9, 3.593427455475759*^9}, 
   3.593427725678548*^9, {3.593429680463808*^9, 3.5934297063181877`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m0RowMom6", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "+", "i", "-", "k"}], ",", 
        RowBox[{"r", "-", "\[Nu]"}], ",", 
        RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0RowMom4A", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "-", "\[Nu]"}], ",", 
        RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0RowMom4B", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "-", "k"}], ",", 
        RowBox[{"r", "-", "\[Nu]"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0RowMom6R", "=", 
   RowBox[{"RefineCase", "/@", "m0RowMom6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0RowMom4AR", "=", 
   RowBox[{"RefineCase", "/@", "m0RowMom4A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0RowMom4BR", "=", 
   RowBox[{"RefineCase", "/@", "m0RowMom4B"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0RowRawSums", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0RowMom6R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0RowMom4AR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "\[Nu]", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0RowMom4BR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "\[Nu]", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"SecretTable", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["a", "0"], "2"], 
         RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "q"}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592486843319037*^9, 3.59248685123497*^9}, {
   3.592486888780046*^9, 3.5924869900743933`*^9}, {3.592487029440874*^9, 
   3.5924871730976973`*^9}, {3.592487206457032*^9, 3.592487308939755*^9}, {
   3.592487368288991*^9, 3.59248738193534*^9}, 3.592487416396639*^9, {
   3.592488859030415*^9, 3.5924888685059233`*^9}, {3.5924889703268538`*^9, 
   3.592489025145393*^9}, {3.5924892999537086`*^9, 3.59248932710832*^9}, {
   3.59249109661792*^9, 3.592491101373228*^9}, {3.5934231792420597`*^9, 
   3.593423214302877*^9}, {3.5934232702704697`*^9, 3.593423273545375*^9}, {
   3.5934296005628757`*^9, 3.593429632143784*^9}, {3.593431379944029*^9, 
   3.593431401544265*^9}, {3.593431933310072*^9, 3.593431937653809*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CasesToSums", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"True", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "r", "}"}], "}"}]}], "}"}], "}"}], ",", 
    SuperscriptBox[
     SubscriptBox["a", "0"], "2"], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "k"}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.593423514164711*^9, 3.593423585533456*^9}, {
  3.5934314601930923`*^9, 3.5934315142358503`*^9}, {3.593431550465901*^9, 
  3.593431563596711*^9}, {3.593500911724601*^9, 3.593500938477396*^9}, {
  3.596175458036718*^9, 3.596175460692905*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m0mom4", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "-", "j"}], ",", 
        RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], "/.", 
      RowBox[{"i", "\[Rule]", "0"}]}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"m0mom6A", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "+", "i", "-", "\[Nu]"}], ",", 
          RowBox[{"r", "-", "j"}], ",", 
          RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], "/.", 
        RowBox[{"i", "\[Rule]", "0"}]}], ",", 
       RowBox[{
        RowBox[{"1", "<", "q"}], "&&", 
        RowBox[{
         RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<m0mom6A_cases\>\""}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"m0mom6B", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "-", "\[Nu]"}], ",", 
          RowBox[{"r", "-", "j"}], ",", 
          RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], "/.", 
        RowBox[{"i", "\[Rule]", "0"}]}], ",", 
       RowBox[{
        RowBox[{"1", "<", "q"}], "&&", 
        RowBox[{
         RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<m0mom6B_cases\>\""}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"m0mom8", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "-", "\[Nu]"}], ",", 
          RowBox[{"r", "+", "i", "-", "\[Kappa]"}], ",", 
          RowBox[{"r", "-", "j"}], ",", 
          RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], "/.", 
        RowBox[{"i", "\[Rule]", "0"}]}], ",", 
       RowBox[{
        RowBox[{"1", "<", "q"}], "&&", 
        RowBox[{
         RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<m0mom8_cases\>\""}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.588416770892332*^9, 3.5884167830701313`*^9}, {
   3.588416947914268*^9, 3.588416948914249*^9}, {3.588417053065731*^9, 
   3.588417108445631*^9}, 3.588417159151445*^9, {3.5889986692270308`*^9, 
   3.588998786546341*^9}, {3.588998933937262*^9, 3.5889989405032043`*^9}, {
   3.589866674622896*^9, 3.589866700206847*^9}, {3.589866769674181*^9, 
   3.589866893481369*^9}, {3.591707199494042*^9, 3.591707244673502*^9}, {
   3.592484128039377*^9, 3.592484146411057*^9}, 3.592489657575107*^9, {
   3.593423085219242*^9, 3.5934231060401773`*^9}, {3.593426168680678*^9, 
   3.59342618683364*^9}, {3.593429800576651*^9, 3.593429809745051*^9}, {
   3.59342987291218*^9, 3.5934298878750067`*^9}, {3.593762657021803*^9, 
   3.593762664490116*^9}, {3.5943630160819798`*^9, 3.594363044450431*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m0mom4R", "=", 
   RowBox[{"RefineCase", "/@", "m0mom4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0mom6AR", "=", 
   RowBox[{"RefineCase", "/@", "m0mom6A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0mom6BR", "=", 
   RowBox[{"RefineCase", "/@", "m0mom6B"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0mom8R", "=", 
   RowBox[{"RefineCase", "/@", "m0mom8"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.58971237949895*^9, 3.589712449016384*^9}, {
   3.589866953008628*^9, 3.589866975385639*^9}, 3.592489657575583*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rawSumsM0Body", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0mom4R", ",", 
       SuperscriptBox[
        SubscriptBox["a", "0"], "2"], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0mom6AR", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        SubscriptBox["a", "0"]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "\[Nu]", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0mom6BR", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        SubscriptBox["a", "0"]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "\[Nu]", "}"}]}], "]"}], ",", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"m0mom8R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588416286480692*^9, 3.588416311855803*^9}, {
   3.588416381222664*^9, 3.588416382571664*^9}, {3.588416494788518*^9, 
   3.588416510880138*^9}, {3.588416602440465*^9, 3.588416758148245*^9}, 
   3.588417288817268*^9, {3.588417351190778*^9, 3.588417372171929*^9}, {
   3.58841936256581*^9, 3.588419389456244*^9}, {3.5889987947592993`*^9, 
   3.588998795437706*^9}, {3.5890900695563793`*^9, 3.58909008497425*^9}, {
   3.589715416338777*^9, 3.589715431497101*^9}, {3.589715556460837*^9, 
   3.589715565233494*^9}, {3.589866931916464*^9, 3.589866942501796*^9}, {
   3.589866987925144*^9, 3.5898670763111773`*^9}, 3.589867152241571*^9, {
   3.58986722811757*^9, 3.589867235196658*^9}, {3.5898711865126867`*^9, 
   3.589871200735276*^9}, {3.590132028869134*^9, 3.590132058513125*^9}, {
   3.592486247028336*^9, 3.592486265109459*^9}, {3.59248936783788*^9, 
   3.5924893685092163`*^9}, 3.592489657577383*^9, {3.593426223348051*^9, 
   3.593426223870717*^9}, {3.593429823360456*^9, 3.593429824430891*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"m0SumsRaw", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "m0CornerRawSums", ",", "m0RowRawSums", ",", "m0ColumnRawSums", ",", 
     "rawSumsM0Body"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.592485628734982*^9, 3.592485644210993*^9}, {
  3.592485715683298*^9, 3.592485722451873*^9}, {3.5924874352966413`*^9, 
  3.592487441664133*^9}, {3.592488877128016*^9, 3.5924888780922413`*^9}, {
  3.592489378681082*^9, 3.5924893792920017`*^9}, {3.594039060853479*^9, 
  3.5940390710572577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"m0SumsSimplified", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AssumingSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SmartSimplify", "[", 
           RowBox[{
            RowBox[{"SimplifyMaxAndMin", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], ",", "#2"}], "]"}], "&"}], 
         ")"}]}], "]"}], "&"}], ",", "m0SumsRaw", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<m0SumsSimplified\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59394915516969*^9, 3.593949195263674*^9}, {
   3.5939492829194813`*^9, 3.593949292257139*^9}, {3.593949724520801*^9, 
   3.5939497335617437`*^9}, {3.593950642621071*^9, 3.593950650088956*^9}, {
   3.593951819604291*^9, 3.593951825643276*^9}, {3.594011805869052*^9, 
   3.594011806153714*^9}, {3.594022956748921*^9, 3.5940229667157183`*^9}, {
   3.594039039543475*^9, 3.594039042906064*^9}, 3.594039098239087*^9, {
   3.594363085047831*^9, 3.594363085944503*^9}, 3.5944734192522793`*^9, 
   3.594475982698201*^9, {3.594539094014797*^9, 3.594539094230945*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"m0SumsSimplifiedAgainWithRepl", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AssumingSimplify", "[", 
       RowBox[{"#", ",", "SubexprSimplify"}], "]"}], "&"}], ",", 
     "m0SumsSimplified", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<m0SumsSimplifiedAgainWithRepl\>\""}],
       "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594555800597004*^9, 3.594555833400268*^9}, {
   3.5945559578163958`*^9, 3.594556021354587*^9}, {3.594556068745126*^9, 
   3.594556075102668*^9}, 3.594556311602326*^9, {3.5962674449658947`*^9, 
   3.596267445118526*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WriteCFile", "[", 
  RowBox[{"\"\<casesM0.c\>\"", ",", 
   RowBox[{"PsiExpOptim", "[", 
    RowBox[{
     RowBox[{"m0SumsSimplifiedAgainWithRepl", "/.", 
      RowBox[{"c_coeff", "\[RuleDelayed]", 
       RowBox[{"CoefficientAsVariableSym", "[", "c", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5938453374405127`*^9, 3.5938453397583437`*^9}, {
   3.593845383551839*^9, 3.593845425476089*^9}, {3.593845464722398*^9, 
   3.59384546711546*^9}, {3.593845590284258*^9, 3.593845615979258*^9}, {
   3.593845838988312*^9, 3.593845856875264*^9}, {3.594035300369665*^9, 
   3.5940353448940887`*^9}, 3.594039052965569*^9, 3.594555511491806*^9, {
   3.594555749099373*^9, 3.594555752447403*^9}, 3.594556028601461*^9, 
   3.596287319854084*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The exponents range in: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "q"}], ",", 
     RowBox[{"2", " ", "q"}]}], "}"}]}],
  SequenceForm[
  "The exponents range in: ", {(-2) $CellContext`q, 2 $CellContext`q}],
  Editable->False]], "Print",
 CellChangeTimes->{3.596439737392744*^9, 3.5964410135274067`*^9, 
  3.596441155779644*^9, 3.596441208055382*^9, 3.596442984140205*^9, 
  3.596448853323804*^9, 3.59654689588762*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute cases M", "Subsection",
 CellChangeTimes->{{3.589267885933745*^9, 3.589267890372135*^9}, {
  3.5898661631222887`*^9, 3.589866163972432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"6", "\[LessEqual]", "q"}], "\[And]", 
    RowBox[{
     RowBox[{"q", "+", "2"}], "\[LessEqual]", "n"}], "\[And]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "n", "|", "q", "|", "j", "|", "k", "|", "\[Nu]", "|", "\[Kappa]", "|", 
       "i"}], ")"}], "\[Element]", "Integers"}], "\[And]", 
    RowBox[{"(", 
     RowBox[{"And", "@@", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", "#", "]"}], "<", "0"}], "&"}], ",", 
        "4"}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594378222956285*^9, 3.594378262643579*^9}, {
  3.594387251402789*^9, 3.5943872731277723`*^9}, {3.59643758446461*^9, 
  3.596437606734189*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mnCornerMom4", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnCornerMom4R", "=", 
   RowBox[{"RefineCase", "/@", "mnCornerMom4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnCornerRawSums", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnCornerMom4R", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SecretTable", "[", 
        RowBox[{
         RowBox[{"SecretSum", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"n", "-", "q", "-", "i"}], 
             RowBox[{"n", "-", "q"}]], "2", 
            SubscriptBox["a", "0"], 
            RowBox[{"b", "[", "\[Kappa]", "]"}], " ", 
            RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"SecretTable", "[", 
        RowBox[{
         RowBox[{"SecretSum", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"n", "-", "q", "-", "i"}], 
             RowBox[{"n", "-", "q"}]], 
            SuperscriptBox[
             SubscriptBox["a", "0"], "2"]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "nel", " ", "sorensen", " ", "non", " ", "ci", " ", "sono", " ", "i", 
      " ", "termini", " ", "costanti"}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnfY93/7qvleOFm0KHiB6nZvCToX9rxw1wt/sBtPS
8wTlj7xy5LHuEgPRSuqbFEG09FoLZRB9T+ePPYhedey4C4jeWbPdA0T/+5oa
BaJ3bKxNAtEpk85mgGg9D7//INrBsABMq3QullEA0iUzhGVBdNDO6mP5QNpq
QuZxEH1hV63p66OvHI2aas1A9Kkqw6g3QNqDWzsWRG9Q2JXwFkj3eaUkgug9
qYJ1ILqgNxxMr+OWmiJ+/JXj9KLw2SB6SqfvAhDNsuvqMhDdX39luQRI/OTj
VSDauVGeWxJIH2XKBdMzZTxtQHSUkJ4tiAYAMBmaqw==
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mnColumnMom6", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}], ",", 
       RowBox[{"r", "-", "j"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnColumnMom4A", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "j"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnColumnMom4B", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "j"}], ",", 
       RowBox[{"r", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnColumnMom6R", "=", 
   RowBox[{"RefineCase", "/@", "mnColumnMom6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnColumnMom4AR", "=", 
   RowBox[{"RefineCase", "/@", "mnColumnMom4A"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnColumnMom4BR", "=", 
   RowBox[{"RefineCase", "/@", "mnColumnMom4B"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnColumnRawSums", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnColumnMom6R", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnColumnMom4AR", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnColumnMom4BR", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"SecretTable", "[", 
       RowBox[{
        RowBox[{"SecretSum", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"n", "-", "q", "-", "i"}], 
            RowBox[{"n", "-", "q"}]], 
           SuperscriptBox[
            SubscriptBox["a", "0"], "2"], 
           RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}], "}"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{"nel", " ", "sorensen", " ", 
      RowBox[{"c", "'"}], 
      RowBox[{"e", "'"}], " ", "un", " ", "meno", " ", "qui"}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592486843319037*^9, 3.59248685123497*^9}, {
   3.592486888780046*^9, 3.5924869900743933`*^9}, {3.592487029440874*^9, 
   3.5924871730976973`*^9}, {3.592487206457032*^9, 3.592487308939755*^9}, {
   3.592487368288991*^9, 3.59248738193534*^9}, 3.592487416396639*^9, {
   3.592489336219454*^9, 3.592489338847542*^9}, {3.592491080884576*^9, 
   3.592491085472124*^9}, {3.593427429421413*^9, 3.593427455475759*^9}, 
   3.593427725678548*^9, {3.593429680463808*^9, 3.5934297063181877`*^9}, {
   3.594042774654297*^9, 3.5940428611263847`*^9}, 3.594042894652027*^9, {
   3.5940447679772997`*^9, 3.59404478166011*^9}, {3.594045910239101*^9, 
   3.594045915077818*^9}, {3.594473872014256*^9, 3.594473876113188*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mnRowMom6", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "+", "i", "-", "k"}], ",", 
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnRowMom4A", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnRowMom4B", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "k"}], ",", 
       RowBox[{"r", "-", "\[Nu]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"1", "<", "q"}], "&&", 
      RowBox[{
       RowBox[{"2", "+", "q"}], "<", "n"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnRowMom6R", "=", 
   RowBox[{"RefineCase", "/@", "mnRowMom6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnRowMom4AR", "=", 
   RowBox[{"RefineCase", "/@", "mnRowMom4A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnRowMom4BR", "=", 
   RowBox[{"RefineCase", "/@", "mnRowMom4B"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnRowRawSums", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnRowMom6R", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnRowMom4AR", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnRowMom4BR", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"SecretTable", "[", 
       RowBox[{
        RowBox[{"SecretSum", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"n", "-", "q", "-", "i"}], 
            RowBox[{"n", "-", "q"}]], 
           SuperscriptBox[
            SubscriptBox["a", "0"], "2"], 
           RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "q"}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592486843319037*^9, 3.59248685123497*^9}, {
   3.592486888780046*^9, 3.5924869900743933`*^9}, {3.592487029440874*^9, 
   3.5924871730976973`*^9}, {3.592487206457032*^9, 3.592487308939755*^9}, {
   3.592487368288991*^9, 3.59248738193534*^9}, 3.592487416396639*^9, {
   3.592488859030415*^9, 3.5924888685059233`*^9}, {3.5924889703268538`*^9, 
   3.592489025145393*^9}, {3.5924892999537086`*^9, 3.59248932710832*^9}, {
   3.59249109661792*^9, 3.592491101373228*^9}, {3.5934231792420597`*^9, 
   3.593423214302877*^9}, {3.5934232702704697`*^9, 3.593423273545375*^9}, {
   3.5934296005628757`*^9, 3.593429632143784*^9}, {3.593431379944029*^9, 
   3.593431401544265*^9}, {3.593431933310072*^9, 3.593431937653809*^9}, {
   3.594043010186219*^9, 3.594043025377495*^9}, {3.594043075021442*^9, 
   3.594043079139531*^9}, {3.594043149417437*^9, 3.594043249540324*^9}, {
   3.5940447943019543`*^9, 3.5940448000006657`*^9}, {3.5940459002664557`*^9, 
   3.5940459065037613`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mnBodyMom4", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "-", "j"}], ",", 
         RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"1", "<", "q"}], "&&", 
        RowBox[{
         RowBox[{"2", "q"}], "<", "n"}]}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<mnBodyMom4\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"mnBodyMom6A", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "+", "i", "-", "\[Nu]"}], ",", 
         RowBox[{"r", "-", "j"}], ",", 
         RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"1", "<", "q"}], "&&", 
        RowBox[{
         RowBox[{"2", "q"}], "<", "n"}]}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<mnBodyMom6A\>\""}], "]"}]}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"mnBodyMom6B", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "-", "\[Nu]"}], ",", 
         RowBox[{"r", "-", "j"}], ",", 
         RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"1", "<", "q"}], "&&", 
        RowBox[{
         RowBox[{"2", "q"}], "<", "n"}]}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<mnBodyMom6B\>\""}], "]"}]}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"mnBodyMom8", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "q", "-", "1"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "-", "\[Nu]"}], ",", 
         RowBox[{"i", "+", "r", "-", "\[Kappa]"}], ",", 
         RowBox[{
          RowBox[{"-", "j"}], "+", "r"}], ",", 
         RowBox[{"i", "-", "k", "+", "r"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"1", "<", "q"}], "&&", 
        RowBox[{
         RowBox[{"2", "q"}], "<", "n"}]}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<mnBodyMom8\>\""}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.588416770892332*^9, 3.5884167830701313`*^9}, {
   3.588416947914268*^9, 3.588416948914249*^9}, {3.588417053065731*^9, 
   3.588417108445631*^9}, 3.588417159151445*^9, {3.5889986692270308`*^9, 
   3.588998786546341*^9}, {3.588998933937262*^9, 3.5889989405032043`*^9}, {
   3.590131196468029*^9, 3.590131212309362*^9}, {3.5901323560021763`*^9, 
   3.590132398803619*^9}, {3.592112649230044*^9, 3.592112691670457*^9}, {
   3.594043365954227*^9, 3.594043424907976*^9}, {3.594378336422017*^9, 
   3.594378347918722*^9}, {3.594446408475643*^9, 3.594446408680265*^9}, {
   3.59644134433405*^9, 3.5964413463948183`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mnBodyMom4R", "=", 
   RowBox[{"RefineCase", "/@", "mnBodyMom4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnBodyMom6AR", "=", 
   RowBox[{"RefineCase", "/@", "mnBodyMom6A"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnBodyMom6BR", "=", 
   RowBox[{"RefineCase", "/@", "mnBodyMom6B"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnBodyMom8R", "=", 
   RowBox[{"RefineCase", "/@", "mnBodyMom8"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.58971237949895*^9, 3.589712449016384*^9}, {
  3.590132436617025*^9, 3.590132463130525*^9}, {3.594043430208428*^9, 
  3.594043456498076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mnBodySumsRaw", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnBodyMom4R", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        SuperscriptBox[
         SubscriptBox["a", "0"], "2"]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "i", "}"}]}], "]"}], ",", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnBodyMom6AR", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        SubscriptBox["a", "0"]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnBodyMom6BR", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        SubscriptBox["a", "0"]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"mnBodyMom8R", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"n", "-", "q", "-", "i"}], 
         RowBox[{"n", "-", "q"}]], 
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594043473061874*^9, 3.594043507060935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mnSumsRaw", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "mnCornerRawSums", ",", "mnColumnRawSums", ",", "mnRowRawSums", ",", 
     "mnBodySumsRaw"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588416286480692*^9, 3.588416311855803*^9}, {
   3.588416381222664*^9, 3.588416382571664*^9}, {3.588416494788518*^9, 
   3.588416510880138*^9}, {3.588416602440465*^9, 3.588416758148245*^9}, 
   3.588417288817268*^9, {3.588417351190778*^9, 3.588417372171929*^9}, {
   3.58841936256581*^9, 3.588419389456244*^9}, {3.5889987947592993`*^9, 
   3.588998795437706*^9}, {3.5890900695563793`*^9, 3.58909008497425*^9}, {
   3.589715416338777*^9, 3.589715431497101*^9}, {3.589715556460837*^9, 
   3.589715565233494*^9}, {3.590132291906905*^9, 3.5901323354614573`*^9}, {
   3.590132466956299*^9, 3.59013248325531*^9}, {3.592456049583028*^9, 
   3.592456076190069*^9}, {3.592456117523967*^9, 3.5924561555181723`*^9}, {
   3.592456285943941*^9, 3.5924563535842857`*^9}, {3.5925479033032*^9, 
   3.592547909399096*^9}, {3.593954056217987*^9, 3.593954058213069*^9}, {
   3.594022900101976*^9, 3.5940229319810457`*^9}, {3.5940435288492107`*^9, 
   3.594043574325721*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mnSumsReduced", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"InnerSumElimination", "[", 
       RowBox[{"SecretSumPreprocess", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "\[Kappa]"}], "}"}]}], "]"}], "]"}], "&"}], 
     ",", "mnSumsRaw", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<mnSumsReduced\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593950751125306*^9, 3.5939507513857*^9}, {
   3.593951782637488*^9, 3.593951783600193*^9}, {3.593955554826735*^9, 
   3.593955555094533*^9}, {3.594011747046454*^9, 3.594011773942939*^9}, {
   3.594015680698122*^9, 3.594015681020203*^9}, {3.594022935829899*^9, 
   3.5940229436756268`*^9}, 3.594022996361918*^9, {3.594041444259631*^9, 
   3.594041449120707*^9}, 3.594041527001257*^9, {3.5940427004968033`*^9, 
   3.594042701319784*^9}, {3.594119807571929*^9, 3.59411981076796*^9}, 
   3.5944489047702713`*^9, 3.594470644587357*^9, {3.5945566431932373`*^9, 
   3.5945566434194317`*^9}, {3.596175789471033*^9, 3.596175790447706*^9}, {
   3.596176098645121*^9, 3.596176110938374*^9}, {3.596176627829054*^9, 
   3.596176628073161*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mnSumsSimplified1", "=", 
    RowBox[{"MyParallelCachedMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AssumingSimplify", "[", 
        RowBox[{"#", ",", "SmartSimplify"}], "]"}], "&"}], ",", 
      "mnSumsReduced", ",", 
      RowBox[{"MyPath", "[", 
       RowBox[{"\"\<cases\>\"", ",", "\"\<mnSumsSimplified1\>\""}], "]"}]}], 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.594471309485371*^9, 3.594471323952323*^9}, {
  3.594556685010313*^9, 3.594556685756104*^9}, {3.596176334814762*^9, 
  3.596176337073481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mnSumsSimplified", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AssumingSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SmartSimplify", "[", 
           RowBox[{
            RowBox[{"SimplifyMaxAndMin", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], ",", "#2"}], "]"}], "&"}], 
         ")"}]}], "]"}], "&"}], ",", "mnSumsReduced", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<mnSumsSimplified\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59394915516969*^9, 3.593949195263674*^9}, {
   3.5939492829194813`*^9, 3.593949292257139*^9}, {3.593949724520801*^9, 
   3.5939497335617437`*^9}, {3.593950642621071*^9, 3.593950650088956*^9}, {
   3.593951819604291*^9, 3.593951825643276*^9}, {3.594011805869052*^9, 
   3.594011806153714*^9}, {3.594022956748921*^9, 3.5940229667157183`*^9}, {
   3.594041108416267*^9, 3.594041137114272*^9}, 3.594041453614046*^9, 
   3.5940415190985813`*^9, {3.594045268232574*^9, 3.594045268439104*^9}, 
   3.594101039580412*^9, {3.5941047580770407`*^9, 3.594104758289357*^9}, {
   3.594120775094921*^9, 3.594120779818459*^9}, {3.5941300747784367`*^9, 
   3.5941300765462627`*^9}, {3.5943666927746058`*^9, 
   3.5943666929539337`*^9}, {3.594378374513329*^9, 3.594378375647709*^9}, {
   3.594382825336289*^9, 3.5943828255254707`*^9}, {3.5944489557078238`*^9, 
   3.594448956814974*^9}, {3.594469302467828*^9, 3.594469305260047*^9}, {
   3.594470415520303*^9, 3.594470455881393*^9}, {3.594556736557177*^9, 
   3.594556736827392*^9}, {3.594557193628063*^9, 3.594557196682164*^9}, 
   3.596176623690564*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mnSumsSimplifiedAgainWithRepl1", "=", 
    RowBox[{"MyParallelCachedMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AssumingSimplify", "[", 
        RowBox[{"#", ",", "SubexprSimplify"}], "]"}], "&"}], ",", 
      "mnSumsSimplified1", ",", 
      RowBox[{"MyPath", "[", 
       RowBox[{
       "\"\<cases\>\"", ",", "\"\<mnSumsSimplifiedAgainWithRepl1\>\""}], 
       "]"}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5945577323188477`*^9, 3.5945577369351807`*^9}, {
   3.596176345946412*^9, 3.596176348029204*^9}, 3.5964413480596313`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mnSumsSimplifiedAgainWithRepl", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AssumingSimplify", "[", 
       RowBox[{"#", ",", "SubexprSimplify"}], "]"}], "&"}], ",", 
     "mnSumsSimplified", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<mnSumsSimplifiedAgainWithRepl\>\""}],
       "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594555800597004*^9, 3.594555833400268*^9}, {
   3.5945559578163958`*^9, 3.594556021354587*^9}, {3.594556068745126*^9, 
   3.594556075102668*^9}, 3.594556311602326*^9, {3.594556719713553*^9, 
   3.594556726274685*^9}, {3.596176631594481*^9, 3.5961766318225307`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WriteCFile", "[", 
  RowBox[{"\"\<casesMN.c\>\"", ",", 
   RowBox[{"PsiExpOptim", "[", 
    RowBox[{
     RowBox[{"mnSumsSimplifiedAgainWithRepl", "/.", 
      RowBox[{"c_coeff", "\[RuleDelayed]", 
       RowBox[{"CoefficientAsVariableSym", "[", "c", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5938453374405127`*^9, 3.5938453397583437`*^9}, {
   3.593845383551839*^9, 3.593845425476089*^9}, {3.593845464722398*^9, 
   3.59384546711546*^9}, {3.593845590284258*^9, 3.593845615979258*^9}, {
   3.593845838988312*^9, 3.593845856875264*^9}, {3.594035300369665*^9, 
   3.5940353448940887`*^9}, 3.594035384754389*^9, {3.594035940495448*^9, 
   3.59403594090469*^9}, 3.594041127786582*^9, 3.594126888342349*^9, 
   3.594474953487094*^9, 3.59455895591494*^9, {3.59455909294106*^9, 
   3.594559113149208*^9}, 3.596287320924893*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The exponents range in: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "q"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"1", "+", "n", "-", "q"}], ",", 
       RowBox[{"4", "+", 
        RowBox[{"2", " ", "q"}]}]}], "]"}]}], "}"}]}],
  SequenceForm["The exponents range in: ", {(-3) $CellContext`q, 
    Max[1 + $CellContext`n - $CellContext`q, 4 + 2 $CellContext`q]}],
  Editable->False]], "Print",
 CellChangeTimes->{3.596441811400797*^9, 3.5964435283282824`*^9, 
  3.5964488676200323`*^9, 3.596449117473081*^9, 3.596546908375249*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute cases M\[Infinity]", "Subsection",
 CellChangeTimes->{{3.589267885933745*^9, 3.589267890372135*^9}, {
  3.5898661631222887`*^9, 3.589866163972432*^9}, {3.596439055810008*^9, 
  3.596439056767578*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"6", "\[LessEqual]", "q"}], "\[And]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "q", "|", "j", "|", "k", "|", "\[Nu]", "|", "\[Kappa]", "|", "i"}], 
      ")"}], "\[Element]", "Integers"}], "\[And]", 
    RowBox[{"(", 
     RowBox[{"And", "@@", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalPsi]", "[", "#", "]"}], "<", "0"}], "&"}], ",", 
        "4"}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594378222956285*^9, 3.594378262643579*^9}, {
  3.594387251402789*^9, 3.5943872731277723`*^9}, {3.59643758446461*^9, 
  3.596437606734189*^9}, {3.596442791036682*^9, 3.5964427946717176`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minfCornerMom4", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{"1", "<", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfCornerMom4R", "=", 
   RowBox[{"RefineCase", "/@", "minfCornerMom4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfCornerRawSums", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfCornerMom4R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SecretTable", "[", 
        RowBox[{
         RowBox[{"SecretSum", "[", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["a", "0"], 
            RowBox[{"b", "[", "\[Kappa]", "]"}], " ", 
            RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"SecretTable", "[", 
        RowBox[{
         RowBox[{"SecretSum", "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["a", "0"], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "nel", " ", "sorensen", " ", "non", " ", "ci", " ", "sono", " ", "i", 
      " ", "termini", " ", "costanti"}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.58971237949895*^9, 3.589712449016384*^9}, {
   3.589866953008628*^9, 3.589866975385639*^9}, {3.592485004940815*^9, 
   3.592485044319708*^9}, {3.592485133567277*^9, 3.592485145771131*^9}, {
   3.592485375880477*^9, 3.592485414243001*^9}, {3.592485445733975*^9, 
   3.5924855871862783`*^9}, {3.592485651927944*^9, 3.59248570242412*^9}, {
   3.592486906446311*^9, 3.592486907506012*^9}, {3.592487141110491*^9, 
   3.59248714461236*^9}, {3.592650291866372*^9, 3.592650299298856*^9}, {
   3.5934273719290543`*^9, 3.593427379922143*^9}, {3.593429713546239*^9, 
   3.593429737345127*^9}, {3.59343181381649*^9, 3.593431819134101*^9}, {
   3.5934320485436687`*^9, 3.5934320507360153`*^9}, {3.5940425288139257`*^9, 
   3.594042586732738*^9}, {3.594042626423044*^9, 3.594042678678957*^9}, {
   3.594044734640571*^9, 3.5940447591183567`*^9}, {3.594045528984529*^9, 
   3.594045531406588*^9}, {3.594045922284741*^9, 3.59404592943974*^9}, {
   3.596438913366873*^9, 3.596438961270689*^9}, {3.5964391419480457`*^9, 
   3.5964391438647614`*^9}, {3.596439291308518*^9, 3.596439296685317*^9}, {
   3.5964394668969793`*^9, 3.596439497488126*^9}, {3.596439657680691*^9, 
   3.5964396717068367`*^9}, {3.596441574662076*^9, 3.596441580199019*^9}, {
   3.5964425098283243`*^9, 3.596442511052833*^9}, {3.596442550859233*^9, 
   3.596442584316667*^9}, 3.596442695104924*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minfColumnMom6", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}], ",", 
       RowBox[{"r", "-", "j"}]}], "}"}], ",", 
     RowBox[{"1", "<", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfColumnMom4A", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "j"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{"1", "<", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfColumnMom4B", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "j"}], ",", 
       RowBox[{"r", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{"1", "<", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfColumnMom6R", "=", 
   RowBox[{"RefineCase", "/@", "minfColumnMom6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfColumnMom4AR", "=", 
   RowBox[{"RefineCase", "/@", "minfColumnMom4A"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfColumnMom4BR", "=", 
   RowBox[{"RefineCase", "/@", "minfColumnMom4B"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfColumnRawSums", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfColumnMom6R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfColumnMom4AR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfColumnMom4BR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"SecretTable", "[", 
       RowBox[{
        RowBox[{"SecretSum", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["a", "0"], "2"], 
           RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}], "}"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{"nel", " ", "sorensen", " ", 
      RowBox[{"c", "'"}], 
      RowBox[{"e", "'"}], " ", "un", " ", "meno", " ", "qui"}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592486843319037*^9, 3.59248685123497*^9}, {
   3.592486888780046*^9, 3.5924869900743933`*^9}, {3.592487029440874*^9, 
   3.5924871730976973`*^9}, {3.592487206457032*^9, 3.592487308939755*^9}, {
   3.592487368288991*^9, 3.59248738193534*^9}, 3.592487416396639*^9, {
   3.592489336219454*^9, 3.592489338847542*^9}, {3.592491080884576*^9, 
   3.592491085472124*^9}, {3.593427429421413*^9, 3.593427455475759*^9}, 
   3.593427725678548*^9, {3.593429680463808*^9, 3.5934297063181877`*^9}, {
   3.594042774654297*^9, 3.5940428611263847`*^9}, 3.594042894652027*^9, {
   3.5940447679772997`*^9, 3.59404478166011*^9}, {3.594045910239101*^9, 
   3.594045915077818*^9}, {3.594473872014256*^9, 3.594473876113188*^9}, {
   3.5964394071923923`*^9, 3.596439411616496*^9}, {3.596439678789867*^9, 
   3.596439697193674*^9}, {3.596441581745934*^9, 3.596441628916153*^9}, {
   3.596442586359149*^9, 3.596442591287223*^9}, {3.596442633455605*^9, 
   3.596442642756359*^9}, {3.596442718999773*^9, 3.596442723545291*^9}, {
   3.596442845202504*^9, 3.5964428523931637`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minfRowMom6", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "+", "i", "-", "k"}], ",", 
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "\[Kappa]"}]}], "}"}], ",", 
     RowBox[{"1", "<", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfRowMom4A", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "\[Nu]"}], ",", 
       RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
     RowBox[{"1", "<", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfRowMom4B", "=", 
   RowBox[{"GenerateCases", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "-", "k"}], ",", 
       RowBox[{"r", "-", "\[Nu]"}]}], "}"}], ",", 
     RowBox[{"1", "<", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfRowMom6R", "=", 
   RowBox[{"RefineCase", "/@", "minfRowMom6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfRowMom4AR", "=", 
   RowBox[{"RefineCase", "/@", "minfRowMom4A"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfRowMom4BR", "=", 
   RowBox[{"RefineCase", "/@", "minfRowMom4B"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfRowRawSums", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfRowMom6R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfRowMom4AR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfRowMom4BR", ",", 
       RowBox[{
        SubscriptBox["a", "0"], 
        RowBox[{"b", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"SecretTable", "[", 
       RowBox[{
        RowBox[{"SecretSum", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["a", "0"], "2"], 
           RowBox[{"coeff", "[", "EG2c", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "q"}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592486843319037*^9, 3.59248685123497*^9}, {
   3.592486888780046*^9, 3.5924869900743933`*^9}, {3.592487029440874*^9, 
   3.5924871730976973`*^9}, {3.592487206457032*^9, 3.592487308939755*^9}, {
   3.592487368288991*^9, 3.59248738193534*^9}, 3.592487416396639*^9, {
   3.592488859030415*^9, 3.5924888685059233`*^9}, {3.5924889703268538`*^9, 
   3.592489025145393*^9}, {3.5924892999537086`*^9, 3.59248932710832*^9}, {
   3.59249109661792*^9, 3.592491101373228*^9}, {3.5934231792420597`*^9, 
   3.593423214302877*^9}, {3.5934232702704697`*^9, 3.593423273545375*^9}, {
   3.5934296005628757`*^9, 3.593429632143784*^9}, {3.593431379944029*^9, 
   3.593431401544265*^9}, {3.593431933310072*^9, 3.593431937653809*^9}, {
   3.594043010186219*^9, 3.594043025377495*^9}, {3.594043075021442*^9, 
   3.594043079139531*^9}, {3.594043149417437*^9, 3.594043249540324*^9}, {
   3.5940447943019543`*^9, 3.5940448000006657`*^9}, {3.5940459002664557`*^9, 
   3.5940459065037613`*^9}, {3.596439701696993*^9, 3.5964397052740602`*^9}, {
   3.596441256913279*^9, 3.596441260353085*^9}, {3.596441632353586*^9, 
   3.596441643006049*^9}, {3.596442594469983*^9, 3.596442596905308*^9}, {
   3.596442643941547*^9, 3.5964426461744413`*^9}, {3.596442726158764*^9, 
   3.5964427297857018`*^9}, {3.596442818254463*^9, 3.596442826838352*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minfBodyMom4", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "-", "j"}], ",", 
         RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
       RowBox[{"1", "<", "q"}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<minfBodyMom4\>\""}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"minfBodyMom6A", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "+", "i", "-", "\[Nu]"}], ",", 
         RowBox[{"r", "-", "j"}], ",", 
         RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
       RowBox[{"1", "<", "q"}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<minfBodyMom6A\>\""}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"minfBodyMom6B", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "-", "\[Nu]"}], ",", 
         RowBox[{"r", "-", "j"}], ",", 
         RowBox[{"r", "+", "i", "-", "k"}]}], "}"}], ",", 
       RowBox[{"1", "<", "q"}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<minfBodyMom6B\>\""}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"minfBodyMom8", "=", 
   RowBox[{"LoadOrCompute", "[", 
    RowBox[{
     RowBox[{"GenerateCases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "\[Infinity]"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "-", "\[Nu]"}], ",", 
         RowBox[{"i", "+", "r", "-", "\[Kappa]"}], ",", 
         RowBox[{
          RowBox[{"-", "j"}], "+", "r"}], ",", 
         RowBox[{"i", "-", "k", "+", "r"}]}], "}"}], ",", 
       RowBox[{"1", "<", "q"}]}], "]"}], ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<minfBodyMom8\>\""}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.588416770892332*^9, 3.5884167830701313`*^9}, {
   3.588416947914268*^9, 3.588416948914249*^9}, {3.588417053065731*^9, 
   3.588417108445631*^9}, 3.588417159151445*^9, {3.5889986692270308`*^9, 
   3.588998786546341*^9}, {3.588998933937262*^9, 3.5889989405032043`*^9}, {
   3.590131196468029*^9, 3.590131212309362*^9}, {3.5901323560021763`*^9, 
   3.590132398803619*^9}, {3.592112649230044*^9, 3.592112691670457*^9}, {
   3.594043365954227*^9, 3.594043424907976*^9}, {3.594378336422017*^9, 
   3.594378347918722*^9}, {3.594446408475643*^9, 3.594446408680265*^9}, {
   3.5964412713759537`*^9, 3.596441287530076*^9}, {3.596441545086422*^9, 
   3.596441546559787*^9}, {3.596441644620448*^9, 3.596441653108664*^9}, {
   3.59644259785524*^9, 3.5964426008402433`*^9}, {3.596442731114613*^9, 
   3.59644273485928*^9}, {3.596442801261509*^9, 3.596442804914672*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Computed minfBodyMom4 in 0.108000 seconds.\"\>"], "Print",
 CellChangeTimes->{3.596546912353347*^9}],

Cell[BoxData["\<\"Computed minfBodyMom6A in 0.276000 seconds.\"\>"], "Print",
 CellChangeTimes->{3.596546912765772*^9}],

Cell[BoxData["\<\"Computed minfBodyMom6B in 0.396000 seconds.\"\>"], "Print",
 CellChangeTimes->{3.596546913296163*^9}],

Cell[BoxData["\<\"Computed minfBodyMom8 in 2.112000 seconds.\"\>"], "Print",
 CellChangeTimes->{3.596546916538939*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minfBodyMom4R", "=", 
   RowBox[{"RefineCase", "/@", "minfBodyMom4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfBodyMom6AR", "=", 
   RowBox[{"RefineCase", "/@", "minfBodyMom6A"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfBodyMom6BR", "=", 
   RowBox[{"RefineCase", "/@", "minfBodyMom6B"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minfBodyMom8R", "=", 
   RowBox[{"RefineCase", "/@", "minfBodyMom8"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.58971237949895*^9, 3.589712449016384*^9}, {
  3.590132436617025*^9, 3.590132463130525*^9}, {3.594043430208428*^9, 
  3.594043456498076*^9}, {3.596441654979822*^9, 3.596441659960701*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"minfBodySumsRaw", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfBodyMom4R", ",", 
       SuperscriptBox[
        SubscriptBox["a", "0"], "2"], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", "i", "}"}]}], "]"}], ",", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfBodyMom6AR", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        SubscriptBox["a", "0"]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfBodyMom6BR", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        SubscriptBox["a", "0"]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "i"}], "}"}]}], "]"}], ",", 
     RowBox[{"CasesToSums", "[", 
      RowBox[{"minfBodyMom8R", ",", 
       RowBox[{
        RowBox[{"b", "[", "\[Nu]", "]"}], 
        RowBox[{"b", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "\[Kappa]", ",", "i"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594043473061874*^9, 3.594043507060935*^9}, 
   3.5964412923817253`*^9, {3.5964416611463623`*^9, 3.596441664486875*^9}, {
   3.596442647162705*^9, 3.596442649325886*^9}, 3.5964427360198107`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"minfSumsRaw", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "minfCornerRawSums", ",", "minfColumnRawSums", ",", "minfRowRawSums", ",",
      "minfBodySumsRaw"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588416286480692*^9, 3.588416311855803*^9}, {
   3.588416381222664*^9, 3.588416382571664*^9}, {3.588416494788518*^9, 
   3.588416510880138*^9}, {3.588416602440465*^9, 3.588416758148245*^9}, 
   3.588417288817268*^9, {3.588417351190778*^9, 3.588417372171929*^9}, {
   3.58841936256581*^9, 3.588419389456244*^9}, {3.5889987947592993`*^9, 
   3.588998795437706*^9}, {3.5890900695563793`*^9, 3.58909008497425*^9}, {
   3.589715416338777*^9, 3.589715431497101*^9}, {3.589715556460837*^9, 
   3.589715565233494*^9}, {3.590132291906905*^9, 3.5901323354614573`*^9}, {
   3.590132466956299*^9, 3.59013248325531*^9}, {3.592456049583028*^9, 
   3.592456076190069*^9}, {3.592456117523967*^9, 3.5924561555181723`*^9}, {
   3.592456285943941*^9, 3.5924563535842857`*^9}, {3.5925479033032*^9, 
   3.592547909399096*^9}, {3.593954056217987*^9, 3.593954058213069*^9}, {
   3.594022900101976*^9, 3.5940229319810457`*^9}, {3.5940435288492107`*^9, 
   3.594043574325721*^9}, {3.596441665577231*^9, 3.5964416777607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"minfSumsReduced", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"InnerSumElimination", "[", 
       RowBox[{"SecretSumPreprocess", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "\[Kappa]"}], "}"}]}], "]"}], "]"}], "&"}], 
     ",", "minfSumsRaw", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<minfSumsReduced\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593950751125306*^9, 3.5939507513857*^9}, {
   3.593951782637488*^9, 3.593951783600193*^9}, {3.593955554826735*^9, 
   3.593955555094533*^9}, {3.594011747046454*^9, 3.594011773942939*^9}, {
   3.594015680698122*^9, 3.594015681020203*^9}, {3.594022935829899*^9, 
   3.5940229436756268`*^9}, 3.594022996361918*^9, {3.594041444259631*^9, 
   3.594041449120707*^9}, 3.594041527001257*^9, {3.5940427004968033`*^9, 
   3.594042701319784*^9}, {3.594119807571929*^9, 3.59411981076796*^9}, 
   3.5944489047702713`*^9, 3.594470644587357*^9, {3.5945566431932373`*^9, 
   3.5945566434194317`*^9}, {3.596175789471033*^9, 3.596175790447706*^9}, {
   3.596176098645121*^9, 3.596176110938374*^9}, {3.596176627829054*^9, 
   3.596176628073161*^9}, {3.596441679478462*^9, 3.596441681280856*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922006427*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922154772*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922244186*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922329043*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922382536*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922498382*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469226174707`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469226705503`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922826614*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469228352137`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922888269*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546922897273*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546923039559*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546923136037*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546923446968*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546923522689*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546923763373*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546923903989*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469240196657`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.59654692407152*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469248604717`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546924907444*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546925097432*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546925560257*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469256359177`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546925785788*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546925876788*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469265365562`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546926636218*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546928849597*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.59654692888398*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546928907542*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546928933394*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546931109458*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469311775093`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546931434639*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546931495822*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546935122246*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546935328636*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546935624424*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546935689781*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546935753922*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.5965469358228807`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Sum", "::", "div"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Sum does not converge.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546935938774*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(\\*StyleBox[\\(Sum :: div\\), \
\\\"MessageName\\\"]\\) will be suppressed during this calculation.\"\>"}]], \
"Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.596546936022485*^9}],

Cell[BoxData["\<\"Total computing time: 18.240\"\>"], "Print",
 CellChangeTimes->{3.5965469369898233`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"minfSumsSimplified", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AssumingSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SmartSimplify", "[", 
           RowBox[{
            RowBox[{"SimplifyMaxAndMin", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], ",", "#2"}], "]"}], "&"}], 
         ")"}]}], "]"}], "&"}], ",", "minfSumsReduced", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{"\"\<cases\>\"", ",", "\"\<minfSumsSimplified\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59394915516969*^9, 3.593949195263674*^9}, {
   3.5939492829194813`*^9, 3.593949292257139*^9}, {3.593949724520801*^9, 
   3.5939497335617437`*^9}, {3.593950642621071*^9, 3.593950650088956*^9}, {
   3.593951819604291*^9, 3.593951825643276*^9}, {3.594011805869052*^9, 
   3.594011806153714*^9}, {3.594022956748921*^9, 3.5940229667157183`*^9}, {
   3.594041108416267*^9, 3.594041137114272*^9}, 3.594041453614046*^9, 
   3.5940415190985813`*^9, {3.594045268232574*^9, 3.594045268439104*^9}, 
   3.594101039580412*^9, {3.5941047580770407`*^9, 3.594104758289357*^9}, {
   3.594120775094921*^9, 3.594120779818459*^9}, {3.5941300747784367`*^9, 
   3.5941300765462627`*^9}, {3.5943666927746058`*^9, 
   3.5943666929539337`*^9}, {3.594378374513329*^9, 3.594378375647709*^9}, {
   3.594382825336289*^9, 3.5943828255254707`*^9}, {3.5944489557078238`*^9, 
   3.594448956814974*^9}, {3.594469302467828*^9, 3.594469305260047*^9}, {
   3.594470415520303*^9, 3.594470455881393*^9}, {3.594556736557177*^9, 
   3.594556736827392*^9}, {3.594557193628063*^9, 3.594557196682164*^9}, 
   3.596176623690564*^9, {3.596441685691968*^9, 3.596441700364934*^9}}],

Cell[BoxData["\<\"Computation aborted while computing 20 of 157.\"\>"], \
"Print",
 CellChangeTimes->{3.596546946818549*^9}],

Cell[BoxData["\<\"Total computing time: 15.8320\"\>"], "Print",
 CellChangeTimes->{3.5965469468205748`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"minfSumsSimplifiedAgainWithRepl", "=", 
   RowBox[{"MyParallelCachedMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AssumingSimplify", "[", 
       RowBox[{"#", ",", "SubexprSimplify"}], "]"}], "&"}], ",", 
     "minfSumsSimplified", ",", 
     RowBox[{"MyPath", "[", 
      RowBox[{
      "\"\<cases\>\"", ",", "\"\<minfSumsSimplifiedAgainWithRepl\>\""}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594555800597004*^9, 3.594555833400268*^9}, {
   3.5945559578163958`*^9, 3.594556021354587*^9}, {3.594556068745126*^9, 
   3.594556075102668*^9}, 3.594556311602326*^9, {3.594556719713553*^9, 
   3.594556726274685*^9}, {3.596176631594481*^9, 3.5961766318225307`*^9}, {
   3.596441704211741*^9, 3.59644170579112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WriteCFile", "[", 
  RowBox[{"\"\<casesMINF.c\>\"", ",", 
   RowBox[{"PsiExpOptim", "[", 
    RowBox[{
     RowBox[{"minfSumsSimplifiedAgainWithRepl", "/.", 
      RowBox[{"c_coeff", "\[RuleDelayed]", 
       RowBox[{"CoefficientAsVariableSym", "[", "c", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "q"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "0", ",", "q"}], "}"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5938453374405127`*^9, 3.5938453397583437`*^9}, {
   3.593845383551839*^9, 3.593845425476089*^9}, {3.593845464722398*^9, 
   3.59384546711546*^9}, {3.593845590284258*^9, 3.593845615979258*^9}, {
   3.593845838988312*^9, 3.593845856875264*^9}, {3.594035300369665*^9, 
   3.5940353448940887`*^9}, 3.594035384754389*^9, {3.594035940495448*^9, 
   3.59403594090469*^9}, 3.594041127786582*^9, 3.594126888342349*^9, 
   3.594474953487094*^9, 3.59455895591494*^9, {3.59455909294106*^9, 
   3.594559113149208*^9}, 3.596287320924893*^9, 3.596441706610639*^9, {
   3.596449104852613*^9, 3.596449105794479*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The exponents range in: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "q"}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}]}]}], "}"}]}],
  SequenceForm[
  "The exponents range in: ", {(-3) $CellContext`q, 2 (1 + $CellContext`q)}],
  Editable->False]], "Print",
 CellChangeTimes->{3.596441848595358*^9, 3.596443618567874*^9, 
  3.596448879534567*^9, 3.596449109575444*^9, 3.596454873339385*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{959, 744},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 100, 1, 81, "Section"],
Cell[682, 25, 142, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[849, 31, 1120, 16, 32, "Input"],
Cell[1972, 49, 348, 5, 70, "Output"]
}, Open  ]],
Cell[2335, 57, 550, 15, 55, "Input"],
Cell[CellGroupData[{
Cell[2910, 76, 158, 2, 45, "Subsection"],
Cell[3071, 80, 2930, 58, 519, "Input"],
Cell[CellGroupData[{
Cell[6026, 142, 499, 11, 99, "Input"],
Cell[6528, 155, 280, 4, 70, "Output"],
Cell[6811, 161, 307, 4, 70, "Print"],
Cell[7121, 167, 280, 4, 70, "Output"],
Cell[7404, 173, 310, 4, 70, "Print"],
Cell[7717, 179, 280, 4, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8034, 188, 533, 12, 99, "Input"],
Cell[8570, 202, 303, 4, 70, "Print"],
Cell[8876, 208, 284, 4, 70, "Output"]
}, Open  ]],
Cell[9175, 215, 804, 18, 99, "Input"],
Cell[9982, 235, 70, 1, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[10089, 241, 106, 1, 37, "Subsection"],
Cell[10198, 244, 130, 2, 32, "Input"],
Cell[10331, 248, 1462, 32, 298, "Input"],
Cell[11796, 282, 1099, 26, 121, "Input"],
Cell[12898, 310, 1045, 24, 121, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[13980, 339, 114, 1, 37, "Subsection"],
Cell[14097, 342, 589, 15, 55, "Input"],
Cell[14689, 359, 721, 19, 77, "Input"],
Cell[15413, 380, 4359, 84, 407, "Input"],
Cell[19775, 466, 559, 15, 55, "Input"],
Cell[20337, 483, 5351, 114, 541, "Input"],
Cell[25691, 599, 3748, 79, 342, "Input"],
Cell[29442, 680, 1485, 26, 32, "Input"],
Cell[30930, 708, 13081, 264, 1157, "Input"],
Cell[44014, 974, 1201, 22, 32, "Input"],
Cell[45218, 998, 3977, 84, 451, "Input"],
Cell[49198, 1084, 3963, 86, 451, "Input"],
Cell[53164, 1172, 466, 12, 32, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[53679, 1190, 102, 1, 51, "Section"],
Cell[53784, 1193, 1153, 24, 55, "Input"],
Cell[CellGroupData[{
Cell[54962, 1221, 162, 2, 45, "Subsection"],
Cell[55127, 1225, 2301, 57, 176, "Input"],
Cell[57431, 1284, 9843, 241, 494, "Input"],
Cell[67277, 1527, 10748, 275, 674, "Input"],
Cell[78028, 1804, 8089, 191, 539, "Input"],
Cell[86120, 1997, 843, 20, 77, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[87000, 2022, 321, 4, 37, "Subsection"],
Cell[87324, 2028, 569, 9, 91, "Text"],
Cell[87896, 2039, 1739, 40, 143, "Input"],
Cell[CellGroupData[{
Cell[89660, 2083, 937, 23, 77, "Input"],
Cell[90600, 2108, 2560, 66, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93197, 2179, 178, 3, 32, "Input"],
Cell[93378, 2184, 424, 8, 32, "Output"]
}, Open  ]],
Cell[93817, 2195, 121, 1, 31, "Text"],
Cell[93941, 2198, 1789, 38, 253, "Input"],
Cell[95733, 2238, 2915, 63, 275, "Input"],
Cell[98651, 2303, 622, 14, 79, "Input"],
Cell[99276, 2319, 288, 5, 51, "Text"],
Cell[99567, 2326, 1785, 51, 121, "Input"],
Cell[101355, 2379, 792, 18, 55, "Input"],
Cell[102150, 2399, 1254, 26, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103441, 2430, 165, 2, 45, "Subsection"],
Cell[103609, 2434, 2797, 60, 165, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[106409, 2496, 1768, 38, 77, "Input"],
Cell[108180, 2536, 1395, 29, 55, "Input"],
Cell[109578, 2567, 2602, 53, 407, "Input"],
Cell[112183, 2622, 1597, 34, 99, "Input"],
Cell[113783, 2658, 1600, 46, 144, "Input"],
Cell[115386, 2706, 620, 17, 55, "Input"],
Cell[116009, 2725, 1245, 30, 209, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117291, 2760, 208, 3, 45, "Subsection"],
Cell[117502, 2765, 1065, 28, 121, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[118604, 2798, 118, 1, 37, "Subsection"],
Cell[118725, 2801, 622, 14, 79, "Input"],
Cell[119350, 2817, 457, 12, 55, "Input"],
Cell[119810, 2831, 462, 13, 55, "Input"],
Cell[120275, 2846, 641, 17, 77, "Input"],
Cell[120919, 2865, 673, 17, 55, "Input"],
Cell[121595, 2884, 776, 21, 77, "Input"],
Cell[122374, 2907, 9559, 204, 737, "Input"],
Cell[131936, 3113, 1998, 48, 209, "Input"],
Cell[133937, 3163, 583, 14, 55, "Input"],
Cell[134523, 3179, 562, 12, 55, "Input"],
Cell[135088, 3193, 413, 10, 55, "Input"],
Cell[135504, 3205, 411, 10, 55, "Input"],
Cell[CellGroupData[{
Cell[135940, 3219, 390, 9, 32, "Input"],
Cell[136333, 3230, 9449, 253, 866, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145831, 3489, 202, 3, 45, "Subsection"],
Cell[146036, 3494, 1743, 38, 165, "Input"],
Cell[147782, 3534, 2015, 53, 209, "Input"],
Cell[149800, 3589, 731, 14, 32, "Input"],
Cell[150534, 3605, 336, 8, 32, "Input"],
Cell[150873, 3615, 2574, 64, 209, "Input"],
Cell[153450, 3681, 568, 13, 55, "Input"],
Cell[154021, 3696, 462, 11, 55, "Input"],
Cell[CellGroupData[{
Cell[154508, 3711, 817, 23, 55, "Input"],
Cell[155328, 3736, 1383, 38, 77, "Output"]
}, Open  ]],
Cell[156726, 3777, 4943, 101, 275, "Input"],
Cell[161672, 3880, 3237, 74, 407, "Input"],
Cell[164912, 3956, 616, 11, 34, "Input"],
Cell[165531, 3969, 2640, 52, 253, "Input"],
Cell[168174, 4023, 541, 10, 34, "Input"],
Cell[168718, 4035, 1530, 35, 165, "Input"],
Cell[170251, 4072, 1048, 26, 165, "Input"],
Cell[171302, 4100, 7399, 147, 561, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178738, 4252, 121, 1, 45, "Subsection"],
Cell[178862, 4255, 1643, 37, 99, "Input"],
Cell[180508, 4294, 1450, 37, 143, "Input"],
Cell[181961, 4333, 1647, 34, 275, "Input"],
Cell[183611, 4369, 387, 6, 32, "Input"],
Cell[184001, 4377, 1709, 34, 253, "Input"],
Cell[185713, 4413, 2357, 48, 341, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188119, 4467, 92, 1, 81, "Section"],
Cell[188214, 4470, 1426, 28, 55, "Input"],
Cell[CellGroupData[{
Cell[189665, 4502, 206, 3, 45, "Subsection"],
Cell[189874, 4507, 266, 5, 51, "Text"],
Cell[190143, 4514, 4888, 132, 407, "Input"],
Cell[195034, 4648, 731, 18, 55, "Input"],
Cell[195768, 4668, 930, 23, 55, "Input"],
Cell[196701, 4693, 1512, 31, 99, "Input"],
Cell[198216, 4726, 531, 14, 32, "Input"],
Cell[198750, 4742, 500, 12, 32, "Input"],
Cell[199253, 4756, 597, 16, 32, "Input"],
Cell[199853, 4774, 913, 26, 55, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200803, 4805, 109, 1, 45, "Subsection"],
Cell[200915, 4808, 6185, 159, 543, "Input"],
Cell[207103, 4969, 337, 8, 55, "Input"],
Cell[207443, 4979, 344, 8, 55, "Input"],
Cell[207790, 4989, 1117, 30, 77, "Input"],
Cell[208910, 5021, 332, 8, 32, "Input"],
Cell[209245, 5031, 5863, 126, 451, "Input"],
Cell[215111, 5159, 436, 8, 32, "Input"],
Cell[215550, 5169, 9400, 199, 825, "Input"],
Cell[224953, 5370, 3002, 46, 55, "Input"],
Cell[CellGroupData[{
Cell[227980, 5420, 874, 21, 55, "Input"],
Cell[228857, 5443, 4929, 140, 134, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233835, 5589, 100, 1, 45, "Subsection"],
Cell[233938, 5592, 1008, 27, 32, "Input"],
Cell[234949, 5621, 139, 2, 32, "Input"],
Cell[235091, 5625, 6593, 158, 433, "Input"],
Cell[241687, 5785, 1307, 36, 77, "Input"],
Cell[242997, 5823, 193, 3, 32, "Input"],
Cell[243193, 5828, 9464, 173, 517, "Input"],
Cell[252660, 6003, 1245, 32, 32, "Input"],
Cell[253908, 6037, 2664, 63, 165, "Input"],
Cell[256575, 6102, 175, 3, 32, "Input"],
Cell[256753, 6107, 3505, 75, 209, "Input"],
Cell[260261, 6184, 528, 15, 32, "Input"],
Cell[260792, 6201, 739, 15, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[261568, 6221, 150, 2, 37, "Subsection"],
Cell[261721, 6225, 340, 9, 32, "Input"],
Cell[262064, 6236, 467, 10, 32, "Input"],
Cell[262534, 6248, 717, 19, 77, "Input"],
Cell[263254, 6269, 3900, 76, 187, "Input"],
Cell[267157, 6347, 3597, 85, 121, "Input"],
Cell[270757, 6434, 5391, 111, 341, "Input"],
Cell[276151, 6547, 116, 3, 32, "Input"],
Cell[276270, 6552, 463, 11, 55, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[276770, 6568, 149, 2, 37, "Subsection"],
Cell[276922, 6572, 4307, 97, 253, "Input"],
Cell[281232, 6671, 571, 14, 55, "Input"],
Cell[281806, 6687, 294, 8, 32, "Input"],
Cell[282103, 6697, 1146, 24, 55, "Input"],
Cell[283252, 6723, 2516, 69, 187, "Input"],
Cell[285771, 6794, 3114, 75, 319, "Input"],
Cell[288888, 6871, 767, 16, 55, "Input"],
Cell[289658, 6889, 1486, 30, 77, "Input"],
Cell[291147, 6921, 864, 18, 55, "Input"],
Cell[292014, 6941, 5220, 127, 436, "Input"],
Cell[297237, 7070, 1769, 40, 144, "Input"],
Cell[299009, 7112, 656, 18, 78, "Input"],
Cell[299668, 7132, 372, 8, 32, "Input"],
Cell[300043, 7142, 2800, 72, 231, "Input"],
Cell[302846, 7216, 2989, 79, 169, "Input"],
Cell[305838, 7297, 3843, 96, 235, "Input"],
Cell[309684, 7395, 6552, 142, 564, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316273, 7542, 102, 1, 45, "Subsection"],
Cell[316378, 7545, 2389, 63, 231, "Input"],
Cell[318770, 7610, 258, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[319053, 7619, 12918, 312, 1555, "Input"],
Cell[331974, 7933, 611, 12, 24, "Message"]
}, Open  ]],
Cell[332600, 7948, 1710, 29, 55, "Input"],
Cell[334313, 7979, 676, 18, 55, "Input"],
Cell[334992, 7999, 2327, 35, 32, "Input"],
Cell[337322, 8036, 3315, 66, 99, "Input"],
Cell[340640, 8104, 2351, 58, 168, "Input"],
Cell[CellGroupData[{
Cell[343016, 8166, 138, 3, 35, "Subsubsection"],
Cell[343157, 8171, 2205, 60, 143, "Input"],
Cell[345365, 8233, 2533, 69, 187, "Input"],
Cell[347901, 8304, 1505, 32, 209, "Input"],
Cell[349409, 8338, 3322, 65, 319, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[352780, 8409, 155, 2, 45, "Subsection"],
Cell[352938, 8413, 672, 19, 34, "Input"],
Cell[353613, 8434, 3242, 83, 196, "Input"],
Cell[356858, 8519, 116, 1, 31, "Text"],
Cell[356977, 8522, 4920, 137, 370, "Input"],
Cell[361900, 8661, 4917, 134, 348, "Input"],
Cell[366820, 8797, 865, 23, 35, "Input"],
Cell[367688, 8822, 4472, 119, 187, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[372163, 8943, 594, 14, 99, "Input"],
Cell[372760, 8959, 2369, 51, 150, "Input"],
Cell[375132, 9012, 530, 11, 32, "Input"],
Cell[375665, 9025, 1187, 25, 99, "Input"],
Cell[376855, 9052, 668, 15, 77, "Input"],
Cell[CellGroupData[{
Cell[377548, 9071, 1137, 25, 77, "Input"],
Cell[378688, 9098, 529, 13, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[379266, 9117, 154, 2, 45, "Subsection"],
Cell[379423, 9121, 799, 22, 56, "Input"],
Cell[380225, 9145, 3683, 100, 315, "Input"],
Cell[383911, 9247, 5992, 164, 498, "Input"],
Cell[389906, 9413, 6022, 162, 476, "Input"],
Cell[395931, 9577, 4726, 127, 253, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[400660, 9706, 658, 17, 99, "Input"],
Cell[401321, 9725, 1865, 53, 245, "Input"],
Cell[403189, 9780, 1191, 20, 32, "Input"],
Cell[404383, 9802, 1251, 25, 55, "Input"],
Cell[405637, 9829, 594, 15, 55, "Input"],
Cell[406234, 9846, 1719, 33, 99, "Input"],
Cell[407956, 9881, 616, 15, 77, "Input"],
Cell[408575, 9898, 714, 15, 77, "Input"],
Cell[CellGroupData[{
Cell[409314, 9917, 1228, 26, 77, "Input"],
Cell[410545, 9945, 662, 16, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[411256, 9967, 214, 3, 45, "Subsection"],
Cell[411473, 9972, 759, 20, 34, "Input"],
Cell[412235, 9994, 4155, 96, 196, "Input"],
Cell[416393, 10092, 5566, 141, 370, "Input"],
Cell[421962, 10235, 5600, 140, 326, "Input"],
Cell[427565, 10377, 4529, 114, 275, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[432119, 10495, 118, 1, 23, "Print"],
Cell[432240, 10498, 119, 1, 23, "Print"],
Cell[432362, 10501, 119, 1, 23, "Print"],
Cell[432484, 10504, 118, 1, 23, "Print"]
}, Open  ]],
Cell[432617, 10508, 723, 18, 99, "Input"],
Cell[433343, 10528, 1597, 42, 127, "Input"],
Cell[434943, 10572, 1245, 20, 32, "Input"],
Cell[CellGroupData[{
Cell[436213, 10596, 1303, 25, 77, "Input"],
Cell[437519, 10623, 226, 6, 24, "Message"],
Cell[437748, 10631, 226, 6, 24, "Message"],
Cell[437977, 10639, 226, 6, 24, "Message"],
Cell[438206, 10647, 226, 6, 24, "Message"],
Cell[438435, 10655, 337, 9, 24, "Message"],
Cell[438775, 10666, 226, 6, 24, "Message"],
Cell[439004, 10674, 228, 6, 24, "Message"],
Cell[439235, 10682, 339, 9, 24, "Message"],
Cell[439577, 10693, 226, 6, 24, "Message"],
Cell[439806, 10701, 228, 6, 24, "Message"],
Cell[440037, 10709, 226, 6, 24, "Message"],
Cell[440266, 10717, 226, 6, 24, "Message"],
Cell[440495, 10725, 226, 6, 24, "Message"],
Cell[440724, 10733, 337, 9, 24, "Message"],
Cell[441064, 10744, 226, 6, 24, "Message"],
Cell[441293, 10752, 337, 9, 24, "Message"],
Cell[441633, 10763, 226, 6, 24, "Message"],
Cell[441862, 10771, 226, 6, 24, "Message"],
Cell[442091, 10779, 228, 6, 24, "Message"],
Cell[442322, 10787, 336, 9, 24, "Message"],
Cell[442661, 10798, 228, 6, 24, "Message"],
Cell[442892, 10806, 226, 6, 24, "Message"],
Cell[443121, 10814, 226, 6, 24, "Message"],
Cell[443350, 10822, 226, 6, 24, "Message"],
Cell[443579, 10830, 228, 6, 24, "Message"],
Cell[443810, 10838, 226, 6, 24, "Message"],
Cell[444039, 10846, 337, 9, 24, "Message"],
Cell[444379, 10857, 228, 6, 24, "Message"],
Cell[444610, 10865, 337, 9, 24, "Message"],
Cell[444950, 10876, 226, 6, 24, "Message"],
Cell[445179, 10884, 225, 6, 24, "Message"],
Cell[445407, 10892, 226, 6, 24, "Message"],
Cell[445636, 10900, 337, 9, 24, "Message"],
Cell[445976, 10911, 226, 6, 24, "Message"],
Cell[446205, 10919, 228, 6, 24, "Message"],
Cell[446436, 10927, 226, 6, 24, "Message"],
Cell[446665, 10935, 337, 9, 24, "Message"],
Cell[447005, 10946, 226, 6, 24, "Message"],
Cell[447234, 10954, 226, 6, 24, "Message"],
Cell[447463, 10962, 226, 6, 24, "Message"],
Cell[447692, 10970, 337, 9, 24, "Message"],
Cell[448032, 10981, 226, 6, 24, "Message"],
Cell[448261, 10989, 228, 6, 24, "Message"],
Cell[448492, 10997, 226, 6, 24, "Message"],
Cell[448721, 11005, 337, 9, 24, "Message"],
Cell[449061, 11016, 106, 1, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[449204, 11022, 1771, 33, 99, "Input"],
Cell[450978, 11057, 124, 2, 23, "Print"],
Cell[451105, 11061, 107, 1, 23, "Print"]
}, Open  ]],
Cell[451227, 11065, 776, 17, 77, "Input"],
Cell[CellGroupData[{
Cell[452028, 11086, 1304, 27, 77, "Input"],
Cell[453335, 11115, 542, 14, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
