{{{{j, 1, q}, {k, 1, q}, {i, 1, -1 - j + k}}, {{i - k + r}, {-j + r}}}, 
 {{{j, 1, q}, {k, 1, q}, {i, Max[1, 1 - j + k], Infinity}}, 
  {{-j + r}, {i - k + r}}}, 
 {{{j, 1, q}, {k, 1, q}, {i, Max[1, -j + k], -j + k}}, {{-j + r, i - k + r}}}}
